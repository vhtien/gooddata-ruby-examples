<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<title>GoodData SDK Cookbook</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove the comments around the @import statement below when using this as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
#map_canvas img,#map_canvas embed,#map_canvas object,.map_canvas img,.map_canvas embed,.map_canvas object{max-width:none!important}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
.antialiased,body{-webkit-font-smoothing:antialiased}
img{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{display:inline-block;color:rgba(0,0,0,.8);font-size:.75em;line-height:1.4;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:-.15em .15em 0 .15em;padding:.2em .6em .2em .5em;vertical-align:middle;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.05em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.spread{width:100%}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1{padding-right:.75em;font-weight:bold}
td.hdlist1,td.hdlist2{vertical-align:top}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none}
span.footnote,span.footnoteref{vertical-align:super;font-size:.875em}
span.footnote a,span.footnoteref a{text-decoration:none}
span.footnote a:active,span.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em;line-height:1.3;font-size:.875em;margin-left:1.2em;text-indent:-1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
h1,h2{letter-spacing:-.01em}
dt,th.tableblock,td.content{text-rendering:optimizeLegibility}
p,td.content{letter-spacing:-.01em}
p strong,td.content strong{letter-spacing:-.005em}
p,blockquote,dt,td.content{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img{page-break-inside:avoid}
thead{display:table-header-group}
img{max-width:100%!important}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{font-weight: normal}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#00}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="book">
<div id="header">
<h1>GoodData SDK Cookbook</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_01_getting_started">01 Getting Started</a>
<ul class="sectlevel2">
<li><a href="#_supported_ruby_versions">Supported Ruby Versions</a></li>
<li><a href="#_working_with_project_interactively">Working with Project Interactively</a></li>
<li><a href="#_scripting">Scripting</a></li>
<li><a href="#_connecting_to_gooddata_platform">Connecting to Gooddata Platform</a></li>
<li><a href="#_connecting_to_gooddata_using_single_sign_on_sso">Connecting to GoodData using Single Sign On (SSO)</a></li>
<li><a href="#_connecting_to_different_servers">Connecting to Different Servers</a></li>
<li><a href="#_connecting_to_gooddata_platform_with_super_secure_token_sst">Connecting to GoodData Platform with Super Secure Token (SST)</a></li>
<li><a href="#_handling_credentials_securely">Handling Credentials Securely</a></li>
<li><a href="#_using_project">Using Project</a></li>
<li><a href="#_using_apis">Using APIs</a></li>
<li><a href="#_disabling_ssl_verification">Disabling SSL Verification</a></li>
<li><a href="#_using_asynchronous_tasks_with_timeouts">Using Asynchronous Tasks with Timeouts</a></li>
<li><a href="#_logging">Logging</a></li>
</ul>
</li>
<li><a href="#_02_working_with_users">02 Working With Users</a>
<ul class="sectlevel2">
<li><a href="#_listing_project_s_users">Listing Project&#8217;s Users</a></li>
<li><a href="#_checking_user_memberhip_in_project">Checking User Memberhip in Project</a></li>
<li><a href="#_enabling_and_disabling_users">Enabling and Disabling Users</a></li>
<li><a href="#_creating_multiple_users_from_csv">Creating Multiple Users from CSV</a></li>
<li><a href="#_inviting_users_to_project">Inviting Users to Project</a></li>
<li><a href="#_listing_organization_s_users">Listing Organization&#8217;s Users</a></li>
<li><a href="#_adding_user_to_organization">Adding User to Organization</a></li>
<li><a href="#_adding_multiple_users_to_organization_from_csv">Adding Multiple Users to Organization from CSV</a></li>
<li><a href="#_adding_user_from_organization_to_project">Adding User from Organization to Project</a></li>
<li><a href="#_adding_users_from_organization_to_multiple_projects">Adding Users from Organization to Multiple Projects</a></li>
<li><a href="#_adding_user_to_both_organization_and_project_from_csv">Adding User to Both Organization and Project from CSV</a></li>
<li><a href="#_updating_a_user_in_organization">Updating a User in Organization</a></li>
</ul>
</li>
<li><a href="#_03_automation_recipes">03 Automation Recipes</a>
<ul class="sectlevel2">
<li><a href="#_performing_operations_on_multiple_projects">Performing Operations on Multiple Projects</a></li>
<li><a href="#_parallel_processing">Parallel Processing</a></li>
</ul>
</li>
<li><a href="#_04_model">04 Model</a>
<ul class="sectlevel2">
<li><a href="#_changing_object_s_identifier">Changing Object&#8217;s Identifier</a></li>
<li><a href="#_computing_dataset_s_number_of_records">Computing Dataset&#8217;s Number of Records</a></li>
<li><a href="#_enumerating_date_dimensions">Enumerating Date Dimensions</a></li>
<li><a href="#_removing_data">Removing Data</a></li>
<li><a href="#_exploring_unknown_project">Exploring Unknown Project</a></li>
<li><a href="#_substitute_date_dimension_for_another_one">Substitute Date Dimension for Another One</a></li>
</ul>
</li>
<li><a href="#_05_testing">05 Testing</a>
<ul class="sectlevel2">
<li><a href="#_testing_report_result">Testing Report Result</a></li>
</ul>
</li>
<li><a href="#_06_working_with_projects">06 Working With Projects</a>
<ul class="sectlevel2">
<li><a href="#_creating_empty_project">Creating Empty Project</a></li>
<li><a href="#_renaming_project">Renaming Project</a></li>
<li><a href="#_cloning_project">Cloning Project</a></li>
<li><a href="#_cloning_project_accross_organizations">Cloning Project accross Organizations</a></li>
<li><a href="#_creating_empty_project_using_specific_environment">Creating Empty Project using specific environment.</a></li>
<li><a href="#_creating_project_from_template">Creating Project from Template</a></li>
<li><a href="#_migrating_objects_between_projects">Migrating objects between projects</a></li>
</ul>
</li>
<li><a href="#_07_deployment_recipes">07 Deployment Recipes</a>
<ul class="sectlevel2">
<li><a href="#_deploying_process">Deploying Process</a></li>
<li><a href="#_redeploying_existing_process">Redeploying Existing Process</a></li>
<li><a href="#_scheduling_process">Scheduling Process</a></li>
<li><a href="#_disabling_schedules_in_all_projects">Disabling Schedules in All Projects</a></li>
<li><a href="#_executing_schedule">Executing Schedule</a></li>
<li><a href="#_executing_process">Executing Process</a></li>
<li><a href="#_run_after_scheduling">Run-After Scheduling</a></li>
<li><a href="#_changing_an_existing_schedule">Changing an existing schedule</a></li>
<li><a href="#_investigating_executions">Investigating Executions</a></li>
<li><a href="#_visualizing_executions">Visualizing executions</a></li>
</ul>
</li>
<li><a href="#_08_working_with_reports">08 Working With Reports</a>
<ul class="sectlevel2">
<li><a href="#_computing_report">Computing Report</a></li>
<li><a href="#_comparing_reports_across_projects">Comparing Reports across Projects</a></li>
<li><a href="#_updating_report_definition">Updating report definition</a></li>
<li><a href="#_creating_report_that_counts_records_in_all_datasets">Creating Report that Counts Records in All Datasets</a></li>
<li><a href="#_reseting_report_color_map">Reseting Report Color Map</a></li>
<li><a href="#_computing_ad_hoc_report">Computing Ad Hoc Report</a></li>
<li><a href="#_working_with_report_results">Working with report results</a></li>
</ul>
</li>
<li><a href="#_09_working_with_facts_metrics_and_attributes">09 Working With Facts Metrics And Attributes</a>
<ul class="sectlevel2">
<li><a href="#_creating_metrics_from_attributes">Creating Metrics from Attributes</a></li>
<li><a href="#_creating_metrics_from_facts">Creating Metrics from Facts</a></li>
<li><a href="#_write_information_about_project_s_metrics_to_csv">Write Information about Project&#8217;s Metrics to CSV</a></li>
<li><a href="#_changing_metric_s_number_formatting">Changing Metric&#8217;s Number Formatting</a></li>
<li><a href="#_creating_metrics">Creating Metrics</a></li>
</ul>
</li>
<li><a href="#_10_working_with_dashboards">10 Working With Dashboards</a>
<ul class="sectlevel2">
<li><a href="#_listing_dashboards">Listing Dashboards</a></li>
</ul>
</li>
<li><a href="#_11_working_with_data_permissions">11 Working With Data Permissions</a>
<ul class="sectlevel2">
<li><a href="#_setting_up_simple_data_permission">Setting Up Simple Data Permission</a></li>
<li><a href="#_list_data_permissions">List Data Permissions</a></li>
<li><a href="#_setting_data_permissions_from_csv_column_format">Setting Data Permissions from CSV (column format)</a></li>
<li><a href="#_setting_data_permissions_from_csv_row_format">Setting Data Permissions from CSV (row format)</a></li>
<li><a href="#_list_variable_values">List Variable Values</a></li>
</ul>
</li>
<li><a href="#_12_working_with_blueprints">12 Working With Blueprints</a>
<ul class="sectlevel2">
<li><a href="#_what_is_blueprint">What is blueprint</a></li>
<li><a href="#_creating_project_from_blueprint">Creating Project from Blueprint</a></li>
<li><a href="#_getting_blueprint_from_existing_project">Getting Blueprint from Existing Project</a></li>
<li><a href="#_loading_data_to_project">Loading Data to Project</a></li>
<li><a href="#_loading_multiple_data_sets_to_project">Loading Multiple Data Sets to Project</a></li>
<li><a href="#_loading_data_with_specific_date_format">Loading Data with Specific Date Format</a></li>
<li><a href="#_adding_new_ldm_fields_to_project">Adding New LDM Fields to Project</a></li>
<li><a href="#_specifying_fields_data_type">Specifying Fields Data Type</a></li>
<li><a href="#_working_with_folders">Working with Folders</a></li>
<li><a href="#_creating_project_in_one_page_of_code">Creating Project in One Page of Code</a></li>
<li><a href="#_using_attribute_types_when_creating_project">Using Attribute Types when Creating Project</a></li>
<li><a href="#_moving_fields_in_blueprint">Moving fields in blueprint</a></li>
<li><a href="#_working_with_hr_demo_project">Working with HR Demo project</a></li>
<li><a href="#_refactoring_datasets">Refactoring datasets</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_01_getting_started">01 Getting Started</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_supported_ruby_versions">Supported Ruby Versions</h3>
<div class="paragraph">
<p>by Tomas Korcak</p>
</div>
<div class="sect3">
<h4 id="_problem">Problem</h4>
<div class="paragraph">
<p>You want to know which Ruby to use with the SDK.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution">Solution</h4>
<div class="paragraph">
<p>Here is a list of supported ruby versions.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ruby 1.9.3</p>
</li>
<li>
<p>Ruby 2.0</p>
</li>
<li>
<p>Ruby 2.1</p>
</li>
<li>
<p>Ruby 2.2</p>
</li>
<li>
<p>JRuby with Oracle Java 1.8.0.51</p>
</li>
<li>
<p>JRuby with OpenJDK 1.8.0.51</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Unfortunately JRuby with latest version of Java (1.8.0.60) is not supported because of issues with SSL. Using latest JRuby with Java higher than 1.8.0.51 is going to cause network communication issues (WebDav authentication). We will support latest Java as soon as soon as these issues are resolved.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_working_with_project_interactively">Working with Project Interactively</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_2">Problem</h4>
<div class="paragraph">
<p>You want to use SDK on a project but writing a script seems like too much of a hassle.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_2">Solution</h4>
<div class="paragraph">
<p>You first need to install gooddata gem using</p>
</div>
<div class="literalblock">
<div class="content">
<pre>gem install gooddata</pre>
</div>
</div>
<div class="paragraph">
<p>There are several methods by which you can work with the GoodData Ruby SDK. Let’s look at the major ones.</p>
</div>
<div class="sect4">
<h5 id="_irb">IRB</h5>
<div class="paragraph">
<p>irb is an interactive console that is provided with your Ruby installation. You may use gooddata sdk inside your irb. Below are some of the basic steps.</p>
</div>
<div class="paragraph">
<p>First, launch irb. In your terminal, execute the following:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>irb</pre>
</div>
</div>
<div class="paragraph">
<p>You should receive a message similar to the following, which indicates that you are inside the interactive Ruby environment:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>2.1-head :001 &gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Let’s start playing with gooddata. Enter the following:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&gt; GoodData</pre>
</div>
</div>
<div class="paragraph">
<p>You should receive the following:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>NameError: uninitialized constant GoodData</pre>
</div>
</div>
<div class="paragraph">
<p>This error message indicates that irb does not know about the gooddata SDK. So, let’s tell irb to require the SDK:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&gt; require 'gooddata'
  =&gt; true</pre>
</div>
</div>
<div class="paragraph">
<p>Ok. Now, repeat the previous command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&gt; GoodData
  =&gt; GoodData</pre>
</div>
</div>
<div class="paragraph">
<p>The response indicates that irb knows about SDK. Let’s try to log in to the GoodData platform with your credentials through the SDK. * For clarity, the &gt; sign is omitted in the irb session from now on.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>client = GoodData.connect("john@example.com", "password")</pre>
</div>
</div>
<div class="paragraph">
<p>You should be logged in. Now, you can perform tasks that do not require you to be inside of a specific project. For example, use the following to list all of your projects:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>client.projects</pre>
</div>
</div>
<div class="paragraph">
<p>To work with a project, you must define the project for the SDK. For example, suppose you wish to list the reports in a project. You must tell the SDK the project to review:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>project = client.projects('PROJECT_ID')</pre>
</div>
</div>
<div class="paragraph">
<p>To list the reports in this project:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>project.reports</pre>
</div>
</div>
<div class="paragraph">
<p>Ok. To exit irb, enter:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>exit</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_jack_in">jack_in</h5>
<div class="paragraph">
<p>Working with GoodData SDK using irb can be cumbersome. To make things a bit easier, Gooddata SDK includes a gooddata command line interface. One of the commands is jack_in which brings you into a live project where you can poke and explore.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>gooddata -U john@example.com -P password -p PROJECT_ID project jack_in</pre>
</div>
</div>
<div class="paragraph">
<p>In a single command, the above launches the command line interface, logs you into the platform, and identifies the project to which to connect. At this point, you may begin entering commands:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>reports = project.reports</pre>
</div>
</div>
<div class="paragraph">
<p><strong>NOTE</strong>: Use the ~/.gooddata file to save your username and password locally, so you do not have to type it every single time.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_scripting">Scripting</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_3">Problem</h4>
<div class="paragraph">
<p>You created a program by building it up in an interactive manner but now you would like to put it into a file to be able to run it</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_3">Solution</h4>
<div class="paragraph">
<p>Let&#8217;s assume that your fantastic code that you have is fairly simple. You would like to print the title of the project. So the session looks something like this</p>
</div>
<div class="literalblock">
<div class="content">
<pre>project_live_session: puts project.title
"My project Test (2)"
=&gt; nil</pre>
</div>
</div>
<div class="paragraph">
<p>Not too fancy but it is enough to help us illustrate couple of points. First you need to save your code to a file. Go ahead take your favorite text editor and create a new file and put your code into it so it looks like this</p>
</div>
<div class="literalblock">
<div class="content">
<pre>puts client.projects</pre>
</div>
</div>
<div class="paragraph">
<p>Go ahead and save it and call it 'my_first_sdk_program.rb'. Do not execute because it would not work now. Let&#8217;s add couple more things.</p>
</div>
<div class="paragraph">
<p>Jack in does couple of things for you so you can be productive quickly but we have to handle them ourselves in a program.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Loads Automation SDK libraries</p>
</li>
<li>
<p>It logs you in and provides you the client as a <code>client</code> variable</p>
</li>
<li>
<p>It jacks into a project and provides you the project as a <code>project</code> variable. If you were wondering why the <code>project.title</code> worked in the interactive session in the first place since we never defined <code>project</code> this is why.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We can easily do the same things with these 3 lines of code respectively. So add them to the file so the end result looks like this.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>require 'gooddata'</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>client = GoodData.connect('username', 'pass')
project = client.projects('project_id')
puts project.title</pre>
</div>
</div>
<div class="paragraph">
<p>Done. Save it.</p>
</div>
<div class="paragraph">
<p>Now you can run it by using this command</p>
</div>
<div class="literalblock">
<div class="content">
<pre>ruby my_first_sdk_program.rb</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_connecting_to_gooddata_platform">Connecting to Gooddata Platform</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_4">Problem</h4>
<div class="paragraph">
<p>You know how to jack in and how to write a simple program. Now it is time to combine these two to write a program that connects and does something with a gooddata project.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_4">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
    <span class="comment"># just so you believe us we are printing names of all the project under this account</span>
    client.projects.each <span class="keyword">do</span> |project|
        puts project.title
    <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion">Discussion</h4>
<div class="paragraph">
<p>Maybe you are wondering if there are other ways how to log in. First of all it is not nice to have secret credentials in plain text like this. SDK has one feature to help you. If <code>GoodData.with_connection</code> or <code>GoodData.connect</code> is called without any params it tries to find the param file that contains these credentials. Currently it looks for ~/.gooddata and expects it to have following content</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">username</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">john@example.com</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">pass</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">auth_token</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">token</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You do not have to create it yourself. Run <code>gooddata auth store</code> and a wizard is going to help you.</p>
</div>
<div class="paragraph">
<p>Also it is possible to pass parameters as hash. The form that we have shown is just a convenience form.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">  <span class="constant">GoodData</span>.with_connection(<span class="key">username</span>: <span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="key">password</span>: <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_connecting_to_gooddata_using_single_sign_on_sso">Connecting to GoodData using Single Sign On (SSO)</h3>
<div class="paragraph">
<p>by Tomas Korcak</p>
</div>
<div class="sect3">
<h4 id="_problem_5">Problem</h4>
<div class="paragraph">
<p>You do have SSO enabled and want to use it for logging to GoodData without using username and password.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_5">Solution</h4>
<div class="paragraph">
<p>Using the SSO capability you don’t need to maintain just another password for accessing GoodData application.
You can use your existing infrastructure for user management and connect with GoodData APIs to allow your users login to GoodData seamlessly.</p>
</div>
<div class="paragraph">
<p>For more info check this article - <a href="https://developer.gooddata.com/article/single-sign-on" class="bare">https://developer.gooddata.com/article/single-sign-on</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>
require <span class="string"><span class="delimiter">'</span><span class="content">pp</span><span class="delimiter">'</span></span>

client = <span class="constant">GoodData</span>.connect_sso(<span class="string"><span class="delimiter">'</span><span class="content">tomas.korcak@gooddata.com</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">gooddata.tomas.korcak</span><span class="delimiter">'</span></span>)

pp client.user.json</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_2">Discussion</h4>
<div class="paragraph">
<p>Never share the your private key with other people. It is the same thing as you name and password. You can do almost everything with it.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_connecting_to_different_servers">Connecting to Different Servers</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_6">Problem</h4>
<div class="paragraph">
<p>Sometimes the server you would like to connect is not the secure.goodata.com machine. This might occur for 2 reasons. Either you are trying something on a test machine (if you are working for gooddata) or you are working with a project that is on a white labeled instance.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_6">Solution</h4>
<div class="paragraph">
<p>Solution to both is passing the server name as a pareameter to connect or with_connection functions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>
require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="key">login</span>: <span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>,
                         <span class="key">password</span>: <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>,
                         <span class="key">server</span>: <span class="string"><span class="delimiter">'</span><span class="content">https://some-other-server.com</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
  <span class="comment"># just so you believe us we are printing names of all the project under this account</span>
  client.projects.each <span class="keyword">do</span> |project|
    puts project.title
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_3">Discussion</h4>

</div>
</div>
<div class="sect2">
<h3 id="_connecting_to_gooddata_platform_with_super_secure_token_sst">Connecting to GoodData Platform with Super Secure Token (SST)</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_7">Problem</h4>
<div class="paragraph">
<p>You do not have credentials. You only have SST and would like to still make some requests.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_7">Solution</h4>
<div class="paragraph">
<p>Super Secure Token is a token that allows to access you our APIs in a nonrestricted matter without necessarily knowing username and password. Take note that currently you do not have access to whole API. Things like interacting with DSS and Staging Storage still need username and pass. We are trying t resolve the issue.
First you need to have SST token. There are several ways how to obtain it. Here is one using SDK</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

client = <span class="constant">GoodData</span>.connect(<span class="key">login</span>: <span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="key">password</span>: <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>)
client.connection.sst_token

<span class="comment"># Once you have the token, you can try to login and do something.</span>

<span class="constant">GoodData</span>.with_connection(<span class="key">sst_token</span>: <span class="string"><span class="delimiter">'</span><span class="content">sst_token</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
  client.projects.each <span class="keyword">do</span> |p|
    puts p.title
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_4">Discussion</h4>
<div class="paragraph">
<p>Never share the token with other people. It is the same thing as your login and password. You can do almost everything with it.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_handling_credentials_securely">Handling Credentials Securely</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_8">Problem</h4>
<div class="paragraph">
<p>You would like to write scripts that are sharable. Currently you either have to rely on ~/.gooddata file or put there the credentials by hand. This is error prone and you have to be careful so you do not share your passwords.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_8">Solution</h4>
<div class="paragraph">
<p>There is fairly easy solution that you can use. If you recall correctly there is a way how you can log in into platform.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="constant">GoodData</span>.connect(<span class="key">login</span>: <span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="key">password</span>: <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This takes several types of parameters one of which is a hash of values. You can leverage that and read the hash from a file. There a many variants we are going to show 2 most popular ones, YAML and JSON.</p>
</div>
<div class="sect4">
<h5 id="_json">JSON</h5>
<div class="paragraph">
<p>Create a file that looks like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">login</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">john@gooddata.com</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">my_secret</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">params = <span class="constant">JSON</span>.parse(<span class="constant">File</span>.read(<span class="string"><span class="delimiter">'</span><span class="content">/path/to/file</span><span class="delimiter">'</span></span>))
client = <span class="constant">GoodData</span>.connect(params)
puts client.projects.count</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_yaml">YAML</h5>
<div class="paragraph">
<p>Create a file that looks like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">login</span>: <span class="string"><span class="content">john@gooddata.com</span></span>
<span class="key">password</span>: <span class="string"><span class="content">my_secret</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">require <span class="string"><span class="delimiter">'</span><span class="content">yaml</span><span class="delimiter">'</span></span>

params = <span class="constant">YAML</span>.load(<span class="constant">File</span>.read(<span class="string"><span class="delimiter">'</span><span class="content">/path/to/file</span><span class="delimiter">'</span></span>))
client = <span class="constant">GoodData</span>.connect(params)
puts client.projects.count</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_5">Discussion</h4>
<div class="paragraph">
<p>You see that you can easily share these scripts with other people since you have externalized all sensitive information. If the user will put the config file on a expected place everything will just work. There are other formats and ways you can leverage but the idea is always the same.</p>
</div>
<div class="paragraph">
<p>This is actually something we do behind the scenes if you do not specify any params into connect or with_connection. We look at ~/.gooddata for a JSON file and use what we find there. This is extremely useful when you are showing things interactively so you do not have to disclose your credentials. You can either go and create the file by hand or you can use a convenience method we have created for you. Just call gooddata auth store and you will be asked couple of questions and the file will be created for you.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_project">Using Project</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_9">Problem</h4>
<div class="paragraph">
<p>You want to use a specific project</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_9">Solution</h4>
<div class="paragraph">
<p>You can use couple of ways to do this. Our favorite is this</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_pid</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    puts project.title
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This has a benefit that you have access to project only inside the block. Once the block is left you are 'disconnected to the project. If you are using several projects in one script this is a way to go to be sure you are not reaching somewhere you do not want to.</p>
</div>
<div class="paragraph">
<p>There are other more conventional ways to do the same thing.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
  project = <span class="constant">GoodData</span>.use(<span class="string"><span class="delimiter">'</span><span class="content">project_pid</span><span class="delimiter">'</span></span>)
  puts project.title
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_apis">Using APIs</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_10">Problem</h4>
<div class="paragraph">
<p>You would like to interact with GoodData API directly</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_10">Solution</h4>
<div class="paragraph">
<p>SDK provides you slew of well known methods that make this possible while shielding you from intricacies of keeping connection alive etc.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

client.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">/gdc/md/</span><span class="delimiter">&quot;</span></span>)

project_id = <span class="string"><span class="delimiter">'</span><span class="content">YOUR_PROJECT_ID</span><span class="delimiter">'</span></span>

client.delete(<span class="string"><span class="delimiter">&quot;</span><span class="content">/gdc/projects/</span><span class="inline"><span class="inline-delimiter">#{</span>project_id<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_disabling_ssl_verification">Disabling SSL Verification</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_11">Problem</h4>
<div class="paragraph">
<p>You would like to disable SSL verification when using SDK against a server that does not have proper certificates</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_11">Solution</h4>
<div class="paragraph">
<p>You can switch of SSL validating like this. This is especially useful when you are using SDK against testing or development servers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="comment"># Traditionally with login and pass</span>
client = <span class="constant">GoodData</span>.connect(<span class="key">login</span>: <span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="key">password</span>: <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>, <span class="key">verify_ssl</span>: <span class="predefined-constant">false</span>)

<span class="comment"># You can also use it with SST token</span>
client = <span class="constant">GoodData</span>.connect(<span class="key">sst_token</span>: <span class="string"><span class="delimiter">'</span><span class="content">sst_token</span><span class="delimiter">'</span></span>, <span class="key">verify_ssl</span>: <span class="predefined-constant">false</span>)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_6">Discussion</h4>

</div>
</div>
<div class="sect2">
<h3 id="_using_asynchronous_tasks_with_timeouts">Using Asynchronous Tasks with Timeouts</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_12">Problem</h4>
<div class="paragraph">
<p>You would like to build on top of SDK but you would like to have more controll over asynchronous tasks</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_12">Solution</h4>
<div class="paragraph">
<p>There are numerous tasks on GoodData API which potentially take more than just couple of seconds to execute. These include report executions, data loads, exports, clones and others.</p>
</div>
<div class="paragraph">
<p>The way these tasks are implemented in SDK that they block. The execution continues only when the task finishes (either success or error) or the server time limit is reached and the task is killed.</p>
</div>
<div class="paragraph">
<p>Sometimes it is useful to be able to specify the time limit on the client side. This might be useful for cases where you need to make sure that something is either finished under a certain tim threshold or you have to make some other action (notifying a customer). The limit you would like to use is different then the server side limit of GoodData APIs.</p>
</div>
<div class="paragraph">
<p>You can implement it like this</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

client = <span class="constant">GoodData</span>.connect
project = client.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)
report = project.reports(<span class="integer">1234</span>)
<span class="keyword">begin</span>
  puts report.execute(<span class="key">time_limit</span>: <span class="integer">10</span>)
<span class="keyword">rescue</span> <span class="constant">GoodData</span>::<span class="constant">ExecutionLimitExceeded</span> =&gt; e
  puts <span class="string"><span class="delimiter">&quot;</span><span class="content">Unfortunately </span><span class="inline"><span class="inline-delimiter">#{</span>report.title<span class="inline-delimiter">}</span></span><span class="content"> execution did not finish in 10 seconds</span><span class="delimiter">&quot;</span></span>
  raise e
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_logging">Logging</h3>
<div class="paragraph">
<p>by Zdenek Svoboda</p>
</div>
<div class="sect3">
<h4 id="_problem_13">Problem</h4>
<div class="paragraph">
<p>Your script doesn&#8217;t work or throws a weird error. You want to see detailed logging information to understand what is going on.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_13">Solution</h4>
<div class="paragraph">
<p>GoodData Ruby SDK uses the standard Ruby logger that you can use in standard way</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

logger = <span class="constant">Logger</span>.new(<span class="predefined-constant">STDOUT</span>)
logger.level = <span class="constant">Logger</span>::<span class="constant">DEBUG</span>
<span class="constant">GoodData</span>.logger = logger</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also use following abbreviated syntax for logging to standard output using DEBUG level</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.logging_http_on</code></pre>
</div>
</div>
<div class="paragraph">
<p>or using INFO level</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.logging_on</code></pre>
</div>
</div>
<div class="paragraph">
<p>another option is to specify the debug level explicitly</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.logging_on(<span class="constant">Logger</span>::<span class="constant">DEBUG</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are quite a few options to choose from. Feel free to use whatever you like the best.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_02_working_with_users">02 Working With Users</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_listing_project_s_users">Listing Project&#8217;s Users</h3>
<div class="paragraph">
<p>by Tomas Korcak</p>
</div>
<div class="sect3">
<h4 id="_problem_14">Problem</h4>
<div class="paragraph">
<p>You would like to list users in project</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites">Prerequisites</h4>
<div class="paragraph">
<p>You have to have a user who is a project admin.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_14">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_pid</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    pp project.users
    <span class="comment"># You might want to see just name and login</span>
    pp project.users.map {|u| [u.login, u.name]}
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_checking_user_memberhip_in_project">Checking User Memberhip in Project</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_15">Problem</h4>
<div class="paragraph">
<p>You would like to see if a user is part of a project.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_2">Prerequisites</h4>
<div class="paragraph">
<p>You have to have a user who is an admin of an organization. If you don&#8217;t have the organization admin account, please contact your primary GoodData contact person or GoodData support (e-mail <a href="mailto:support@gooddata.com">support@gooddata.com</a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_15">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_pid</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    project.member?(<span class="string"><span class="delimiter">'</span><span class="content">jane.doe@example.com</span><span class="delimiter">'</span></span>)
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_7">Discussion</h4>
<div class="paragraph">
<p>You can ask on membership not just by login but also check an object. This might be useful especially if you check a user from several projects.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_enabling_and_disabling_users">Enabling and Disabling Users</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_16">Problem</h4>
<div class="paragraph">
<p>You need to enable or disable users in a project.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_3">Prerequisites</h4>
<div class="paragraph">
<p>You have to have a user who is an admin in a project you would like to disable users in.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_16">Solution</h4>
<div class="paragraph">
<p>Disable and enable particular user in GoodData project</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="comment"># Connect to platform using credentials</span>
<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_pid</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    user = project.member(<span class="string"><span class="delimiter">'</span><span class="content">john@example.com</span><span class="delimiter">'</span></span>)
    user.disable
    <span class="comment"># You can reenable the user again</span>
    user.enable
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Disable all users in GoodData project</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="comment"># Connect to platform using credentials</span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_pid</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    <span class="comment"># We collect all users minus current user</span>
    <span class="comment"># so we do not disable ourselves from the project</span>
    users_to_disable = project.users.reject { |u| u.login == c.user.login }
    <span class="comment"># disable all users</span>
    users_to_disable.pmap {|u| u.disable}
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to keep more than one user you can do something like this</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="comment"># Connect to platform using credentials</span>
<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_pid</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    keepers = [<span class="string"><span class="delimiter">'</span><span class="content">john@example.com</span><span class="delimiter">'</span></span>, c.user.login]
    <span class="comment"># We collect all users and remove those from the keepers array</span>
    users_to_disable = project.users.reject { |u| keepers.include?(u.login) }
    <span class="comment"># disable all users</span>
    users_to_disable.pmap { |u| u.disable }
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_8">Discussion</h4>
<div class="paragraph">
<p>As you can see from the above examples possibilities are endless and you can easily enable or disable users just by correctly prepare the array of users to work with by using regular methods on arrays.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_multiple_users_from_csv">Creating Multiple Users from CSV</h3>
<div class="paragraph">
<p>by Patrick McConlogue, Tomas Korcak</p>
</div>
<div class="sect3">
<h4 id="_problem_17">Problem</h4>
<div class="paragraph">
<p>You have CSV containing users, their roles and passwords and you want to create them in bulk.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_4">Prerequisites</h4>
<div class="paragraph">
<p>You have to have existing project and be admin of it.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_17">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: UTF-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="comment"># Project ID</span>
<span class="constant">PROJECT_ID</span> = <span class="string"><span class="delimiter">'</span><span class="content">we1vvh4il93r0927r809i3agif50d7iz</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="constant">PROJECT_ID</span>) <span class="keyword">do</span> |project|
    path = <span class="constant">File</span>.join(<span class="constant">File</span>.dirname(<span class="predefined-constant">__FILE__</span>), <span class="string"><span class="delimiter">'</span><span class="content">..</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">data</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">users.csv</span><span class="delimiter">'</span></span>)
    puts <span class="string"><span class="delimiter">&quot;</span><span class="content">Loading </span><span class="inline"><span class="inline-delimiter">#{</span>path<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
    <span class="constant">CSV</span>.foreach(path, <span class="symbol">:headers</span> =&gt; <span class="predefined-constant">true</span>, <span class="symbol">:return_headers</span> =&gt; <span class="predefined-constant">false</span>) <span class="keyword">do</span> |user|
      email = user[<span class="integer">0</span>]
      role = user[<span class="integer">1</span>]
      project.invite(email, role)
    <span class="keyword">end</span>
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_inviting_users_to_project">Inviting Users to Project</h3>
<div class="paragraph">
<p>by Tomas Korcak</p>
</div>
<div class="sect3">
<h4 id="_problem_18">Problem</h4>
<div class="paragraph">
<p>You need to invite a user into project.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_5">Prerequisites</h4>
<div class="paragraph">
<p>You have to have a user who is an admin of an organization. If you don&#8217;t have the organization admin account, please contact your primary GoodData contact person or GoodData support (e-mail <a href="mailto:support@gooddata.com">support@gooddata.com</a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_18">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

client = <span class="constant">GoodData</span>.connect
project = client.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_pid</span><span class="delimiter">'</span></span>)

project.invite(<span class="string"><span class="delimiter">'</span><span class="content">joe@example.com</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">admin</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Hey Joe, look at this.</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_9">Discussion</h4>
<div class="paragraph">
<p>Invitation can be sent by any administrator. Invited user receives invitation e-mail with invitation confirmation. If you want to add user into a project  without the e-mail and confirmation, please consult the recipe Adding users to Project.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_listing_organization_s_users">Listing Organization&#8217;s Users</h3>
<div class="paragraph">
<p>by Tomas Korcak</p>
</div>
<div class="sect3">
<h4 id="_problem_19">Problem</h4>
<div class="paragraph">
<p>You would like to list users in organization</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_6">Prerequisites</h4>
<div class="paragraph">
<p>You have to have a user who is an admin of an organization. If you don&#8217;t have the organization admin account, please contact your primary GoodData contact person or GoodData support (e-mail <a href="mailto:support@gooddata.com">support@gooddata.com</a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_19">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="comment"># Connect to platform using credentials</span>
client = <span class="constant">GoodData</span>.connect

domain = client.domain(<span class="string"><span class="delimiter">'</span><span class="content">domain_name</span><span class="delimiter">'</span></span>)
users = domain.users
pp users</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_adding_user_to_organization">Adding User to Organization</h3>
<div class="paragraph">
<p>by Tomas Korcak</p>
</div>
<div class="sect3">
<h4 id="_problem_20">Problem</h4>
<div class="paragraph">
<p>You would like to add a user to organization programmatically</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_7">Prerequisites</h4>
<div class="paragraph">
<p>You have to have a user who is an admin of an organization. If you don&#8217;t have the organization admin account, please contact your primary GoodData contact person or GoodData support (e-mail <a href="mailto:support@gooddata.com">support@gooddata.com</a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_20">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

client = <span class="constant">GoodData</span>.connect

<span class="comment"># Get your domain ..</span>
domain = client.domain(<span class="string"><span class="delimiter">'</span><span class="content">domain_name</span><span class="delimiter">'</span></span>)

<span class="comment"># Generate random password</span>
pass = (<span class="integer">0</span>...<span class="integer">10</span>).map { (<span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span>..<span class="string"><span class="delimiter">'</span><span class="content">z</span><span class="delimiter">'</span></span>).to_a[rand(<span class="integer">26</span>)] }.join

new_user = domain.add_user(
  <span class="symbol">:login</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">new.user@gooddata.com</span><span class="delimiter">'</span></span>,
  <span class="symbol">:password</span> =&gt; pass,
  <span class="symbol">:first_name</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">First</span><span class="delimiter">'</span></span>,
  <span class="symbol">:last_name</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">Last</span><span class="delimiter">'</span></span>,
  <span class="symbol">:email</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">test@gooddata.com</span><span class="delimiter">'</span></span>,
  <span class="symbol">:sso_provider</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">some_sso</span><span class="delimiter">'</span></span>
)

pp new_user</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_adding_multiple_users_to_organization_from_csv">Adding Multiple Users to Organization from CSV</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_21">Problem</h4>
<div class="paragraph">
<p>You would like to add a users to organization programmatically. What you have is a CSV file holding the information about the users.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_8">Prerequisites</h4>
<div class="paragraph">
<p>You have to have a user who is an admin of an organization. If you don&#8217;t have the organization admin account, please contact your primary GoodData contact person or GoodData support (e-mail <a href="mailto:support@gooddata.com">support@gooddata.com</a>).</p>
</div>
<div class="paragraph">
<p>We assume that you have a file with details handy. The file can look for example like this</p>
</div>
<div class="literalblock">
<div class="content">
<pre>login,first_name,last_name,password
john@example.com,John,Doe,12345678</pre>
</div>
</div>
<div class="paragraph">
<p>The headers we used are defaults. If you have different ones you will have to do some mangling. Minimal information that you have to provide for the user creation to be successful is login.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_21">Solution</h4>
<div class="paragraph">
<p>First let&#8217;s have a look how to implement an addition with having the file as in the example above. This has the advantage that you do not have to mangle with the headers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>
require <span class="string"><span class="delimiter">'</span><span class="content">active_support/all</span><span class="delimiter">'</span></span>

client = <span class="constant">GoodData</span>.connect

domain = client.domain(<span class="string"><span class="delimiter">'</span><span class="content">domain-name</span><span class="delimiter">'</span></span>)
users = []
<span class="constant">CSV</span>.foreach(<span class="string"><span class="delimiter">'</span><span class="content">data.csv</span><span class="delimiter">'</span></span>, <span class="symbol">:headers</span> =&gt; <span class="predefined-constant">true</span>, <span class="symbol">:return_headers</span> =&gt; <span class="predefined-constant">false</span>) <span class="keyword">do</span> |row|
  users &lt;&lt; row.to_hash.symbolize_keys
<span class="keyword">end</span>

domain.create_users(users)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sometimes though what you have is that the file that comes from the system has different headers than would be ideal. One possible thing you can do is to transform it in a separate ETL process or you can change the code slightly to compensate. In the next code snippet we will show you how to do just that.</p>
</div>
<div class="paragraph">
<p>Imagine you have a file like this</p>
</div>
<div class="literalblock">
<div class="content">
<pre>UserLogin,FirstName,LastName,UserPassword
john@example.com,John,Doe,12345678</pre>
</div>
</div>
<div class="paragraph">
<p>Notice that it is exactly the same information as before. The only difference is that you have different headers.</p>
</div>
<div class="paragraph">
<p>This is the code add those users to a domain.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

client = <span class="constant">GoodData</span>.connect

headers = [<span class="string"><span class="delimiter">&quot;</span><span class="content">UserLogin</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">FirstName</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">LastName</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">UserPassword</span><span class="delimiter">&quot;</span></span>]
new_headers = [<span class="symbol">:login</span>, <span class="symbol">:first_name</span>, <span class="symbol">:last_name</span>, <span class="symbol">:password</span>]

domain = client.domain(<span class="string"><span class="delimiter">'</span><span class="content">domain-name</span><span class="delimiter">'</span></span>)
users = []
<span class="constant">CSV</span>.foreach(<span class="string"><span class="delimiter">'</span><span class="content">data.csv</span><span class="delimiter">'</span></span>, <span class="symbol">:headers</span> =&gt; <span class="predefined-constant">true</span>, <span class="symbol">:return_headers</span> =&gt; <span class="predefined-constant">false</span>) <span class="keyword">do</span> |row|
  new_data = new_headers.zip(row.to_hash.values_at(*headers))
  users &lt;&lt; <span class="constant">Hash</span>[new_data]
<span class="keyword">end</span>

domain.create_users(users)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice that the bulk of the code is the same. The only differences are that we defined <code>headers</code> which contain the values of the headers in the CSV file provided. Variable <code>new_headers</code> provide the corresponding values for those headers that the SDK expects. Take not that the position is important and the headers for corresponding columns has to be in the same order in both variables.</p>
</div>
<div class="paragraph">
<p>The most important line in the code is this</p>
</div>
<div class="literalblock">
<div class="content">
<pre>new_headers.zip(row.to_hash.values_at(*headers))</pre>
</div>
</div>
<div class="paragraph">
<p>What it does is it exchanges the keys from <code>headers</code> to those defined in <code>new_headers</code>. This code does not return a Hash but array of key value pairs. This can be turned into a hash with this</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Hash[*new_data]</pre>
</div>
</div>
<div class="paragraph">
<p>The rest of the code is the same as in previous example.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_adding_user_from_organization_to_project">Adding User from Organization to Project</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_22">Problem</h4>
<div class="paragraph">
<p>You have users added in organization (domain). You would like to add them into the project.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_9">Prerequisites</h4>
<div class="paragraph">
<p>You have to have a user who is an admin of an organization. If you don&#8217;t have the organization admin account, please contact your primary GoodData contact person or GoodData support (e-mail <a href="mailto:support@gooddata.com">support@gooddata.com</a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_22">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  <span class="comment"># Get your domain ..</span>
  domain = client.domain(<span class="string"><span class="delimiter">'</span><span class="content">domain_name</span><span class="delimiter">'</span></span>)
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    <span class="comment"># Let's get all users except of ourselves</span>
    users_to_add = domain.users.reject { |u| u.login == client.user.login }
    <span class="comment"># Let's add all as viewer</span>
    users_to_add.each { |u| project.add_user(u, <span class="string"><span class="delimiter">'</span><span class="content">Viewer</span><span class="delimiter">'</span></span>, <span class="key">domain</span>: domain) }
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_adding_users_from_organization_to_multiple_projects">Adding Users from Organization to Multiple Projects</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_23">Problem</h4>
<div class="paragraph">
<p>You would like to add a users to project programmatically. You already have all the user profiles created in your organization (domain). You potentially have many projects that you would like to populate.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_10">Prerequisites</h4>
<div class="paragraph">
<p>You have to have a user who is an admin of an organization. If you don&#8217;t have the organization admin account, please contact your primary GoodData contact person or GoodData support (e-mail <a href="mailto:support@gooddata.com">support@gooddata.com</a>). You have an organization populated with user. If you don&#8217;t take a look at the recipe above (Adding user to organization)</p>
</div>
<div class="paragraph">
<p>We assume that you have a file with details which users should be added to a project. The file has to contain three pieces of information. Who you would like to add to a project, role that the user should take on in that project and which project he should be added to. The headers we used are defaults. If you have different ones you will have to do some mangling. Example of how to do that can be found in recipe adding_users_to_domain.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_23">Solution</h4>
<div class="paragraph">
<p>Sometimes the case might be that you would like to add users to a slew of projects in one go. Let&#8217;s illustrate this on one example. Let&#8217;s imagine that you have a file like this</p>
</div>
<div class="literalblock">
<div class="content">
<pre>pid,login,role
asl50ejow6bzp97i9pxlbcm3vkuvzQ72,john@example.com,admin</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>
require <span class="string"><span class="delimiter">'</span><span class="content">active_support/all</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
  domain = client.domain(<span class="string"><span class="delimiter">'</span><span class="content">domain-name</span><span class="delimiter">'</span></span>)
  users = []
  <span class="constant">CSV</span>.foreach(<span class="string"><span class="delimiter">'</span><span class="content">data.csv</span><span class="delimiter">'</span></span>, <span class="symbol">:headers</span> =&gt; <span class="predefined-constant">true</span>, <span class="symbol">:return_headers</span> =&gt; <span class="predefined-constant">false</span>) <span class="keyword">do</span> |row|
    users &lt;&lt; row.to_hash.symbolize_keys.slice(<span class="symbol">:pid</span>, <span class="symbol">:login</span>, <span class="symbol">:role</span>)
  <span class="keyword">end</span>
  users.group_by {|u| u[<span class="symbol">:pid</span>]}.map <span class="keyword">do</span> |project_id, users|
    <span class="constant">GoodData</span>.with_project(project_id) <span class="keyword">do</span> |project|
      project.import_users(users, <span class="key">domain</span>: domain, <span class="key">whitelists</span>: [<span class="string"><span class="delimiter">&quot;</span><span class="content">svarovsky@gooddata.com</span><span class="delimiter">&quot;</span></span>])
    <span class="keyword">end</span>
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>What this does is to reads the users groups them according to a project and then adds them to the project. It reads all the users into memory but this should be ok for typical situations of thousands users. Note that we are not getting a project dynamically for each group of users. All the notes for whitelist apply as well.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_adding_user_to_both_organization_and_project_from_csv">Adding User to Both Organization and Project from CSV</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_24">Problem</h4>
<div class="paragraph">
<p>You would like to add users from CSV file to a project and domain in one go. Best practice with automated projects is to add users to domain (organization) and then to add users from that domain to specific project(s). This allows you to bypass the invitation process and you can manipulate users without their consent which is usually what you want in those cases. Sometimes it could be useful to do this in one go. This is especially true if you have only one project and one organization.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_11">Prerequisites</h4>
<div class="paragraph">
<p>You have to have a user who is an admin of an organization. If you don&#8217;t have the organization admin account, please contact your primary GoodData contact person or GoodData support (e-mail <a href="mailto:support@gooddata.com">support@gooddata.com</a>).</p>
</div>
<div class="paragraph">
<p>We assume that you have a file with details handy. The file can look for example like this</p>
</div>
<div class="literalblock">
<div class="content">
<pre>login,first_name,last_name,password,role
john@example.com,John,Smith,12345678,admin
john.doe@example.com,John,Doe,87616393,admin</pre>
</div>
</div>
<div class="paragraph">
<p>The headers we used are defaults. If you have different ones you will have to do some mangling (see the recipe Adding user to organization from CSV file above). Minimal information that you have to provide for the user creation to be successful is login.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_24">Solution</h4>
<div class="paragraph">
<p>SDK has a method import_users that takes care of all the details and does exactly what is described above. Adds users to domain and then project.</p>
</div>
<div class="sect4">
<h5 id="_notes">Notes</h5>
<div class="ulist">
<ul>
<li>
<p>Process of adding users is not additive but declarative. What you provide on the input is what SDK will strive to have in the project at the end. This has some constraints on data preparation but it is much more resilient approach.</p>
</li>
<li>
<p>Connected to previous point sometimes you have users that you do not want to be touched by this process. ETL developers, admins etc that usually do not come from data. You can provide list of whitelist expressions as either string or regular expressions. What this means is the user that would be added or removed based on the data will be ignored by the process. In our example we want to omit user under which you are logged in.</p>
</li>
<li>
<p>Be careful so you do not lock yourself (etl administrator) out of the project. Be sure to add him/her to whitelist if he is not intrinsically in the data.</p>
</li>
<li>
<p>Note that above data will not work. Currently there is a constraint that each user has to have unique login across all users in GoodData. It is likely that there already is a <code>john@example.com</code> somewhere so change the test data accordingly.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>
require <span class="string"><span class="delimiter">'</span><span class="content">active_support/all</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_pid</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    users = []
    <span class="constant">CSV</span>.foreach(<span class="string"><span class="delimiter">'</span><span class="content">data.csv</span><span class="delimiter">'</span></span>, <span class="symbol">:headers</span> =&gt; <span class="predefined-constant">true</span>, <span class="symbol">:return_headers</span> =&gt; <span class="predefined-constant">false</span>) <span class="keyword">do</span> |row|
      users &lt;&lt; row.to_hash.symbolize_keys
    <span class="keyword">end</span>
    domain = client.domain(<span class="string"><span class="delimiter">'</span><span class="content">domain-name</span><span class="delimiter">'</span></span>)
    domain.create_users(users)
    project.import_users(users, <span class="key">domain</span>: domain)
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_updating_a_user_in_organization">Updating a User in Organization</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_25">Problem</h4>
<div class="paragraph">
<p>You have users in your organization but some of those have incorrect or outdated information and need update</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_12">Prerequisites</h4>
<div class="paragraph">
<p>You have to have a user who is an admin of an organization. If you don&#8217;t have the organization admin account, please contact your primary GoodData contact person or GoodData support (e-mail <a href="mailto:support@gooddata.com">support@gooddata.com</a>). You have an organization populated with user. If you don&#8217;t take a look at the recipe above (Adding user to organization)</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_25">Solution</h4>
<div class="paragraph">
<p>Here we are updating an sso provider but you can update almost any property of a user.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

client = <span class="constant">GoodData</span>.connect
domain = client.domain <span class="string"><span class="delimiter">'</span><span class="content">organization_name</span><span class="delimiter">'</span></span>
u = domain.find_user_by_login(<span class="string"><span class="delimiter">'</span><span class="content">john@gooddata.com</span><span class="delimiter">'</span></span>)
u.sso_provider = <span class="string"><span class="delimiter">'</span><span class="content">a_provider</span><span class="delimiter">'</span></span>
domain.update_user(u)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_03_automation_recipes">03 Automation Recipes</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_performing_operations_on_multiple_projects">Performing Operations on Multiple Projects</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_26">Problem</h4>
<div class="paragraph">
<p>You already know how to do many things but now you would like to do the same thing on many projects at once.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_26">Solution</h4>
<div class="paragraph">
<p>The basis of the solution is pretty simple. We need to iterate over projects and perform an operation on each of them.</p>
</div>
<div class="paragraph">
<p>Lets illustrate this on a simple example. We will compile a list of all reports from user&#8217;s projects that have been changed since last week by somebody from GoodData. If there is more than one revision in a report we&#8217;ll assume that the report is changing frequently and tag it with 'to_be_checked' tag for QA to validate the report.</p>
</div>
<div class="paragraph">
<p>This is a lot to do. Let&#8217;s try to break the tasks down to smaller pieces.</p>
</div>
<div class="sect4">
<h5 id="_work_with_many_projects">Work with many projects</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">projects = [ <span class="string"><span class="delimiter">'</span><span class="content">project_pid_a</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">project_pid_b</span><span class="delimiter">'</span></span>]
<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |c|
  projects.each <span class="keyword">do</span> |project|
    <span class="constant">GoodData</span>.with_project(project) <span class="keyword">do</span> |project|
      <span class="comment"># do your thing</span>
    <span class="keyword">end</span>
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_select_specific_reports">Select specific reports</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">reports_to_tag = project.reports
                   .select { |report| report.updated &gt; <span class="integer">2</span>.weeks.ago }
                   .select { |report| report.definitions.count &gt; <span class="integer">1</span> }</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_remove_tag">Remove tag</h5>
<div class="paragraph">
<p>We&#8217;ll first remove the 'to_be_checked' tag from all reports</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="constant">GoodData</span>::<span class="constant">Report</span>.find_by_tag(<span class="string"><span class="delimiter">'</span><span class="content">to_be_checked</span><span class="delimiter">'</span></span>, <span class="symbol">:project</span> =&gt; project).each <span class="keyword">do</span> |report|
  report.remove_tag(<span class="string"><span class="delimiter">'</span><span class="content">to_be_checked</span><span class="delimiter">'</span></span>)
  report.save
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_add_tag">Add tag</h5>
<div class="paragraph">
<p>Then we&#8217;ll add the 'to_be_checked' tag to all qualifying reports</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">reports_to_tag.each <span class="keyword">do</span> |report|
  report.add_tag(<span class="string"><span class="delimiter">'</span><span class="content">to_be_checked</span><span class="delimiter">'</span></span>)
  report.save
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_full_example_all_pieces_together">Full example - all pieces together</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|

  projects = [
      client.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_pid_a</span><span class="delimiter">'</span></span>),
      client.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_pid_b</span><span class="delimiter">'</span></span>)
  ]

  results = projects.map <span class="keyword">do</span> |project|
    reports_to_validate = project.reports
                                .select { |report| report.updated &gt; <span class="integer">2</span>.weeks.ago }
                                .select { |report| report.definitions.count &gt; <span class="integer">1</span> }

    <span class="constant">GoodData</span>::<span class="constant">Report</span>.find_by_tag(<span class="string"><span class="delimiter">'</span><span class="content">to_be_checked</span><span class="delimiter">'</span></span>, <span class="symbol">:project</span> =&gt; project).each <span class="keyword">do</span> |report|
      report.remove_tag(<span class="string"><span class="delimiter">'</span><span class="content">to_be_checked</span><span class="delimiter">'</span></span>)
      report.save
    <span class="keyword">end</span>

    reports_to_validate.each <span class="keyword">do</span> |report|
      report.add_tag(<span class="string"><span class="delimiter">'</span><span class="content">to_be_checked</span><span class="delimiter">'</span></span>)
      report.save
    <span class="keyword">end</span>

    {<span class="key">project</span>: project, <span class="key">reports_to_validate</span>: reports_to_validate.count}
  <span class="keyword">end</span>

  results.each <span class="keyword">do</span> |result|
    puts <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span>result[<span class="symbol">:project</span>].pid<span class="inline-delimiter">}</span></span><span class="content">: there are </span><span class="inline"><span class="inline-delimiter">#{</span>result[<span class="symbol">:reports_to_validate</span>]<span class="inline-delimiter">}</span></span><span class="content"> reports to check</span><span class="delimiter">&quot;</span></span>
  <span class="keyword">end</span>

<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_10">Discussion</h4>
<div class="paragraph">
<p>Please note that the reports in projects are processed sequentially (one after another).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_parallel_processing">Parallel Processing</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_27">Problem</h4>
<div class="paragraph">
<p>You created the script. It works but it is slow. Let&#8217;s have at one trick how to possibly make it faster.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_27">Solution</h4>
<div class="paragraph">
<p>Often if you look at the API the structure is orthogonal to your usecase. For example you might need to invite user to many projects but the API has only an endpoint to invite a user to single project. If you do something like.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">projects.map <span class="keyword">do</span> |project|
  project.invite_user(<span class="string"><span class="delimiter">'</span><span class="content">john@example.com</span><span class="delimiter">'</span></span>)
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>it will work but it will create as many requests as there are projects. The requests will be processed sequentially and this takes time. Just by some back of the napkin computation you can estimate. Let&#8217;s say we have 1000 projects and invitation request takes 500ms (half a second). This means it will take 500 seconds that is almost 10 mins.</p>
</div>
<div class="paragraph">
<p>The nice thing is that the requests for inviting user to each project are totally independent. You don&#8217;t need a project invitation to finish before you invite the user to another project. So you can invoke multiple invitations at the same time. The following code invokes multiple invitations in parallel</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">projects.pmap <span class="keyword">do</span> |project|
  project.invite_user(<span class="string"><span class="delimiter">'</span><span class="content">john@example.com</span><span class="delimiter">'</span></span>)
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We&#8217;ve just changed single letter. We are using pmap which stands for parallel map. It behaves exactly the same as map with one difference. Block for each item of the array runs in a separate thread. You do not need to think about it it just happens faster. We have currently 20 thread reserved so it will run 20 times faster. that is under 0.5 mins.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_04_model">04 Model</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_changing_object_s_identifier">Changing Object&#8217;s Identifier</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_28">Problem</h4>
<div class="paragraph">
<p>You moved an attribute in your model and you would like to change the identifier for it to follow the naming convention.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_28">Solution</h4>
<div class="paragraph">
<p>You can change identifier on any object (e.g. dashboards, reports, metrics, attributes, facts etc.). Many tools rely on specific LDM object identifier&#8217;s naming convention. So changing the identifier may be very handy for for enforcing the naming convention. For example lwhen you move an attribute from one dataset to another, you may want to change it&#8217;s identifier.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_pid</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|

    <span class="comment"># We find the attribute we want to change</span>
    <span class="comment"># Lets list all attributes in the project</span>
    <span class="comment"># and print its title and identifier</span>
    puts project.attributes.map {|a| [a.identifier, a.title]}

    <span class="comment"># Let's pick one</span>
    <span class="comment"># Here I just pick the first one</span>
    attribute = project.attributes.first

    <span class="comment"># but you can also pick one by identifier. For example</span>
    <span class="comment"># attribute = project.attributes('attr.salesmem.country')</span>
    <span class="comment"># We have a look at the current value.</span>
    <span class="comment"># Let's say it is 'attr.users.region'</span>
    puts attribute.identifier

    <span class="comment"># We change the value</span>
    attribute.identifier = <span class="string"><span class="delimiter">'</span><span class="content">attr.salesmen.region</span><span class="delimiter">'</span></span>
    attribute.save

    <span class="comment"># If we refresh the value from server</span>
    <span class="comment"># we get a new value 'attr.salesmen.region'</span>
    attribute.reload!
    puts attribute.identifier

  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_computing_dataset_s_number_of_records">Computing Dataset&#8217;s Number of Records</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_29">Problem</h4>
<div class="paragraph">
<p>Very often there is a need to know how many records there are in a dataset.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_29">Solution</h4>
<div class="paragraph">
<p>This is not so easy to do on UI. You basically have to find the dataset&#8217;s connection point and then create a simple report with COUNT metric. SDK makes this very simple task.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_pid</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    blueprint = project.blueprint
    blueprint.datasets.each <span class="keyword">do</span> |dataset|
      count = dataset.count(project)
      puts <span class="string"><span class="delimiter">&quot;</span><span class="content">Number of record in a dataset </span><span class="inline"><span class="inline-delimiter">#{</span>dataset.title<span class="inline-delimiter">}</span></span><span class="content"> is </span><span class="inline"><span class="inline-delimiter">#{</span>count<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
    <span class="keyword">end</span>
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_enumerating_date_dimensions">Enumerating Date Dimensions</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_30">Problem</h4>
<div class="paragraph">
<p>You would like to know how many date dimensions you have in a project.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_30">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_pid</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    blueprint = project.blueprint
    dds = blueprint.date_dimensions
    puts <span class="string"><span class="delimiter">&quot;</span><span class="content">You have </span><span class="inline"><span class="inline-delimiter">#{</span>dds.count<span class="inline-delimiter">}</span></span><span class="content"> date dimensions in your project</span><span class="delimiter">&quot;</span></span>
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_removing_data">Removing Data</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_31">Problem</h4>
<div class="paragraph">
<p>Sometimes you need to delete all data from a dataset.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_31">Solution</h4>
<div class="paragraph">
<p>SDK calls the MAQL SYNCHRONUIZE command on the dataset</p>
</div>
<div class="literalblock">
<div class="content">
<pre>SYNCHRONIZE {dataset.users};</pre>
</div>
</div>
<div class="paragraph">
<p>for each dataset you would like to clear. You can achieve the same like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_pid</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|

    <span class="comment"># You can select the dataset in several ways</span>
    dataset = project.datasets.find {|d| d.title == <span class="string"><span class="delimiter">'</span><span class="content">Users</span><span class="delimiter">'</span></span>}
    dataset = project.datasets(<span class="string"><span class="delimiter">'</span><span class="content">dataset.users</span><span class="delimiter">'</span></span>)
    dataset = project.datasets(<span class="integer">345</span>)
    <span class="comment"># dataset.synchronize works as well</span>
    dataset.delete_data

  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exploring_unknown_project">Exploring Unknown Project</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_32">Problem</h4>
<div class="paragraph">
<p>You just got invited to this project and just can&#8217;t reach the project&#8217;s author. Can&#8217;t find any project&#8217;s documentation. The following code snippet may be helpful in such situation</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_32">Solution</h4>
<div class="paragraph">
<p>You want to start with a quick introspection. How many datasets, how much data is there how many processes etc. Doing this manually is fairly time consuming. You have to find the primary attributes of each dataset create a count metric and a lot of other stuff. This can be automated and it is so useful we actually created a command that does just this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_pid</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    project.info
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This might be the hypothetical output. For each dataset you have there the size. Below is a breakdown of how many different types of objects there are inside the dataset.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="text">GOODSALES
===============

Datasets - 28

stage_history
=============
Size - 29103.0 rows
1 attributes, 4 facts, 8 references

opp_snapshot
============
Size - 2130074.0 rows
1 attributes, 9 facts, 21 references

.
.
.
.

Opp_changes
===========
Size - 472.0 rows
2 attributes, 6 facts, 10 references

Opportunity Benchmark
=====================
Size - 487117.0 rows
3 attributes, 2 facts, 2 references</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_substitute_date_dimension_for_another_one">Substitute Date Dimension for Another One</h3>
<div class="paragraph">
<p>by Tomas Korcak</p>
</div>
<div class="sect3">
<h4 id="_problem_33">Problem</h4>
<div class="paragraph">
<p>You want to substitute an existing date dimension in your project for another date dimension. This is particularly handy when you are consolidating date dimensions (perhaps you want to have only one date dimension in your project) or replacing your standard date dimension with a fiscal date dimension.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_33">Solution</h4>
<div class="paragraph">
<p>The code snippet below substitutes all occurences of a date dimension objects (attributes and labels) for another date dimension&#8217;s objects (that must obviously exist in the project). The substitution is performed in following objects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Metrics</p>
</li>
<li>
<p>Report Definitions</p>
</li>
<li>
<p>Reports</p>
</li>
<li>
<p>Report Specific Metrics</p>
</li>
<li>
<p>Dashboards</p>
</li>
<li>
<p>Mandatory User Filters aka Data Permissions</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_pid</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|

    opts = {
      <span class="comment"># You can specify name of new and old date dimension...</span>
      <span class="comment"># :old =&gt; 'Close',</span>
      <span class="comment"># :new =&gt; 'Completed',</span>

      <span class="comment"># Or explicitly specify mapping using identifiers...</span>
      <span class="symbol">:mapping</span> =&gt; {
        <span class="string"><span class="delimiter">'</span><span class="content">closedate.date</span><span class="delimiter">'</span></span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">abortdate.date</span><span class="delimiter">'</span></span>,
        <span class="string"><span class="delimiter">'</span><span class="content">closedate.day.in.euweek</span><span class="delimiter">'</span></span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">abortdate.day.in.euweek</span><span class="delimiter">'</span></span>,
        <span class="string"><span class="delimiter">'</span><span class="content">closedate.month</span><span class="delimiter">'</span></span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">abortdate.month</span><span class="delimiter">'</span></span>,
        <span class="string"><span class="delimiter">'</span><span class="content">closedate.month.in.year</span><span class="delimiter">'</span></span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">abortdate.month.in.year</span><span class="delimiter">'</span></span>,
        <span class="string"><span class="delimiter">'</span><span class="content">closedate.euweek.in.year</span><span class="delimiter">'</span></span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">abortdate.week.in.year</span><span class="delimiter">'</span></span>,
        <span class="string"><span class="delimiter">'</span><span class="content">closedate.euweek</span><span class="delimiter">'</span></span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">abortdate.week</span><span class="delimiter">'</span></span>,
        <span class="string"><span class="delimiter">'</span><span class="content">closedate.quarter</span><span class="delimiter">'</span></span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">abortdate.quarter</span><span class="delimiter">'</span></span>,
        <span class="string"><span class="delimiter">'</span><span class="content">closedate.day.in.month</span><span class="delimiter">'</span></span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">abortdate.day.in.month</span><span class="delimiter">'</span></span>,
        <span class="string"><span class="delimiter">'</span><span class="content">closedate.week.in.quarter</span><span class="delimiter">'</span></span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">abortdate.week.in.quarter</span><span class="delimiter">'</span></span>,
        <span class="string"><span class="delimiter">'</span><span class="content">closedate.quarter.in.year</span><span class="delimiter">'</span></span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">abortdate.quarter.in.year</span><span class="delimiter">'</span></span>,
        <span class="string"><span class="delimiter">'</span><span class="content">closedate.week</span><span class="delimiter">'</span></span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">abortdate.week</span><span class="delimiter">'</span></span>,
        <span class="string"><span class="delimiter">'</span><span class="content">closedate.day.in.year</span><span class="delimiter">'</span></span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">abortdate.day.in.year</span><span class="delimiter">'</span></span>,
        <span class="string"><span class="delimiter">'</span><span class="content">closedate.day.in.week</span><span class="delimiter">'</span></span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">abortdate.day.in.week</span><span class="delimiter">'</span></span>,
        <span class="string"><span class="delimiter">'</span><span class="content">closedate.week.in.year</span><span class="delimiter">'</span></span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">abortdate.week.in.year</span><span class="delimiter">'</span></span>,
        <span class="string"><span class="delimiter">'</span><span class="content">closedate.euweek.in.quarter</span><span class="delimiter">'</span></span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">abortdate.week.in.quarter</span><span class="delimiter">'</span></span>,
        <span class="string"><span class="delimiter">'</span><span class="content">closedate.day.in.quarter</span><span class="delimiter">'</span></span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">abortdate.day.in.quarter</span><span class="delimiter">'</span></span>,
        <span class="string"><span class="delimiter">'</span><span class="content">closedate.year</span><span class="delimiter">'</span></span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">closedate.year</span><span class="delimiter">'</span></span>,
        <span class="string"><span class="delimiter">'</span><span class="content">closedate.month.in.quarter</span><span class="delimiter">'</span></span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">abortdate.month.in.quarter</span><span class="delimiter">'</span></span>
      },

      <span class="symbol">:dry_run</span> = <span class="predefined-constant">false</span> <span class="comment"># Optional. Default 'false'</span>
    }

    project.replace_date_dimension(opts)
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_11">Discussion</h4>
<div class="paragraph">
<p>You need to specify complete mapping between the current and new date dimensions attributes. This is straightforward in case when both date dimensions have the same structure (see the commented out <em>:old</em> / <em>:new</em> syntax). Full mapping is necessary when the date dimensions have different structures. For example the <em>abortdate</em> date dimension in the code above doesn&#8217;t have any <em>EU week</em> attributes. The existing <em>closedate</em>'s <em>EU week</em> attributes are mapped to standard week attributes of the <em>abortdate</em> dimension.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_05_testing">05 Testing</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_testing_report_result">Testing Report Result</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_34">Problem</h4>
<div class="paragraph">
<p>You want to be sure that reports return expected results. This is a basis for delving later into test driven BI projects.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_34">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_pid</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    report = project.reports(<span class="integer">32</span>)
    result = report.execute
    fail <span class="string"><span class="delimiter">&quot;</span><span class="content">Report has unexpected result</span><span class="delimiter">&quot;</span></span> <span class="keyword">unless</span> result == [[<span class="integer">1</span>, <span class="integer">2</span>, <span class="integer">3</span>]]
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_06_working_with_projects">06 Working With Projects</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_creating_empty_project">Creating Empty Project</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_35">Problem</h4>
<div class="paragraph">
<p>You need to create a project programmatically.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_35">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

client = <span class="constant">GoodData</span>.connect
project = client.create_project(<span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">My project title</span><span class="delimiter">'</span></span>, <span class="key">auth_token</span>: <span class="string"><span class="delimiter">'</span><span class="content">PROJECT_CREATION_TOKEN</span><span class="delimiter">'</span></span>)

<span class="comment"># after some time the project is created and you can start working with it</span>
puts project.uri
puts project.title <span class="comment"># =&gt; 'My project title'</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_renaming_project">Renaming Project</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_36">Problem</h4>
<div class="paragraph">
<p>You need to rename the project.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_36">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

client = <span class="constant">GoodData</span>.connect
project = client.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)
project.title = <span class="string"><span class="delimiter">&quot;</span><span class="content">New and much better title</span><span class="delimiter">&quot;</span></span>
project.save</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cloning_project">Cloning Project</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_37">Problem</h4>
<div class="paragraph">
<p>You would like to create an exact copy of a project</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_37">Solution</h4>
<div class="paragraph">
<p>You can use cloning capabilities.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

client = <span class="constant">GoodData</span>.connect
project = client.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_pid</span><span class="delimiter">'</span></span>)
cloned_project = project.clone(<span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">New title</span><span class="delimiter">'</span></span>,
                               <span class="key">auth_token</span>: <span class="string"><span class="delimiter">'</span><span class="content">token</span><span class="delimiter">'</span></span>,
                               <span class="key">users</span>: <span class="predefined-constant">false</span>,
                               <span class="key">data</span>: <span class="predefined-constant">true</span>)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_12">Discussion</h4>
<div class="paragraph">
<p>There are two options that you can specify. You can pick if you want to clone just metadata (e.g. attributes, facts, metrics reports, dashboards etc.) or also data (this is default). Also you can choose if you want to transfer all old project&#8217;s users to the new project. No users are transferred by default. In the example above we explicitly specified the <em>users</em> and <em>data</em> optional parameters so you can see how it works.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cloning_project_accross_organizations">Cloning Project accross Organizations</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_38">Problem</h4>
<div class="paragraph">
<p>You would like to clone project to a different organization</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_38">Solution</h4>
<div class="paragraph">
<p>Usually you would be happy using <code>project.clone</code> but sometimes you need more granularity in controlling who is doing what. In this recipe we are going to explain what is happening when you clone a project and how you can leverage the lower level API.</p>
</div>
<div class="paragraph">
<p>When the project clone is done SDK actually orchestrates couple of calls together</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Exports a project, obtaining an export package token. The token is a pointer to a package that is stored at GoodData premises.</p>
</li>
<li>
<p>Creates an empty project</p>
</li>
<li>
<p>Imports the package (from step 1) into a freshly created project from step 2</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>All these 3 calls are asynchronous by default. SDK makes sure that things happen in the correct order and exposes it as synchronous operation.</p>
</div>
<div class="paragraph">
<p>Sometimes more granular things are need for example when you need to clone a project to different organization. This means that clone would not work since you cannot have one user in 2 organizations. We decided to expose the methods to allow you doing the three steps above so anyone can mix and match.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

user_from_login = <span class="string"><span class="delimiter">'</span><span class="content">john@example.com</span><span class="delimiter">'</span></span>
user_to_login = <span class="string"><span class="delimiter">'</span><span class="content">jane@example.com</span><span class="delimiter">'</span></span>

client_from = <span class="constant">GoodData</span>.connect(user_from_login, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>, <span class="key">server</span>: <span class="string"><span class="delimiter">'</span><span class="content">https://customer_1_domain.gooddata.com</span><span class="delimiter">'</span></span>)
client_to = <span class="constant">GoodData</span>.connect(user_to_login, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>, <span class="key">server</span>: <span class="string"><span class="delimiter">'</span><span class="content">https://customer_2_domain.gooddata.com</span><span class="delimiter">'</span></span>)

from_project = client_from.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_pid_1</span><span class="delimiter">'</span></span>)
to_project = client_to.create_project(<span class="symbol">:title</span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">project_title</span><span class="delimiter">&quot;</span></span>, <span class="symbol">:auth_token</span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">TOKEN</span><span class="delimiter">&quot;</span></span>)

export_token = from_project.export_clone(<span class="key">authorized_users</span>: [user_to_login], <span class="key">data</span>: <span class="predefined-constant">true</span>, <span class="key">users</span>: <span class="predefined-constant">false</span>)
to_project.import_clone(export_token)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_13">Discussion</h4>
<div class="paragraph">
<p>You can also leverage this more granular interface when you need to clone one project to multiple target projects.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_empty_project_using_specific_environment">Creating Empty Project using specific environment.</h3>
<div class="paragraph">
<p>by Tomas Korcak</p>
</div>
<div class="sect3">
<h4 id="_problem_39">Problem</h4>
<div class="paragraph">
<p>You want to create a project programmatically using specific environment. The TESTING projects are not backed up and may be discarded during a platform maintenance.</p>
</div>
<div class="ulist">
<div class="title">Environments</div>
<ul>
<li>
<p>PRODUCTION <em>(DEFAULT)</em></p>
</li>
<li>
<p>DEVELOPMENT</p>
</li>
<li>
<p>TESTING</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that the environment names are case sensitive.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_39">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

client = <span class="constant">GoodData</span>.connect
project = client.create_project(<span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">My project title</span><span class="delimiter">'</span></span>, <span class="key">auth_token</span>: <span class="string"><span class="delimiter">'</span><span class="content">PROJECT_CREATION_TOKEN</span><span class="delimiter">'</span></span>, <span class="symbol">:environment</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">TESTING</span><span class="delimiter">'</span></span>)

<span class="comment"># after some time the project is created and you can start working with it</span>
puts project.uri
puts project.environment <span class="comment"># =&gt; 'TESTING'</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_project_from_template">Creating Project from Template</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_40">Problem</h4>
<div class="paragraph">
<p>You have a template created for you and you would like to spin a project from this template.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_40">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

client = <span class="constant">GoodData</span>.connect
project = client.create_project(<span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">New project</span><span class="delimiter">'</span></span>,
                                <span class="key">template</span>: <span class="string"><span class="delimiter">'</span><span class="content">/projectTemplates/SuperSoda/1/</span><span class="delimiter">'</span></span>,
                                <span class="key">auth_token</span>: <span class="string"><span class="delimiter">'</span><span class="content">token</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_14">Discussion</h4>
<div class="paragraph">
<p>Note that people behind SDK do not endorse usage of templates so consider it being here for legacy purposes.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_migrating_objects_between_projects">Migrating objects between projects</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_41">Problem</h4>
<div class="paragraph">
<p>You have metadata objects (reports/metrics/dashboards) you would like to transfer between projects</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_41">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: UTF-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  target_project = c.projects(<span class="string"><span class="delimiter">'</span><span class="content">target_project_id</span><span class="delimiter">'</span></span>)

  <span class="comment"># Lets log into project you would like to transfer from</span>
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">master_project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |master_project|
    <span class="comment"># find objects you would like to transfer</span>
    <span class="comment"># here we transfer all reports containing word &quot;sales&quot; in the title</span>
    reports = master_project.reports.select { |r| r.title =~ <span class="regexp"><span class="delimiter">/</span><span class="content">title</span><span class="delimiter">/</span></span> }
    <span class="keyword">begin</span>
      master_project.transfer_objects(reports, <span class="key">project</span>: target_project)
    <span class="keyword">rescue</span> <span class="constant">ObjectsMigrationError</span>
      puts <span class="string"><span class="delimiter">'</span><span class="content">Object transfer failed</span><span class="delimiter">'</span></span>
    <span class="keyword">end</span>
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_15">Discussion</h4>
<div class="paragraph">
<p>Occassionally you need to transfer objects to multiple projects. To make it easier SDK provides a convenience method for this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: UTF-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  target_project_1 = c.projects(<span class="string"><span class="delimiter">'</span><span class="content">target_project_id_1</span><span class="delimiter">'</span></span>)
  target_project_2 = c.projects(<span class="string"><span class="delimiter">'</span><span class="content">target_project_id_2</span><span class="delimiter">'</span></span>)

  <span class="comment"># Lets log into project you would like to transfer from</span>
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">master_project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |master_project|
    <span class="comment"># find objects you would like to transfer</span>
    <span class="comment"># here we transfer all reports containing word &quot;sales&quot; in the title</span>
    reports = master_project.reports.select { |r| r.title =~ <span class="regexp"><span class="delimiter">/</span><span class="content">title</span><span class="delimiter">/</span></span> }
    result = master_project.transfer_objects(reports, <span class="key">project</span>: [target_project_1, target_project_2])

    <span class="comment"># If you provided an array of projects the method will not throw an exception on failed</span>
    <span class="comment"># imports. It returns an array of results an you have to investigate to know what is up.</span>
    <span class="comment"># The shape of results is in shape</span>
    <span class="comment"># {</span>
    <span class="comment">#   project: target_project,</span>
    <span class="comment">#   result: true</span>
    <span class="comment"># }</span>
    puts <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span>result.select {|r| r[<span class="symbol">:result</span>] }.count<span class="inline-delimiter">}</span></span><span class="content"> projects succeeded</span><span class="delimiter">&quot;</span></span>
    puts <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span>result.reject {|r| r[<span class="symbol">:result</span>] }.count<span class="inline-delimiter">}</span></span><span class="content"> projects failed</span><span class="delimiter">&quot;</span></span>
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Objects import happen in two stages. First you export objects with an API call. This creates a package on our platform and provides you with a token. You can then use the token to initiate the import. In most cases you do not care about these details and 2 methods above are all what you need. In some cases though you want the low level control. Here is a quick example how to use those lower level methods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: UTF-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  target_project = c.projects(<span class="string"><span class="delimiter">'</span><span class="content">target_project_id</span><span class="delimiter">'</span></span>)

  <span class="comment"># Lets log into project you would like to transfer from</span>
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">master_project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |master_project|
    <span class="comment"># find objects you would like to transfer</span>
    <span class="comment"># here we transfer all reports containing word &quot;sales&quot; in the title</span>
    reports = master_project.reports.select { |r| r.title =~ <span class="regexp"><span class="delimiter">/</span><span class="content">title</span><span class="delimiter">/</span></span> }
    <span class="keyword">begin</span>
      token = master_project.objects_export(reports)
    <span class="keyword">rescue</span> <span class="constant">ObjectsExportError</span>
      puts <span class="string"><span class="delimiter">&quot;</span><span class="content">Export failed</span><span class="delimiter">&quot;</span></span>
    <span class="keyword">end</span>
    <span class="keyword">begin</span>
      target_project.objects_import(token)
    <span class="keyword">rescue</span> <span class="constant">ObjectsImportError</span>
      puts <span class="string"><span class="delimiter">&quot;</span><span class="content">Import failed</span><span class="delimiter">&quot;</span></span>
    <span class="keyword">end</span>
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_07_deployment_recipes">07 Deployment Recipes</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_deploying_process">Deploying Process</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_42">Problem</h4>
<div class="paragraph">
<p>You would like to deploy a CloudConnect or Ruby SDK process to GoodData platform.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_42">Solution</h4>
<div class="paragraph">
<p>SDK allows you to deploy a process. Just point it to a directory or a zipped archive that you want to deploy. Below is an example of CloudConnect process deployment. When deploying CloudConnect processes you typically want to take the whole folder structure of a CloudConnect project and deploy it. So you will want to pass either path to the root folder of the structure or you can zip it first and pass just a path to the zip archive. The below example points to the root folder of a CloudConnect project.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    project.deploy_process(<span class="string"><span class="delimiter">'</span><span class="content">./path/to_cloud_connect_directory</span><span class="delimiter">'</span></span>,
      <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">Test ETL Process</span><span class="delimiter">'</span></span>)
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_redeploying_existing_process">Redeploying Existing Process</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_43">Problem</h4>
<div class="paragraph">
<p>You would like to redeploy a CloudConnect or Ruby process to GoodData platform.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_43">Solution</h4>
<div class="paragraph">
<p>SDK provides means for redeploying a process (with a new updated content). All you have to do is to get a handle on the process. Here we are using a process id to identify the process that we want to redeploy. You can use any other way to identify the process to redeploy. Take note that the same deployment rules as in <code>project.deploy_process</code> apply.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    process = project.processes(<span class="string"><span class="delimiter">'</span><span class="content">process_id</span><span class="delimiter">'</span></span>)
    process.deploy(<span class="string"><span class="delimiter">'</span><span class="content">./path/to_cloud_connect_directory</span><span class="delimiter">'</span></span>)
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_scheduling_process">Scheduling Process</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_44">Problem</h4>
<div class="paragraph">
<p>You have a process deployed and you would like to add a schedule to it so the process is executed regularly</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_44">Solution</h4>
<div class="paragraph">
<p>You can easily add a time based schedule to any process. Scheduled process execution has couple advantages over the ad-hoc process executions. Scheduled executions are logged and logs are kept around for some time (~10 days). Also schedule keeps list of parameters so you create it once and you do not need to care about them anymore.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    process = project.deploy_process(<span class="string"><span class="delimiter">'</span><span class="content">./path/to_cloud_connect_directory</span><span class="delimiter">'</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">Test ETL Process</span><span class="delimiter">'</span></span>)
    process.create_schedule(<span class="string"><span class="delimiter">'</span><span class="content">0 15 * * *</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">graph/my_graph.grf</span><span class="delimiter">'</span></span>, <span class="key">params</span>: { <span class="key">param1</span>: <span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span>, <span class="key">param2</span>: <span class="string"><span class="delimiter">'</span><span class="content">b</span><span class="delimiter">'</span></span> })
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_disabling_schedules_in_all_projects">Disabling Schedules in All Projects</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_45">Problem</h4>
<div class="paragraph">
<p>You would like to disable all schedules on all processes on all the projects you have access to and have sufficient privileges to do so.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_45">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

client = <span class="constant">GoodData</span>.connect
<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  schedules = client.projects.pselect(&amp;<span class="symbol">:am_i_admin?</span>).pmapcat(&amp;<span class="symbol">:schedules</span>)
  schedules.pmap <span class="keyword">do</span> |schedule|
    schedule.disable
    schedule.save
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_executing_schedule">Executing Schedule</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_46">Problem</h4>
<div class="paragraph">
<p>You have a process with a schedule. You would like to execute it out of schedule.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_46">Solution</h4>
<div class="paragraph">
<p>Since schedule already have information about executable and parameters stored it is very easy. You just need to find the schedule and execute it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  project = <span class="constant">GoodData</span>.use(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)
  project.processes.first.schedules.first.execute
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_executing_process">Executing Process</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_47">Problem</h4>
<div class="paragraph">
<p>You would like to execute a process without a schedule.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_47">Solution</h4>
<div class="paragraph">
<p>SDK allows you to execute a process. This is not something that you should do regularly since you have to specify the parameters during execution and logs are not kept for individual executions but it might be occasionally useful.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    process = project.deploy_process(<span class="string"><span class="delimiter">'</span><span class="content">./path/to_cloud_connect_directory</span><span class="delimiter">'</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">Test ETL Process</span><span class="delimiter">'</span></span>)
    process.execute(<span class="string"><span class="delimiter">'</span><span class="content">graph/my_graph.grf</span><span class="delimiter">'</span></span>, <span class="key">params</span>: { <span class="key">param1</span>: <span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span>, <span class="key">param2</span>: <span class="string"><span class="delimiter">'</span><span class="content">b</span><span class="delimiter">'</span></span> })
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_16">Discussion</h4>
<div class="paragraph">
<p>There are also couple of other useful tricks. You might execute arbitrary process that is already deployed. You just need to get the process by its id.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    process = project.processes(<span class="string"><span class="delimiter">'</span><span class="content">6a75759f-2a76-49c8-af18-ad3bc58fc65e</span><span class="delimiter">'</span></span>)
    process.execute(<span class="string"><span class="delimiter">'</span><span class="content">graph/my_graph.grf</span><span class="delimiter">'</span></span>, <span class="key">params</span>: { <span class="key">param1</span>: <span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span>, <span class="key">param2</span>: <span class="string"><span class="delimiter">'</span><span class="content">b</span><span class="delimiter">'</span></span> })
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Or you can get a process by it&#8217;s name too.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    project = <span class="constant">GoodData</span>.use(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)
    process = project.processes.find { |p| p.name == <span class="string"><span class="delimiter">'</span><span class="content">Test ETL Process</span><span class="delimiter">'</span></span> }
    process.execute(<span class="string"><span class="delimiter">'</span><span class="content">graph/my_graph.grf</span><span class="delimiter">'</span></span>, <span class="key">params</span>: { <span class="key">param1</span>: <span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span>, <span class="key">param2</span>: <span class="string"><span class="delimiter">'</span><span class="content">b</span><span class="delimiter">'</span></span> })
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you do not know what the executable is you can look it up by using <code>process.executables</code>. We recommend using the same for all processes like <code>main.grf</code> (for CloudConnect) or <code>main.rb</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_run_after_scheduling">Run-After Scheduling</h3>
<div class="paragraph">
<p>by Zdenek Svoboda</p>
</div>
<div class="sect3">
<h4 id="_problem_48">Problem</h4>
<div class="paragraph">
<p>You want to schedule a process to run upon successful completion of another process (schedule). This is also known as run-after triggered schedule.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_48">Solution</h4>
<div class="paragraph">
<p>If you use an existing schedule object instead of a cron expression in the create_schedule method, the scheduled process will be scheduled to execute upon successful completion of the passed schedule.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    process = project.deploy_process(<span class="string"><span class="delimiter">'</span><span class="content">./path/to_parent_cloud_connect_directory</span><span class="delimiter">'</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">Parent Process</span><span class="delimiter">'</span></span>)
    parent_schedule = process.create_schedule(<span class="string"><span class="delimiter">'</span><span class="content">0 15 * * *</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">graph/parent_graph.grf</span><span class="delimiter">'</span></span>, <span class="key">params</span>: { <span class="key">param1</span>: <span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span>, <span class="key">param2</span>: <span class="string"><span class="delimiter">'</span><span class="content">b</span><span class="delimiter">'</span></span> })
        <span class="comment"># The after_process will run after the parent_schedule successfully finishes</span>
    process = project.deploy_process(<span class="string"><span class="delimiter">'</span><span class="content">./path/to_after_cloud_connect_directory</span><span class="delimiter">'</span></span>, <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">After Process</span><span class="delimiter">'</span></span>)
        <span class="comment"># Note passing the parent_schedule instead of a cron expression</span>
    process.create_schedule(parent_schedule, <span class="string"><span class="delimiter">'</span><span class="content">graph/after_graph.grf</span><span class="delimiter">'</span></span>, <span class="key">params</span>: { <span class="key">param1</span>: <span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span>, <span class="key">param2</span>: <span class="string"><span class="delimiter">'</span><span class="content">b</span><span class="delimiter">'</span></span> })
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_changing_an_existing_schedule">Changing an existing schedule</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_49">Problem</h4>
<div class="paragraph">
<p>You have a schedule but would like to change it</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_49">Solution</h4>
<div class="paragraph">
<p>You can retrieve a schedule in the same way as any other object, use it&#8217;s methods to change it and save it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

schedule_id = <span class="string"><span class="delimiter">'</span><span class="content">fill_in</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  project = client.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)
  schedule = project.schedules(schedule_id)
  <span class="comment"># you can change pretty much anything</span>

  <span class="comment"># executable</span>
  schedule.executable = <span class="string"><span class="delimiter">'</span><span class="content">graph/new_graph.grf</span><span class="delimiter">'</span></span>

  <span class="comment"># params</span>
  schedule.params
  <span class="comment"># {</span>
  <span class="comment">#   &quot;PROCESS_ID&quot;=&gt;&quot;c42c1b82-7d6f-433a-b008-9cdb1d454e01&quot;,</span>
  <span class="comment">#   &quot;EXECUTABLE&quot;=&gt;&quot;new_main.rb&quot;,</span>
  <span class="comment">#   :a=&gt;:b</span>
  <span class="comment"># }</span>
  schedule.set_param(<span class="symbol">:a</span>, <span class="symbol">:c</span>)
  schedule.params
  <span class="comment"># {</span>
  <span class="comment">#   &quot;PROCESS_ID&quot;=&gt;&quot;c42c1b82-7d6f-433a-b008-9cdb1d454e01&quot;,</span>
  <span class="comment">#   &quot;EXECUTABLE&quot;=&gt;&quot;new_main.rb&quot;,</span>
  <span class="comment">#   :a=&gt;:c</span>
  <span class="comment"># }</span>
  schedule.update_params({
    <span class="symbol">:a</span> =&gt; <span class="integer">42</span>,
    <span class="symbol">:b</span> =&gt; [<span class="integer">1</span>,<span class="integer">2</span>,<span class="integer">3</span>]
  })
  schedule.params
  <span class="comment"># {</span>
  <span class="comment">#   &quot;PROCESS_ID&quot;=&gt;&quot;c42c1b82-7d6f-433a-b008-9cdb1d454e01&quot;,</span>
  <span class="comment">#   &quot;EXECUTABLE&quot;=&gt;&quot;new_main.rb&quot;,</span>
  <span class="comment">#   :a =&gt; 42,</span>
  <span class="comment">#   :b=&gt;[1, 2, 3]</span>
  <span class="comment"># }</span>

  <span class="comment"># reschedule</span>
  schedule.reschedule <span class="comment"># =&gt; 0</span>
  schedule.reschedule = <span class="integer">15</span>

  <span class="comment"># name</span>
  schedule.name <span class="comment"># =&gt; &quot;Some Name&quot;</span>
  schedule.name = <span class="string"><span class="delimiter">&quot;</span><span class="content">Better Name</span><span class="delimiter">&quot;</span></span>

  <span class="comment"># enable/disable</span>
  schedule.state <span class="comment"># =&gt; &quot;ENABLED&quot;</span>
  schedule.disable
  schedule.state <span class="comment"># =&gt; &quot;DISABLED&quot;</span>
  schedule.enable
  schedule.state <span class="comment"># =&gt; &quot;ENABLED&quot;</span>

  <span class="comment"># cron expression</span>
  schedule.cron <span class="comment"># =&gt; &quot;1 1 1 * *&quot;</span>
  schedule.cron = <span class="string"><span class="delimiter">&quot;</span><span class="content">1 1 1 1 *</span><span class="delimiter">&quot;</span></span>

  <span class="comment"># &quot;run after&quot; schedule</span>
  after_schedule = project.schedules(<span class="string"><span class="delimiter">'</span><span class="content">some_id</span><span class="delimiter">'</span></span>)
  schedule.after = after_schedule

  <span class="comment"># Do not foreget to save it</span>
  schedule.save
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_investigating_executions">Investigating Executions</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_50">Problem</h4>
<div class="paragraph">
<p>You have large amount of projects and would like to investigate their execution. The administration UI is not necessarilly helpful since its overview UI can hide some failures, there is too much too go through by hand etc.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_50">Solution</h4>
<div class="paragraph">
<p>Let&#8217;s have a look at couple of scenarios. First let&#8217;s investigate executions inside one project regardless of which schedule it was triggered by. Let&#8217;s assume first that we are just looking for any executions that failed for that particular project. We will print the date when it happend sorted in a ascending fashion.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    results = project.schedules
                     .pmapcat { |s| s.executions.to_a }  <span class="comment"># take all their executions (execute in parallel since this goes to API)</span>
                     .select(&amp;<span class="symbol">:error?</span>) <span class="comment"># select only those that failed</span>
    pp results.map(&amp;<span class="symbol">:started</span>).sort.uniq
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now imagine that you are looking for executions executed by a particular schedule.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    results = project.schedules
                     .select { |s| s.name == <span class="string"><span class="delimiter">'</span><span class="content">user_filters_schedule</span><span class="delimiter">'</span></span> } <span class="comment"># filter on those that have particular name</span>
                     .pmapcat { |s| s.executions.to_a } <span class="comment"># take all their executions (execute in parallel since this goes to API)</span>
                     .select(&amp;<span class="symbol">:error?</span>) <span class="comment"># select only those that failed</span>
    pp results.map(&amp;<span class="symbol">:started</span>).sort.uniq
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Lets' make it even more specific and let&#8217;s look for a specific term in the error message. Let&#8217;s say that "unsynchronized" is the word we are looking for.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    results = project.schedules
                     .select { |s| s.name == <span class="string"><span class="delimiter">'</span><span class="content">user_filters_schedule</span><span class="delimiter">'</span></span> } <span class="comment"># filter on those that have particular name</span>
                     .pmapcat { |s| s.executions.to_a } <span class="comment"># take all their executions (execute in parallel since this goes to API)</span>
                     .select(&amp;<span class="symbol">:error?</span>) <span class="comment"># select only those that failed</span>
                     .select { |e| e.json[<span class="string"><span class="delimiter">'</span><span class="content">execution</span><span class="delimiter">'</span></span>][<span class="string"><span class="delimiter">'</span><span class="content">error</span><span class="delimiter">'</span></span>][<span class="string"><span class="delimiter">'</span><span class="content">message</span><span class="delimiter">'</span></span>] =~ <span class="regexp"><span class="delimiter">/</span><span class="content">unsynchronized</span><span class="delimiter">/</span></span> } <span class="comment"># select those that contain particular message in error message</span>
    pp results.map(&amp;<span class="symbol">:started</span>).sort.uniq
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Sometimes the error does not manfiest itself in the error message directly and you need to look into logs. Take note that in both last cases we are getting the log and the error message as a string so you have full power of ruby to process it. Here we are using regular expressions which by itself gives you siginificant power but you can go even deeper if you need.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    results = project.schedules
                     .select { |s| s.name == <span class="string"><span class="delimiter">'</span><span class="content">user_filters_schedule</span><span class="delimiter">'</span></span> } <span class="comment"># filter on those that have particular name</span>
                     .pmapcat { |s| s.executions.to_a } <span class="comment"># take all their executions (execute in parallel since this goes to API)</span>
                     .select(&amp;<span class="symbol">:error?</span>) <span class="comment"># select only those that failed</span>
                     .select { |e| e.log =~ <span class="regexp"><span class="delimiter">/</span><span class="content">unsynchronized</span><span class="delimiter">/</span></span> } <span class="comment"># select those that contain particular message in log</span>
    pp results.map(&amp;<span class="symbol">:started</span>).sort.uniq
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Last example we will show is just a small extension. Imagine you would like to perform the same analysis on all projects in your account. This is usually the case since this type of analysing executions get exponentially more useful with growing number of executions or projects you need to investigate.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
    results = client.projects <span class="comment"># take all projects</span>
                    .pmapcat(&amp;<span class="symbol">:schedules</span>) <span class="comment"># take all their schedules (execute in parallel since this goes to API)</span>
                    .select { |s| s.name == <span class="string"><span class="delimiter">'</span><span class="content">user_filters_schedule</span><span class="delimiter">'</span></span> } <span class="comment"># filter on those that have particular name</span>
                    .pmapcat { |s| s.executions.to_a } <span class="comment"># take all their executions (execute in parallel since this goes to API)</span>
                    .select(&amp;<span class="symbol">:error?</span>) <span class="comment"># select only those that failed</span>
                    .select { |e| e.log =~ <span class="regexp"><span class="delimiter">/</span><span class="content">unsynchronized</span><span class="delimiter">/</span></span> } <span class="comment"># select those that contain particular message in log</span>
    pp results.map(&amp;<span class="symbol">:started</span>).sort.uniq
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_visualizing_executions">Visualizing executions</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_51">Problem</h4>
<div class="paragraph">
<p>You successfully mudularized your ETL into several modules you orchestrated. The problem is that it is hard to visualize the order of execution from the Data Administration console.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_51">Solution</h4>
<div class="paragraph">
<p>There are plethora of very useful libraries that you can use in conjunction with GoodData SDK. One of those is Graphviz that is a C library but it has bindings to almost every language including Ruby. Graphviz is a visualization library and one of the features is visualizing Direct Acycclic Graphs which is exactly what an execution of several schedules bascially is.</p>
</div>
<div class="paragraph">
<p>As a prerequisite you have to install both <a href="http://www.graphviz.org/">Graphviz</a> and <a href="https://github.com/glejeune/Ruby-Graphviz">Graphviz ruby bindings</a>. I leave this as a exercise for the reader because this might be a little bit difficult and unfortuntely is different for every platform. If you encounter any errors try googling them or shoot us a message on github or support</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>
require <span class="string"><span class="delimiter">'</span><span class="content">graphviz</span><span class="delimiter">'</span></span>

<span class="constant">PROJECT_ID</span> = <span class="string"><span class="delimiter">'</span><span class="content">PROJECT_ID</span><span class="delimiter">'</span></span> <span class="comment"># fill_in</span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  <span class="constant">GoodData</span>.with_project(<span class="constant">PROJECT_ID</span>) <span class="keyword">do</span> |project|
    schedules = project.schedules

    nodes = project.processes.pmapcat { |p| p.schedules.map { |s| [s, <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span>p.name<span class="inline-delimiter">}</span></span><span class="content">-</span><span class="inline"><span class="inline-delimiter">#{</span>s.name<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>] } }
    edges = schedules.reject(&amp;<span class="symbol">:time_based?</span>).pmap {|s| [<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span>s.after.process.name<span class="inline-delimiter">}</span></span><span class="content">-</span><span class="inline"><span class="inline-delimiter">#{</span>s.after.name<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span>s.process.name<span class="inline-delimiter">}</span></span><span class="content">-</span><span class="inline"><span class="inline-delimiter">#{</span>s.name<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>]}


    g = <span class="constant">GraphViz</span>.new(<span class="symbol">:G</span>, <span class="symbol">:type</span> =&gt; <span class="symbol">:digraph</span> , <span class="symbol">:rankdir</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">TB</span><span class="delimiter">'</span></span>)
    nodes.each { |s, n|
      node = g.add_nodes(n)
      node[<span class="symbol">:shape</span>] = <span class="string"><span class="delimiter">'</span><span class="content">box</span><span class="delimiter">'</span></span>
      node[<span class="symbol">:label</span>] = n + <span class="string"><span class="delimiter">&quot;</span><span class="char">\n</span><span class="inline"><span class="inline-delimiter">#{</span>s.cron<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
    }

    edges.each { |a, b| g.add_edges(a, b) }
    g.output(<span class="symbol">:png</span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">run_dag.png</span><span class="delimiter">&quot;</span></span>)

    <span class="comment"># Now you can open it for example on mac by running this on terminal</span>
    <span class="comment"># open -a Preview run_dag.png</span>
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_08_working_with_reports">08 Working With Reports</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_computing_report">Computing Report</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_52">Problem</h4>
<div class="paragraph">
<p>You have an existing report and you would like to execute it programatically.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_52">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    puts project.reports(<span class="integer">1234</span>).execute
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_comparing_reports_across_projects">Comparing Reports across Projects</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_53">Problem</h4>
<div class="paragraph">
<p>You created a new version of a project. You made some changes to the reports and you would like to verify that the report is still computing the same numbers.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_53">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  original_project = c.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_id_1</span><span class="delimiter">'</span></span>)
  new_project = c.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_id_2</span><span class="delimiter">'</span></span>)

  orig_report = <span class="constant">GoodData</span>::<span class="constant">Report</span>.find_first_by_title(<span class="string"><span class="delimiter">'</span><span class="content">Sum of Revenue</span><span class="delimiter">'</span></span>, <span class="key">client</span>: c, <span class="key">project</span>: original_project)
  new_report = <span class="constant">GoodData</span>::<span class="constant">Report</span>.find_first_by_title(<span class="string"><span class="delimiter">'</span><span class="content">Sum of Revenue</span><span class="delimiter">'</span></span>, <span class="key">client</span>: c, <span class="key">project</span>: new_project)

  orig_result = orig_report.execute
  new_result = new_report.execute

  puts orig_result == new_result
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_17">Discussion</h4>
<div class="paragraph">
<p>If there is more reports this can obviously take a lot of time so it would be nice if you could do computation or reports in parallel and not sequentially. Imagine we have a list of reports that should be checked tagged by tag <code>to_check</code>. Let&#8217;s rewrite previous code snippet to be parallel friendly.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  original_project = c.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_id_1</span><span class="delimiter">'</span></span>)
  new_project = c.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_id_2</span><span class="delimiter">'</span></span>)

  <span class="comment"># We assume that reports have unique name inside a project</span>
  orig_reports = <span class="constant">GoodData</span>::<span class="constant">Report</span>.find_by_tag(<span class="string"><span class="delimiter">'</span><span class="content">to_check</span><span class="delimiter">'</span></span>, <span class="key">client</span>: c, <span class="key">project</span>: original_project).sort_by(&amp;<span class="symbol">:title</span>)
  new_reports = <span class="constant">GoodData</span>::<span class="constant">Report</span>.find_by_tag(<span class="string"><span class="delimiter">'</span><span class="content">to_check</span><span class="delimiter">'</span></span>, <span class="key">client</span>: c, <span class="key">project</span>: new_project).sort_by(&amp;<span class="symbol">:title</span>)

  results = orig_reports.zip(new_reports).pmap <span class="keyword">do</span> |reports|
    <span class="comment"># compute both reports and add the report at the end for being able to print a report later</span>
    reports.map(&amp;<span class="symbol">:execute</span>) + [reports.last]
  <span class="keyword">end</span>

  results.map <span class="keyword">do</span> |res|
    orig_result, new_result, new_report = res
    puts <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span>new_report.title<span class="inline-delimiter">}</span></span><span class="content">, </span><span class="inline"><span class="inline-delimiter">#{</span>orig_result == new_result<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_updating_report_definition">Updating report definition</h3>
<div class="paragraph">
<p>by Tomas Korcak</p>
</div>
<div class="sect3">
<h4 id="_problem_54">Problem</h4>
<div class="paragraph">
<p>You have report and you want to update report definition in easy way. Perhaps you need to modify multiple reports in one or more projects.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_54">Solution</h4>
<div class="paragraph">
<p>Use the Report#update_definition with block argument in following way.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>
require <span class="string"><span class="delimiter">'</span><span class="content">pp</span><span class="delimiter">'</span></span>

<span class="constant">PID</span> = <span class="string"><span class="delimiter">'</span><span class="content">rq3enqarynvkt7q11u0stev65qdwpow8</span><span class="delimiter">'</span></span>
<span class="constant">REPORT</span> = <span class="string"><span class="delimiter">'</span><span class="content">/gdc/md/rq3enqarynvkt7q11u0stev65qdwpow8/obj/1323</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="constant">PID</span>) <span class="keyword">do</span> |project|
    report = project.reports(<span class="constant">REPORT</span>)

    new_def = report.update_definition <span class="keyword">do</span> |rdef|
      rdef.title = <span class="string"><span class="delimiter">&quot;</span><span class="content">Test TITLE: </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">DateTime</span>.now.strftime<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
    <span class="keyword">end</span>

    pp new_def
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_18">Discussion</h4>
<div class="paragraph">
<p>Specify :new_definition &#8658; false if you do want to update the latest report definition instead of creating new one. New definition flag is true by default.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>
require <span class="string"><span class="delimiter">'</span><span class="content">pp</span><span class="delimiter">'</span></span>

<span class="constant">PID</span> = <span class="string"><span class="delimiter">'</span><span class="content">rq3enqarynvkt7q11u0stev65qdwpow8</span><span class="delimiter">'</span></span>
<span class="constant">REPORT</span> = <span class="string"><span class="delimiter">'</span><span class="content">/gdc/md/rq3enqarynvkt7q11u0stev65qdwpow8/obj/1323</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="constant">PID</span>) <span class="keyword">do</span> |project|
    report = project.reports(<span class="constant">REPORT</span>)

    new_def = report.update_definition(<span class="symbol">:new_definition</span> =&gt; <span class="predefined-constant">false</span>) <span class="keyword">do</span> |rdef|
      rdef.title = <span class="string"><span class="delimiter">&quot;</span><span class="content">Test TITLE: </span><span class="inline"><span class="inline-delimiter">#{</span><span class="constant">DateTime</span>.now.strftime<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
    <span class="keyword">end</span>

    pp new_def
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_report_that_counts_records_in_all_datasets">Creating Report that Counts Records in All Datasets</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_55">Problem</h4>
<div class="paragraph">
<p>Occasionally you need to know how many rows there are in each dataset.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_55">Solution</h4>
<div class="paragraph">
<p>This is surprisingly difficult to do in GoodData UI but it is simple with SDK. Here we are going to create the necessary metrics on the fly through inspection of a blueprint. Then we will create a report that will contain those metrics and compute it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    blueprint = project.blueprint

    <span class="comment"># let's grab anchor on each dataset. Anchor is a special attribute on each dataset</span>
    <span class="comment"># this attribute defines the grain of the dataset if we &quot;count&quot; it we will get the number of lines</span>
    <span class="comment"># in the dataset</span>
    anchors = blueprint.datasets.map(&amp;<span class="symbol">:anchor</span>)

    <span class="comment"># As is explained in Blueprint section. Objects in blueprint are project agnostic.</span>
    <span class="comment"># Let's find corresponding attribute object in specific project</span>
    attributes = anchors.pmap { |anchor| anchor.in_project(project) }

    <span class="comment"># Lets create a report on the fly that is going to have the metrics in the rows</span>
    <span class="comment"># Take note that this is a real report on the platform that could be saved and alter reused</span>
    puts project.compute_report(<span class="key">left</span>: attributes.map(&amp;<span class="symbol">:create_metric</span>))

    <span class="comment"># This might result into something like this</span>
    <span class="comment">#</span>
    <span class="comment"># [                                                            |   Values   ]</span>
    <span class="comment"># [count of Records of timeline                                | 0.7306E4   ]</span>
    <span class="comment"># [count of Activity                                           | 0.61496E6  ]</span>
    <span class="comment"># [count of Opportunity                                        | 0.85171E6  ]</span>
    <span class="comment"># [count of Product                                            | 0.5E1      ]</span>
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_19">Discussion</h4>

</div>
</div>
<div class="sect2">
<h3 id="_reseting_report_color_map">Reseting Report Color Map</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_56">Problem</h4>
<div class="paragraph">
<p>You have a report somebody set up a colormapping with. You would like to remove it.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_56">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    ids = [report_id_1, report_id_2, report_id_3]
    ids.each <span class="keyword">do</span> |id|
      r = project.reports(id)
      d = r.latest_report_definition
      d.reset_color_mapping!
      d.save
    <span class="keyword">end</span>
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_computing_ad_hoc_report">Computing Ad Hoc Report</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_57">Problem</h4>
<div class="paragraph">
<p>You would like to make some ad hoc computation</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_57">Solution</h4>
<div class="paragraph">
<p>We are using the recipe <a href="#_working_with_hr_demo_project">Working with HR Demo project</a> here so spin it up if you want to follow the code.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|

    <span class="comment"># first let's create a metric and give it a reasonable identifier so we can read the examples</span>
    m = project.facts(<span class="string"><span class="delimiter">'</span><span class="content">fact.salary.amount</span><span class="delimiter">'</span></span>).create_metric
    m.identifier = <span class="string"><span class="delimiter">&quot;</span><span class="content">metrics.my_metric</span><span class="delimiter">&quot;</span></span>
    m.save

    <span class="comment"># metric can be referenced directly</span>
    project.compute_report(<span class="key">left</span>: [<span class="string"><span class="delimiter">'</span><span class="content">metrics.my_metric</span><span class="delimiter">'</span></span>],
                           <span class="key">top</span>: [<span class="string"><span class="delimiter">'</span><span class="content">label.department.region</span><span class="delimiter">'</span></span>])

    <span class="comment"># or you can pass by reference if you already hold it</span>
    m1 = project.metrics(<span class="string"><span class="delimiter">'</span><span class="content">metrics.my_metric</span><span class="delimiter">'</span></span>)
    project.compute_report(<span class="key">left</span>: [m1],
                           <span class="key">top</span>: [<span class="string"><span class="delimiter">'</span><span class="content">label.department.region</span><span class="delimiter">'</span></span>])

    <span class="comment"># report can take attributes and in that case it will use the default label</span>
    project.compute_report(<span class="key">left</span>: [m1],
                           <span class="key">top</span>: [<span class="string"><span class="delimiter">'</span><span class="content">attr.department.region</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">dataset.payment.quarter.in.year</span><span class="delimiter">'</span></span>])

    <span class="comment"># for readability you might shuffle those labels to different section of report</span>
    project.compute_report(<span class="key">left</span>: [m1, <span class="string"><span class="delimiter">'</span><span class="content">dataset.payment.quarter.in.year</span><span class="delimiter">'</span></span>],
                            <span class="key">top</span>: [<span class="string"><span class="delimiter">'</span><span class="content">attr.department.region</span><span class="delimiter">'</span></span>])


    <span class="comment"># there can be more than 1 metric in the group and the metric even does not have to be saved (if it is not it will be saved for you and removed after the computation)</span>
    m2 = project.attributes(<span class="string"><span class="delimiter">'</span><span class="content">attr.salary.id</span><span class="delimiter">'</span></span>).create_metric
    result = project.compute_report(<span class="key">left</span>: [m1, m2],
                           <span class="key">top</span>: [<span class="string"><span class="delimiter">'</span><span class="content">attr.department.region</span><span class="delimiter">'</span></span>])
    <span class="comment"># you can print out the results into console</span>
    puts result
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_working_with_report_results">Working with report results</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_58">Problem</h4>
<div class="paragraph">
<p>You have computed a report now you would like to get dirty with the data</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_58">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|

    <span class="comment"># first let's create a metric and give it a reasonable identifier so we can read the examples</span>
    m1 = project.facts(<span class="string"><span class="delimiter">'</span><span class="content">fact.salary.amount</span><span class="delimiter">'</span></span>).create_metric
    result = project.compute_report(<span class="key">left</span>: [m1, <span class="string"><span class="delimiter">'</span><span class="content">dataset.payment.quarter.in.year</span><span class="delimiter">'</span></span>],
                            <span class="key">top</span>: [<span class="string"><span class="delimiter">'</span><span class="content">attr.department.region</span><span class="delimiter">'</span></span>])

    <span class="comment"># You can print the result</span>
    puts result
    <span class="comment"># [   |               | Europe | North America]</span>
    <span class="comment"># [Q1 | sum of Amount | 29490  | 62010        ]</span>
    <span class="comment"># [Q2 | sum of Amount | 29490  | 62010        ]</span>
    <span class="comment"># [Q3 | sum of Amount | 29490  | 62010        ]</span>
    <span class="comment"># [Q4 | sum of Amount | 29490  | 62010        ]</span>

    <span class="comment"># You can get size of report</span>
    result.size <span class="comment"># =&gt; [5, 4]</span>

    <span class="comment"># this gives you the overall size but you probably want to also know the</span>
    <span class="comment"># size of the data portion</span>
    result.data_size <span class="comment"># =&gt; [4, 2]</span>

    <span class="comment"># you can learn if it is empty which comes handy for reports without data</span>
    result.empty? <span class="comment"># =&gt; false</span>

    <span class="comment"># You can access data as you would with matrix</span>
    result[<span class="integer">0</span>][<span class="integer">3</span>] <span class="comment"># =&gt; &quot;North America&quot;</span>
    result[<span class="integer">2</span>] <span class="comment"># [&quot;Q2&quot;, &quot;sum of Amount&quot;, &quot;29490&quot;, &quot;62010&quot;]</span>

    <span class="comment"># You can ask questions about contents</span>
    result.include_row? [<span class="string"><span class="delimiter">&quot;</span><span class="content">Q4</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">sum of Amount</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">29490</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">62010</span><span class="delimiter">&quot;</span></span>] <span class="comment"># =&gt; true</span>
    result.include_column? [<span class="string"><span class="delimiter">&quot;</span><span class="content">Europe</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">29490</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">29490</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">29490</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">29490</span><span class="delimiter">&quot;</span></span>] <span class="comment"># =&gt; false</span>

    <span class="comment"># this is fine but there is a lot fo clutter caused byt the headers. The library provides you with methods to get only slice of the result and creates a new result</span>
    <span class="comment"># Let's say I would like to get just data</span>
    puts result.slice(<span class="integer">1</span>, <span class="integer">2</span>)
    <span class="comment"># [29490 | 62010]</span>
    <span class="comment"># [29490 | 62010]</span>
    <span class="comment"># [29490 | 62010]</span>
    <span class="comment"># [29490 | 62010]</span>

    <span class="comment"># This is a worker method that is used to implement several helpers</span>
    <span class="comment"># Previous example is equivalent with this</span>
    puts result.data

    puts result.without_top_headers
    <span class="comment"># [Q1 | sum of Amount | 29490 | 62010]</span>
    <span class="comment"># [Q2 | sum of Amount | 29490 | 62010]</span>
    <span class="comment"># [Q3 | sum of Amount | 29490 | 62010]</span>
    <span class="comment"># [Q4 | sum of Amount | 29490 | 62010]</span>

    puts result.without_left_headers
    <span class="comment"># [Europe | North America]</span>
    <span class="comment"># [29490  | 62010        ]</span>
    <span class="comment"># [29490  | 62010        ]</span>
    <span class="comment"># [29490  | 62010        ]</span>
    <span class="comment"># [29490  | 62010        ]</span>

    <span class="comment"># All of those are again results so everything above works as expected</span>
    result.data.include_row? [<span class="string"><span class="delimiter">&quot;</span><span class="content">29490</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">62010</span><span class="delimiter">&quot;</span></span>] <span class="comment"># =&gt; true</span>

    <span class="comment"># There are several other methods that might make your life easier. Consider the following</span>
    result.diff result.without_top_headers
    <span class="comment"># {</span>
    <span class="comment">#   :added =&gt; [],</span>
    <span class="comment">#    :removed =&gt; [[nil, nil, &quot;Europe&quot;, &quot;North America&quot;]],</span>
    <span class="comment">#    :same =&gt; [[&quot;Q1&quot;, &quot;sum of Amount&quot;, &quot;29490&quot;, &quot;62010&quot;],</span>
    <span class="comment">#              [&quot;Q2&quot;, &quot;sum of Amount&quot;, &quot;29490&quot;, &quot;62010&quot;],</span>
    <span class="comment">#              [&quot;Q3&quot;, &quot;sum of Amount&quot;, &quot;29490&quot;, &quot;62010&quot;],</span>
    <span class="comment">#              [&quot;Q4&quot;, &quot;sum of Amount&quot;, &quot;29490&quot;, &quot;62010&quot;]]</span>
    <span class="comment"># }</span>

  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_09_working_with_facts_metrics_and_attributes">09 Working With Facts Metrics And Attributes</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>NOTE:</strong> All 'metric' related methods have their 'measure' counterpart alias. Here are few examples.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Project#add_metric &#8656;&#8658; Project#add_measure</p>
</li>
<li>
<p>Project#create_metric &#8656;&#8658; Project#create_measure</p>
</li>
<li>
<p>Project#compute_metric &#8656;&#8658; Project#compute_measure</p>
</li>
<li>
<p>Project#metrics &#8656;&#8658; Project#measures</p>
</li>
<li>
<p>Project#metric_by_title &#8656;&#8658; Project#measure_by_title</p>
</li>
<li>
<p>Project#metrics_by_title &#8656;&#8658; Project#measures_by_title</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See the gooddata gem&#8217;s Ruby reference documentation for the complete list of aliases.</p>
</div>
<div class="sect2">
<h3 id="_creating_metrics_from_attributes">Creating Metrics from Attributes</h3>
<div class="paragraph">
<p>by Patrick McConlogue, Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_59">Problem</h4>
<div class="paragraph">
<p>You have several attributes in a project. You would like to create some basic metric out of them.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_13">Prerequisites</h4>
<div class="paragraph">
<p>You have to have existing project with model and data loaded.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_59">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: UTF-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="comment"># Connect to GoodData platform</span>
<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    attribute = project.attributes(<span class="string"><span class="delimiter">'</span><span class="content">attr.devs.dev_id</span><span class="delimiter">'</span></span>)
    metric = attribute.create_metric(<span class="symbol">:title</span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">Count of [</span><span class="inline"><span class="inline-delimiter">#{</span>attribute.identifier<span class="inline-delimiter">}</span></span><span class="content">]</span><span class="delimiter">&quot;</span></span>)
    metric.save
    metric.execute
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_metrics_from_facts">Creating Metrics from Facts</h3>
<div class="paragraph">
<p>by Patrick McConlogue, Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_60">Problem</h4>
<div class="paragraph">
<p>You have several facts in a project. You would like to create some basic metric out of them.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_14">Prerequisites</h4>
<div class="paragraph">
<p>You have to have existing project with model and data loaded.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_60">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: UTF-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="comment"># Connect to GoodData platform</span>
<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    fact = project.facts(<span class="string"><span class="delimiter">'</span><span class="content">fact.commits.lines_changed</span><span class="delimiter">'</span></span>)
    metric = fact.create_metric(<span class="symbol">:title</span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">Sum of [</span><span class="inline"><span class="inline-delimiter">#{</span>fact.identifier<span class="inline-delimiter">}</span></span><span class="content">]</span><span class="delimiter">&quot;</span></span>)
    res = metric.execute
    puts res

    <span class="comment"># if you like the metric you can save it of course for later usage</span>
    metric.save

    <span class="comment"># Default aggregation is SUM but you can also specify a different one</span>
    metric = fact.create_metric(<span class="symbol">:title</span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">Min of [</span><span class="inline"><span class="inline-delimiter">#{</span>fact.identifier<span class="inline-delimiter">}</span></span><span class="content">]</span><span class="delimiter">&quot;</span></span>, <span class="key">type</span>: <span class="symbol">:min</span>)
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_write_information_about_project_s_metrics_to_csv">Write Information about Project&#8217;s Metrics to CSV</h3>
<div class="paragraph">
<p>by Tomas Korcak</p>
</div>
<div class="sect3">
<h4 id="_problem_61">Problem</h4>
<div class="paragraph">
<p>You would like to store information about all project metrics in CSV.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_15">Prerequisites</h4>
<div class="paragraph">
<p>You have to have existing project with metric(s).</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_61">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: UTF-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="comment"># Connect to GoodData platform</span>
<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    <span class="constant">CSV</span>.open(project.pid + <span class="string"><span class="delimiter">&quot;</span><span class="content">_metrics.csv</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">wb</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |csv|
      data = project.metrics.pmap <span class="keyword">do</span> |metric|
        [metric.title, metric.pretty_expression]
      <span class="keyword">end</span>
      data.each <span class="keyword">do</span> |m|
        csv &lt;&lt; m
      <span class="keyword">end</span>
      puts <span class="string"><span class="delimiter">'</span><span class="content">The CSV is ready!</span><span class="delimiter">'</span></span>
    <span class="keyword">end</span>
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It is a simple script that iterates over metrics (remember report specific metrics are not included in the list) and collects some fields. In our case it is title and pretty printed metric&#8217;s MAQL expression. If you would like to get more information, just add them to the list. In the end this list is formatted as a valid CSV so any reasonable CSV parser should be able to load it.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_changing_metric_s_number_formatting">Changing Metric&#8217;s Number Formatting</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_62">Problem</h4>
<div class="paragraph">
<p>You have a project and you would like to update formatting of all metrics programatically. They are currently formatted for dollar values but you would like to change the all formats to Euro.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_62">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    project.metrics.pmap <span class="keyword">do</span> |metric|
      metric.content[<span class="string"><span class="delimiter">'</span><span class="content">format</span><span class="delimiter">'</span></span>] = metric.content[<span class="string"><span class="delimiter">'</span><span class="content">format</span><span class="delimiter">'</span></span>].gsub(<span class="string"><span class="delimiter">'</span><span class="content">$</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">€</span><span class="delimiter">'</span></span>)
      metric.save
    <span class="keyword">end</span>
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_metrics">Creating Metrics</h3>
<div class="paragraph">
<p>by Zdenek Svoboda</p>
</div>
<div class="sect3">
<h4 id="_problem_63">Problem</h4>
<div class="paragraph">
<p>You want to create advanced MAQL metric.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_16">Prerequisites</h4>
<div class="paragraph">
<p>You have to have existing project with model and data loaded.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_63">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: UTF-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="comment"># Connect to GoodData platform</span>
<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    metric = project.add_measure <span class="string"><span class="delimiter">'</span><span class="content">SELECT PERCENTILE(#&quot;Amount&quot;,0.9)</span><span class="delimiter">'</span></span>,
     <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Salary Amount [90th Pct]</span><span class="delimiter">'</span></span>
    metric.save
    metric.execute

    metric = project.add_measure <span class="string"><span class="delimiter">'</span><span class="content">SELECT PERCENTILE(![fact.salary.amount],0.9)</span><span class="delimiter">'</span></span>,
     <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Salary Amount [90th Pct] V2</span><span class="delimiter">'</span></span>
    metric.save
    metric.execute

    metric = project.add_measure <span class="string"><span class="delimiter">'</span><span class="content">SELECT PERCENTILE([/gdc/md/ptbedvc1841r4obgptywd2mzhbwjsfyr/obj/223],0.9)</span><span class="delimiter">'</span></span>,
     <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Salary Amount [90th Pct] V3</span><span class="delimiter">'</span></span>
    metric.save
    metric.execute

  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_20">Discussion</h4>
<div class="paragraph">
<p>Please note that the MAQL statement uses three ways how to reference the underlying objects (e.g. facts or metrics that are part of the MAQL statement)</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>#"Amount"</em> for referencing the fact (or metric) via its name (title)</p>
</li>
<li>
<p><em>![fact.salary.amount]</em> for referencing the fact (or metric) via its identifier</p>
</li>
<li>
<p><em>[/gdc/md/ptbedvc1841r4obgptywd2mzhbwjsfyr/obj/223]</em> for referencing the fact (or metric) via its uri</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_10_working_with_dashboards">10 Working With Dashboards</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_listing_dashboards">Listing Dashboards</h3>
<div class="paragraph">
<p>by Tomas Korcak</p>
</div>
<div class="sect3">
<h4 id="_problem_64">Problem</h4>
<div class="paragraph">
<p>You would like to list dashboards programmatically.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_17">Prerequisites</h4>
<div class="paragraph">
<p>You have to have existing project with dashboard(s).</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_64">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: UTF-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">we1vvh4il93r0927r809i3agif50d7iz</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    <span class="comment"># List all dashboards</span>
    pp project.dashboards
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_11_working_with_data_permissions">11 Working With Data Permissions</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_setting_up_simple_data_permission">Setting Up Simple Data Permission</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_65">Problem</h4>
<div class="paragraph">
<p>You would like to set a data permission (user filter or MUF filter) for one or two users.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_65">Solution</h4>
<div class="paragraph">
<p>SDK offers couple of convenience features for doing this. Let&#8217;s first recap what we need to set up a data permission filter. We&#8217;ll be setting a simple filter along these lines</p>
</div>
<div class="literalblock">
<div class="content">
<pre>WHERE city IN (San Francisco, Prague, Amsterdam)</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>We need to know the label to filter. In our case this is the <em>city</em> label</p>
</li>
<li>
<p>We need to know the label&#8217;s values. In our case these are (San Francisco, Prague, Amsterdam)</p>
</li>
<li>
<p>We also need to know the user assigned with the filter. We&#8217;ll use your account in the example (you may use any valid user).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Although we present this as an executable script this is something that is often done interactively.
So do not fear to jack in to a project and follow along.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    <span class="comment"># First let's grab an attribute</span>
    attribute = project.attributes(<span class="string"><span class="delimiter">'</span><span class="content">attr.region.city</span><span class="delimiter">'</span></span>)
    <span class="comment"># to set up a value we need a specific label</span>
    <span class="comment"># if the attribute has only one label, you can easily grab it by calling #primary_label</span>
    label = attribute.primary_label
    <span class="comment"># if a label has multiple labels, you can select the correct one like this</span>
    <span class="comment"># label = attribute.label_by_name('City Name')</span>
    <span class="comment"># Let's construct filters we are going to set up</span>
    <span class="comment"># We will do it for two hypothetical users</span>
    filters = [
      [<span class="string"><span class="delimiter">'</span><span class="content">john.doe@example.com</span><span class="delimiter">'</span></span>, label.uri, <span class="string"><span class="delimiter">'</span><span class="content">San Francisco</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Amsterdam</span><span class="delimiter">'</span></span>]
      [<span class="string"><span class="delimiter">'</span><span class="content">jane.doe@example.com</span><span class="delimiter">'</span></span>, label.uri, <span class="string"><span class="delimiter">'</span><span class="content">San Francisco</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Prague</span><span class="delimiter">'</span></span>]
    ]
    <span class="comment"># Obvious question might be how do you know that the values are correct</span>
    <span class="comment"># you can find out like this label.value?('Amsterdam')</span>
    <span class="comment"># Let's now update the project</span>
    project.add_data_permissions(filters)
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_list_data_permissions">List Data Permissions</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_66">Problem</h4>
<div class="paragraph">
<p>You have a project that has the data permissions set up. You would like to review them.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_66">Solution</h4>
<div class="paragraph">
<p>There is no UI that would provide a good overview and API is a little crude but with help of SDK you can get around that.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    project.data_permissions.pmap {|f| [f.related.login, f.pretty_expression]}
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_setting_data_permissions_from_csv_column_format">Setting Data Permissions from CSV (column format)</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_67">Problem</h4>
<div class="paragraph">
<p>You would like to set adata permissions for multiple users. You have a CSV with two columns that associate user with a single data permssion&#8217;s value. We&#8217;ll use the same city example from the examples above.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_67">Solution</h4>
<div class="paragraph">
<p>SDK offers couple of convenience features for doing this. Let&#8217;s first recap what we need to set up a filter.</p>
</div>
<div class="paragraph">
<p>In this case we will be setting a simple data permission for the city label in form of following filter</p>
</div>
<div class="literalblock">
<div class="content">
<pre>WHERE city IN ('San Francisco', 'Prague', 'Amsterdam')</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>We need to know the label to filter. In our case this is the <em>city</em> label</p>
</li>
<li>
<p>We need to know the label&#8217;s values. In our case these are (San Francisco, Prague, Amsterdam)</p>
</li>
<li>
<p>We also need to know the user assigned with the filter. We&#8217;ll use your account in the example (you may use any valid user).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s say we want to set up these specific values</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>['john.doe@example.com', 'San Francisco', 'Amsterdam']
['jane.doe@example.com', 'San Francisco', 'Prague']</code></pre>
</div>
</div>
<div class="paragraph">
<p>We&#8217;ll capture these data permissions in the following CSV (data.csv)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>login,city
john.doe@example.com,San Francisco
john.doe@example.com,Amsterdam
jane.doe@example.com,San Francisco
jane.doe@example.com,Prague</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    <span class="comment"># First let's grab an attribute</span>
    attribute = project.attributes(<span class="string"><span class="delimiter">'</span><span class="content">attr.region.city</span><span class="delimiter">'</span></span>)
    <span class="comment"># to set up a value we need a specific label</span>
    <span class="comment"># if the attribute has only one label, you can easily grab it by calling #primary_label</span>
    label = attribute.primary_label
    <span class="comment"># if a label has multiple labels, you can select the correct one like this</span>
    <span class="comment"># label = attribute.label_by_name('City name')</span>
    filters = <span class="constant">GoodData</span>::<span class="constant">UserFilterBuilder</span>::get_filters(<span class="string"><span class="delimiter">'</span><span class="content">data.csv</span><span class="delimiter">'</span></span>, {
      <span class="symbol">:type</span> =&gt; <span class="symbol">:filter</span>,
      <span class="symbol">:labels</span> =&gt; [{<span class="symbol">:label</span> =&gt; label, <span class="symbol">:column</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">city</span><span class="delimiter">'</span></span>}]
      })
    project.add_data_permissions(filters)
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_preconditions">Preconditions</h5>
<div class="paragraph">
<p>Several things has to be true for this code to work correctly</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All the users are members of the target project</p>
</li>
<li>
<p>All the label&#8217;s (city) values are present in the data loaded in the project</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_setting_data_permissions_from_csv_row_format">Setting Data Permissions from CSV (row format)</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_68">Problem</h4>
<div class="paragraph">
<p>You would like to set adata permissions for multiple users. You have a CSV with two columns that associate user with a single data permssion&#8217;s value. We&#8217;ll use the same city example from the examples above.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_68">Solution</h4>
<div class="paragraph">
<p>SDK offers couple of convenience features for doing this. Let&#8217;s first recap what we need to set up a filter.</p>
</div>
<div class="paragraph">
<p>In this case we will be setting a simple data permission for the city label in form of following filter</p>
</div>
<div class="literalblock">
<div class="content">
<pre>WHERE city IN ('San Francisco', 'Prague', 'Amsterdam')</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>We need to know the label to filter. In our case this is the <em>city</em> label</p>
</li>
<li>
<p>We need to know the label&#8217;s values. In our case these are (San Francisco, Prague, Amsterdam)</p>
</li>
<li>
<p>We also need to know the user assigned with the filter. We&#8217;ll use your account in the example (you may use any valid user).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s say we want to set up these specific values</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>['john.doe@example.com', 'San Francisco', 'Amsterdam']
['jane.doe@example.com', 'San Francisco', 'Prague']</code></pre>
</div>
</div>
<div class="paragraph">
<p>We&#8217;ll capture these data permissions in the following CSV (data.csv)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>john.doe@example.com,San Francisco,Amsterdam
jane.doe@example.com,San Francisco,Prague,Berlin</code></pre>
</div>
</div>
<div class="paragraph">
<p>Please note that the CSV format is different frpom the previous example. There are no headers because the file can have different number of columns on each line.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    <span class="comment"># First let's grab an attribute</span>
    attribute = project.attributes(<span class="string"><span class="delimiter">'</span><span class="content">attr.region.city</span><span class="delimiter">'</span></span>)
    <span class="comment"># to set up a value we need a specific label</span>
    <span class="comment"># if the attribute has only one label, you can easily grab it by calling #primary_label</span>
    label = attribute.primary_label
    <span class="comment"># if a label has multiple labels, you can select the correct one like this</span>
    <span class="comment"># label = attribute.label_by_name('City name')</span>
    filters = <span class="constant">GoodData</span>::<span class="constant">UserFilterBuilder</span>::get_filters(<span class="string"><span class="delimiter">'</span><span class="content">data.csv</span><span class="delimiter">'</span></span>, {
      <span class="symbol">:type</span> =&gt; <span class="symbol">:filter</span>,
      <span class="symbol">:labels</span> =&gt; [{<span class="symbol">:label</span> =&gt; label}]
      })
    project.add_data_permissions(filters)
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_preconditions_2">Preconditions</h5>
<div class="paragraph">
<p>Several things has to be true for this code to work correctly</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All the users are members of the target project</p>
</li>
<li>
<p>All the label&#8217;s (city) values are present in the data loaded in the project</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_list_variable_values">List Variable Values</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_69">Problem</h4>
<div class="paragraph">
<p>You have variable in your project and you would like to see the values in a readable fashion.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_69">Solution</h4>
<div class="paragraph">
<p>SDK tries to hide the differences from Data Permissions so this recipe is analogy to <a href="#_list_data_permissions">List Data Permissions</a> recipe.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="comment"># fill this in</span>
<span class="constant">VARIABLE_IDENTIFIER</span> = <span class="string"><span class="delimiter">'</span><span class="content">variable_identifier</span><span class="delimiter">'</span></span>
<span class="constant">PROJECT_ID</span> = <span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="constant">PROJECT_ID</span>) <span class="keyword">do</span> |project|
    var = project.variables(<span class="constant">VARIABLE_IDENTIFIER</span>)
    var.values.pmap <span class="keyword">do</span> |var|
      owner = var.related.class == <span class="constant">GoodData</span>::<span class="constant">Project</span> ? <span class="string"><span class="delimiter">&quot;</span><span class="content">[PROJECT DEFAULT]</span><span class="delimiter">&quot;</span></span> : var.related.login <span class="keyword">rescue</span> <span class="predefined-constant">nil</span>
      [owner, var.pretty_expression]
    <span class="keyword">end</span>
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Unlike the Data Permissions Variables has a concept of default value for the project. If a specific values is not provided for a user the project default is used. You can noticed these users to have "TRUE" as a value. The project value is marked as [PROJECT DEFAULT] in the output.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_12_working_with_blueprints">12 Working With Blueprints</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_what_is_blueprint">What is blueprint</h3>
<div class="paragraph">
<p>Before we delve into examples involving blueprints let&#8217;s talk a moment what a blueprint is and what is a difference between blueprint and model when we talk about them at Gooddata.</p>
</div>
<div class="paragraph">
<p>They mean the same thing but they are representing it in a different way and they live at different places. Both of them define a model of analytic application.</p>
</div>
<div class="paragraph">
<p>The main difference is the fact that when we talk about model we mean a specific instance of a project which has specific instance of model with all its attributes and facts that live at GoodData platform. Each field has a URI and object_id and you can query it using the platform API. You can also ask questions like "What object in the model has object_id 1532?" or "Can you give me a link to dataset 'users' in the model?".</p>
</div>
<div class="paragraph">
<p>When we talk about blueprint on the other hand we mean the abstract prescription that tells us how to create the model. Blueprint does not contain many of the details most prominently object_ids and URIs and strictly speaking each time you use blueprint to create a model those things might be different. When a model is created from blueprint as a sideffect all the URIs and id are created.</p>
</div>
<div class="paragraph">
<p>So what are the benefits of the blueprint you might ask? Blueprint was specifically designed so you can have a description of the model that can live outside of GoodData platform. It has textual representation which you can commit into git and work with it in a programmatic way. Second it is intended that the many projects are created from one blueprint.</p>
</div>
</div>
<div class="sect2">
<h3 id="_creating_project_from_blueprint">Creating Project from Blueprint</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_70">Problem</h4>
<div class="paragraph">
<p>You would like to create a new project with a data model programatically.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_70">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

client = <span class="constant">GoodData</span>.connect

blueprint = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.build(<span class="string"><span class="delimiter">&quot;</span><span class="content">My project from blueprint</span><span class="delimiter">&quot;</span></span>) <span class="keyword">do</span> |p|
  p.add_date_dimension(<span class="string"><span class="delimiter">'</span><span class="content">created_on</span><span class="delimiter">'</span></span>)

  p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.users</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
    d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.users.id</span><span class="delimiter">'</span></span>)
    d.add_date(<span class="string"><span class="delimiter">'</span><span class="content">created_on</span><span class="delimiter">'</span></span>)
    d.add_fact(<span class="string"><span class="delimiter">'</span><span class="content">fact.users.some_number</span><span class="delimiter">'</span></span>)
  <span class="keyword">end</span>
<span class="keyword">end</span>

blueprint.valid? <span class="comment"># =&gt; true</span>

project = client.create_project_from_blueprint(blueprint, <span class="key">auth_token</span>: <span class="string"><span class="delimiter">'</span><span class="content">token</span><span class="delimiter">'</span></span>)

<span class="comment"># After the project is created (might take a while) you can start using it</span>
project.title <span class="comment"># =&gt; &quot;My project from blueprint&quot;</span>
project.datasets.count <span class="comment"># =&gt; 2</span>
project.facts(<span class="string"><span class="delimiter">'</span><span class="content">fact.users.some_number</span><span class="delimiter">'</span></span>).identifier <span class="comment"># =&gt; 'fact.users.some_number'</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This created a project with very simple model with just 2 datasets. One is date dimension. The other is a typical fact table. For another more complex example chec out the recipe "Working with HR Demo project" which uses many of the features we will explain here.</p>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_21">Discussion</h4>
<div class="paragraph">
<p>Let&#8217;s have a look at couple of other variations and more complex examples.</p>
</div>
<div class="sect4">
<h5 id="_defining_identifiers">Defining identifiers</h5>
<div class="paragraph">
<p>Majority of the objects defined in a blueprint will end up as object in metadata server in the project. Each of these objects has its URI, object id (this number is part of the URI) and identifier which is a textual id. URI and object id are created automatically during creation of a model and you cannot influence them in any way but you have to define the identifiers. This is also the first parameter in majority of the add_&#8230;&#8203; commands. Namely</p>
</div>
<div class="literalblock">
<div class="content">
<pre>add_anchor
add_label
add_dataset
add_fact
add_attribute</pre>
</div>
</div>
<div class="paragraph">
<p>When you see this in the blueprint</p>
</div>
<div class="literalblock">
<div class="content">
<pre>p.add_dataset('dataset.users')</pre>
</div>
</div>
<div class="paragraph">
<p>It means that later you would be able to do</p>
</div>
<div class="literalblock">
<div class="content">
<pre>project.datasets('dataset.users') # this will search all the datasets and returns you the one with identifier 'dataset.users'.</pre>
</div>
</div>
<div class="paragraph">
<p>Similarly</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">d.add_fact(<span class="string"><span class="delimiter">'</span><span class="content">fact.users.some_number</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>will result into you be able to do</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">project.facts(<span class="string"><span class="delimiter">'</span><span class="content">fact.users.some_number</span><span class="delimiter">'</span></span>) <span class="comment"># this will search all the facts and returns you the one with identifier 'fact.users.some_number'.</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Identifier can be anything. The only condition is that it has to be unique in the context of a project. No 2 objects may have the same identifer. That being said it is useful to have some kind of convention how you assign the identifiers.</p>
</div>
<div class="paragraph">
<p>Exception to this rule are references and date_references which we will discuss separately.</p>
</div>
</div>
<div class="sect4">
<h5 id="_defining_attributes">Defining attributes</h5>
<div class="paragraph">
<p>When you define attributes through add_attribute you have to remember to add at least one label to that particular attribute</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">blueprint = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.build(<span class="string"><span class="delimiter">&quot;</span><span class="content">My project from blueprint</span><span class="delimiter">&quot;</span></span>) <span class="keyword">do</span> |p|
  p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.users</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
    d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.users.id</span><span class="delimiter">'</span></span>)
    d.add_attribute(<span class="string"><span class="delimiter">'</span><span class="content">attr.users.name</span><span class="delimiter">'</span></span>)
  <span class="keyword">end</span>
<span class="keyword">end</span>

blueprint.valid? <span class="comment"># =&gt; false</span>
blueprint.validate <span class="comment"># =&gt; [{:type=&gt;:attribute_without_label, :attribute=&gt;&quot;attr.users.name&quot;}]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can do it like this</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">blueprint = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.build(<span class="string"><span class="delimiter">&quot;</span><span class="content">My project from blueprint</span><span class="delimiter">&quot;</span></span>) <span class="keyword">do</span> |p|
  p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.users</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
    d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.users.id</span><span class="delimiter">'</span></span>)
    d.add_attribute(<span class="string"><span class="delimiter">'</span><span class="content">attr.users.name</span><span class="delimiter">'</span></span>)
    d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.users.name.full_name</span><span class="delimiter">'</span></span>, <span class="key">reference</span>: <span class="string"><span class="delimiter">'</span><span class="content">attr.users.name</span><span class="delimiter">'</span></span>)
    d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.users.name.abbreviated_name</span><span class="delimiter">'</span></span>, <span class="key">reference</span>: <span class="string"><span class="delimiter">'</span><span class="content">attr.users.name</span><span class="delimiter">'</span></span>)
  <span class="keyword">end</span>
<span class="keyword">end</span>

blueprint.valid? <span class="comment"># =&gt; true</span>
blueprint.validate <span class="comment"># =&gt; []</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_defining_anchors_connection_points">Defining anchors/connection_points</h5>
<div class="paragraph">
<p>Since you might argue that anchor (you might also hear term connection point which means the same thing) is a special case of the attribute lets' talk about it a little. Yes it is true but there are additional things that make it that special one. There can be only one anchor in each dataset</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">blueprint = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.build(<span class="string"><span class="delimiter">&quot;</span><span class="content">My project from blueprint</span><span class="delimiter">&quot;</span></span>) <span class="keyword">do</span> |p|
  p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.users</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
    d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.users.id</span><span class="delimiter">'</span></span>)
    d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.users.id2</span><span class="delimiter">'</span></span>)
  <span class="keyword">end</span>
<span class="keyword">end</span>

blueprint.valid? <span class="comment"># =&gt; false</span>
blueprint.validate <span class="comment"># =&gt; [{:type=&gt;:more_than_on_anchor, :dataset=&gt;&quot;dataset.users&quot;}]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Anchor is the thing you can reference from other datasets. If you want to do that you have to define a label. Anchor can have multiple labels same as attribute. We strongly recommend not to define anchor with labels on fact tabels (they are usually not referenced). The only exception to this rule is if you need to upsert data.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">blueprint = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.build(<span class="string"><span class="delimiter">&quot;</span><span class="content">My project from blueprint</span><span class="delimiter">&quot;</span></span>) <span class="keyword">do</span> |p|
  p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.users</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
    d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.users.id</span><span class="delimiter">'</span></span>)
    d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.users.id</span><span class="delimiter">'</span></span>, <span class="key">reference</span>: <span class="string"><span class="delimiter">'</span><span class="content">attr.users.id</span><span class="delimiter">'</span></span>)
    d.add_attribute(<span class="string"><span class="delimiter">'</span><span class="content">attr.users.name</span><span class="delimiter">'</span></span>)
    d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.users.name.full_name</span><span class="delimiter">'</span></span>, <span class="key">reference</span>: <span class="string"><span class="delimiter">'</span><span class="content">attr.users.name</span><span class="delimiter">'</span></span>)
  <span class="keyword">end</span>

  p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.sales</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
    d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.sales.id</span><span class="delimiter">'</span></span>)
    d.add_fact(<span class="string"><span class="delimiter">'</span><span class="content">fact.sales.amount</span><span class="delimiter">'</span></span>)
    d.add_reference(<span class="string"><span class="delimiter">'</span><span class="content">dataset.users</span><span class="delimiter">'</span></span>)
  <span class="keyword">end</span>
<span class="keyword">end</span>

blueprint.valid? <span class="comment"># =&gt; true</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Good question is "why you have to define the anchor if it has no labels?". The reason is that you still need the underlying attribute if you want to construct the count metric for fact table to answere question "How many lines there is in the 'dataset.sales' dataset?". You would do it as follows with SDK (with previous model).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">project.attributes(<span class="string"><span class="delimiter">&quot;</span><span class="content">attr.sales.id</span><span class="delimiter">&quot;</span></span>).create_metric.execute</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_defining_date_dimensions">Defining date dimensions</h5>
<div class="paragraph">
<p>In all tools and even in MAQL date dimensions are reprseneted as single unit (as in blueprint builder add_date_dimension). This is great for readability but might be misleading. The fact is that date dimension is several datasets that contain typically ~18 attributes. If you understand this it is probably not surprising that the parameter to 'add_date_dimension' is not an identifier but a name that will be used in titles and identifiers of all attributes. It is also a name that you can use in add_date function. Here is an example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">blueprint = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.build(<span class="string"><span class="delimiter">&quot;</span><span class="content">My project from blueprint</span><span class="delimiter">&quot;</span></span>) <span class="keyword">do</span> |p|
  p.add_date_dimension(<span class="string"><span class="delimiter">'</span><span class="content">created_on</span><span class="delimiter">'</span></span>)

  p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.users</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
    d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.users.id</span><span class="delimiter">'</span></span>)
    d.add_fact(<span class="string"><span class="delimiter">'</span><span class="content">fact.users.some_number</span><span class="delimiter">'</span></span>)
    d.add_date(<span class="string"><span class="delimiter">'</span><span class="content">created_on</span><span class="delimiter">'</span></span>)
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_defining_references">Defining references</h5>
<div class="paragraph">
<p>Typically in your model you need to reference other datasets. This is expressed in the blueprint builder with add_reference function. It takes only one parameter which is the identifier of referenced dataset. References do not have identifier since they are not represented as objects on the platform.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">blueprint = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.build(<span class="string"><span class="delimiter">&quot;</span><span class="content">My project from blueprint</span><span class="delimiter">&quot;</span></span>) <span class="keyword">do</span> |p|
  p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.users</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
    d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.users.id</span><span class="delimiter">'</span></span>)
    d.add_attribute(<span class="string"><span class="delimiter">'</span><span class="content">attr.users.name</span><span class="delimiter">'</span></span>)
    d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">attr.users.name.full_name</span><span class="delimiter">'</span></span>, <span class="key">reference</span>: <span class="string"><span class="delimiter">'</span><span class="content">attr.users.name</span><span class="delimiter">'</span></span>)
  <span class="keyword">end</span>

  p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.sales</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
    d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.sales.id</span><span class="delimiter">'</span></span>)
    d.add_fact(<span class="string"><span class="delimiter">'</span><span class="content">fact.sales.amount</span><span class="delimiter">'</span></span>)
    d.add_reference(<span class="string"><span class="delimiter">'</span><span class="content">dataset.users</span><span class="delimiter">'</span></span>)
  <span class="keyword">end</span>
<span class="keyword">end</span>

blueprint.valid? <span class="comment"># =&gt; true</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_defining_date_references">Defining date references</h5>
<div class="paragraph">
<p>This is very similar to references but there is additional hint that you are referencing date dimension.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">blueprint = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.build(<span class="string"><span class="delimiter">&quot;</span><span class="content">My project from blueprint</span><span class="delimiter">&quot;</span></span>) <span class="keyword">do</span> |p|
  p.add_date_dimension(<span class="string"><span class="delimiter">'</span><span class="content">created_on</span><span class="delimiter">'</span></span>)

  p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.users</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
    d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.users.id</span><span class="delimiter">'</span></span>)
    d.add_date(<span class="string"><span class="delimiter">'</span><span class="content">created_on</span><span class="delimiter">'</span></span>)
    d.add_fact(<span class="string"><span class="delimiter">'</span><span class="content">fact.users.some_number</span><span class="delimiter">'</span></span>)
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_defining_titles">Defining Titles</h5>
<div class="paragraph">
<p>If you would build and open in the browser any of the models we built up to this point you probably noticed that the titles look off. Since we did not define anything SDK tries to do the right thing and tries to use the identifiers (with some tweaking for readability) as titles. While this might work it is usually not what you want. You can easily fix that by defining the titles explicitly.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">blueprint = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.build(<span class="string"><span class="delimiter">&quot;</span><span class="content">My project from blueprint</span><span class="delimiter">&quot;</span></span>) <span class="keyword">do</span> |p|
  p.add_date_dimension(<span class="string"><span class="delimiter">'</span><span class="content">created_on</span><span class="delimiter">'</span></span>)

  p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.users</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
    d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.users.id</span><span class="delimiter">'</span></span>)
    d.add_date(<span class="string"><span class="delimiter">'</span><span class="content">created_on</span><span class="delimiter">'</span></span>)
    d.add_fact(<span class="string"><span class="delimiter">'</span><span class="content">fact.users.amount</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Amount Sold</span><span class="delimiter">'</span></span>)
  <span class="keyword">end</span>
<span class="keyword">end</span>

project.facts(<span class="string"><span class="delimiter">'</span><span class="content">fact.users.amount</span><span class="delimiter">'</span></span>).title <span class="comment"># =&gt; 'Amount Sold'</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_specifying_data_types">Specifying data types</h5>
<div class="paragraph">
<p>Ocasionally the default datatypes of the fields will not be what you want. You can redefine them for both labels and facts as exepected with parameter :gd_data_type. There is more information about this in a following recipe.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_getting_blueprint_from_existing_project">Getting Blueprint from Existing Project</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_71">Problem</h4>
<div class="paragraph">
<p>You have an existing project and would like to reverse engineer it&#8217;s blueprint.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_71">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    blueprint = project.blueprint

    <span class="comment"># now you can start working with it</span>
    blueprint.datasets.count <span class="comment"># =&gt; 3</span>
    blueprint.datasets(<span class="symbol">:all</span>, <span class="key">include_date_dimensions</span>: <span class="predefined-constant">true</span>).count <span class="comment"># =&gt; 4</span>
    blueprint.attributes.map(&amp;<span class="symbol">:title</span>)

    <span class="comment"># You can also store it into file as json</span>
    blueprint.store_to_file(<span class="string"><span class="delimiter">'</span><span class="content">model.json</span><span class="delimiter">'</span></span>)
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_loading_data_to_project">Loading Data to Project</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_72">Problem</h4>
<div class="paragraph">
<p>You would like to load data into project.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_72">Solution</h4>
<div class="paragraph">
<p>To load data you have to have 3 things. Blueprint, project and data.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  blueprint = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.build(<span class="string"><span class="delimiter">'</span><span class="content">Acme project</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |p|
    p.add_date_dimension(<span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>)

    p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.commits</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
      d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.commits.id</span><span class="delimiter">'</span></span>)
      d.add_fact(<span class="string"><span class="delimiter">'</span><span class="content">fact.commits.lines_changed</span><span class="delimiter">'</span></span>)
            d.add_attribute(<span class="string"><span class="delimiter">'</span><span class="content">attr.commits.name</span><span class="delimiter">'</span></span>)
      d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.commits.name</span><span class="delimiter">'</span></span>, <span class="key">reference</span>: <span class="string"><span class="delimiter">'</span><span class="content">attr.commits.name</span><span class="delimiter">'</span></span>)
      d.add_date(<span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>, <span class="symbol">:format</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">dd/MM/yyyy</span><span class="delimiter">'</span></span>)
    <span class="keyword">end</span>
  <span class="keyword">end</span>

  project = client.create_project_from_blueprint(blueprint, <span class="key">auth_token</span>: <span class="string"><span class="delimiter">'</span><span class="content">TOKEN</span><span class="delimiter">'</span></span>)

  <span class="comment"># By default names of the columns are the identifiers of the labels, facts, or names of references</span>
  data = [
    [<span class="string"><span class="delimiter">'</span><span class="content">fact.commits.lines_changed</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">label.commits.name</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>],
    [<span class="integer">1</span>, <span class="string"><span class="delimiter">'</span><span class="content">tomas</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">01/01/2001</span><span class="delimiter">'</span></span>],
    [<span class="integer">1</span>, <span class="string"><span class="delimiter">'</span><span class="content">petr</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">01/12/2001</span><span class="delimiter">'</span></span>],
    [<span class="integer">1</span>, <span class="string"><span class="delimiter">'</span><span class="content">jirka</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">24/12/2014</span><span class="delimiter">'</span></span>]]

  project.upload(data, blueprint, <span class="string"><span class="delimiter">'</span><span class="content">dataset.commits</span><span class="delimiter">'</span></span>)

  <span class="comment"># Now the data are loaded in. You can easily compute some number</span>
  project.facts.first.create_metric(<span class="key">type</span>: <span class="symbol">:sum</span>).execute <span class="comment"># =&gt; 3</span>

  <span class="comment"># By default data are loaded in full mode. This means that data override all previous data in the dataset</span>
  data = [
    [<span class="string"><span class="delimiter">'</span><span class="content">fact.commits.lines_changed</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">label.commits.name</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>],
    [<span class="integer">10</span>, <span class="string"><span class="delimiter">'</span><span class="content">tomas</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">01/01/2001</span><span class="delimiter">'</span></span>],
    [<span class="integer">10</span>, <span class="string"><span class="delimiter">'</span><span class="content">petr</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">01/12/2001</span><span class="delimiter">'</span></span>],
    [<span class="integer">10</span>, <span class="string"><span class="delimiter">'</span><span class="content">jirka</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">24/12/2014</span><span class="delimiter">'</span></span>]]
  project.upload(data, blueprint, <span class="string"><span class="delimiter">'</span><span class="content">dataset.commits</span><span class="delimiter">'</span></span>)
  project.facts.first.create_metric(<span class="key">type</span>: <span class="symbol">:sum</span>).execute <span class="comment"># =&gt; 30</span>

  <span class="comment"># You can also load more data through INCREMENTAL mode</span>
  project.upload(data, blueprint, <span class="string"><span class="delimiter">'</span><span class="content">dataset.commits</span><span class="delimiter">'</span></span>, <span class="symbol">:mode</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">INCREMENTAL</span><span class="delimiter">'</span></span>)
  project.facts.first.create_metric(<span class="key">type</span>: <span class="symbol">:sum</span>).execute <span class="comment"># =&gt; 60</span>

  <span class="comment"># If you want to you can also specify what the names of the columns in the CSV is going to be</span>

  blueprint = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.build(<span class="string"><span class="delimiter">'</span><span class="content">Acme project</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |p|
    p.add_date_dimension(<span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>)

    p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.commits</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
      d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.commits.id</span><span class="delimiter">'</span></span>)
      d.add_fact(<span class="string"><span class="delimiter">'</span><span class="content">fact.commits.lines_changed</span><span class="delimiter">'</span></span>, <span class="key">column_name</span>: <span class="string"><span class="delimiter">'</span><span class="content">fact</span><span class="delimiter">'</span></span>)
            d.add_attribute(<span class="string"><span class="delimiter">'</span><span class="content">attr.commits.name</span><span class="delimiter">'</span></span>)
      d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.commits.name</span><span class="delimiter">'</span></span>, <span class="key">reference</span>: <span class="string"><span class="delimiter">'</span><span class="content">attr.commits.name</span><span class="delimiter">'</span></span>, <span class="key">column_name</span>: <span class="string"><span class="delimiter">'</span><span class="content">label</span><span class="delimiter">'</span></span> )
      d.add_date(<span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>, <span class="symbol">:format</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">dd/MM/yyyy</span><span class="delimiter">'</span></span>, <span class="key">column_name</span>: <span class="string"><span class="delimiter">'</span><span class="content">ref</span><span class="delimiter">'</span></span>)
    <span class="keyword">end</span>
  <span class="keyword">end</span>

  data = [
    [<span class="string"><span class="delimiter">'</span><span class="content">fact</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">label</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">ref</span><span class="delimiter">'</span></span>],
    [<span class="integer">10</span>, <span class="string"><span class="delimiter">'</span><span class="content">tomas</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">01/01/2001</span><span class="delimiter">'</span></span>],
    [<span class="integer">10</span>, <span class="string"><span class="delimiter">'</span><span class="content">petr</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">01/12/2001</span><span class="delimiter">'</span></span>],
    [<span class="integer">10</span>, <span class="string"><span class="delimiter">'</span><span class="content">jirka</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">24/12/2014</span><span class="delimiter">'</span></span>]]
  project.upload(data, blueprint, <span class="string"><span class="delimiter">'</span><span class="content">dataset.commits</span><span class="delimiter">'</span></span>)
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_loading_multiple_data_sets_to_project">Loading Multiple Data Sets to Project</h3>
<div class="paragraph">
<p>by Tomas Korcak</p>
</div>
<div class="sect3">
<h4 id="_problem_73">Problem</h4>
<div class="paragraph">
<p>You would like to load multiple data sets into project at once.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_73">Solution</h4>
<div class="paragraph">
<p>The GoodData platform supports loading multiple datasets from a set of CSV files in a single task.
In addition to loading a single CSV at a time, you can now upload your CSV files,
provide a JSON manifest file, and then execute the data load through a single API call.
This method is particularly useful if your project contains many datasets, or if you are loading multiple datasets with larger data volumes. The multiple datasets processing is significantly faster in these situations.</p>
</div>
<div class="paragraph">
<p>For more info see <a href="http://developer.gooddata.com/article/multiload-of-csv-data">GoodData Article</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>
require <span class="string"><span class="delimiter">'</span><span class="content">csv</span><span class="delimiter">'</span></span>

<span class="constant">USERNAME</span> = <span class="string"><span class="delimiter">'</span><span class="content">YOUR_USERNAME</span><span class="delimiter">'</span></span>
<span class="constant">PASSWORD</span> = <span class="string"><span class="delimiter">'</span><span class="content">YOUR_PASSWORD</span><span class="delimiter">'</span></span>
<span class="constant">TOKEN</span> = <span class="string"><span class="delimiter">'</span><span class="content">YOUR_TOKEN</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="constant">USERNAME</span>, <span class="constant">PASSWORD</span>) <span class="keyword">do</span> |client|
  <span class="comment"># Create LDM blueprint</span>
  blueprint = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.from_json(<span class="string"><span class="delimiter">'</span><span class="content">data/hr_manifest.json</span><span class="delimiter">'</span></span>)

  <span class="comment"># Create new project (datamart)</span>
  project = <span class="constant">GoodData</span>::<span class="constant">Project</span>.create_from_blueprint(blueprint, <span class="key">auth_token</span>: <span class="constant">TOKEN</span>)
  puts <span class="string"><span class="delimiter">&quot;</span><span class="content">Created project </span><span class="inline"><span class="inline-delimiter">#{</span>project.pid<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>

  data = [
    {
      <span class="key">data</span>: <span class="string"><span class="delimiter">'</span><span class="content">data/hr_departments.csv</span><span class="delimiter">'</span></span>,
      <span class="key">dataset</span>: <span class="string"><span class="delimiter">'</span><span class="content">dataset.department</span><span class="delimiter">'</span></span>,
    },
    {
      <span class="key">data</span>: <span class="string"><span class="delimiter">'</span><span class="content">data/hr_employees.csv</span><span class="delimiter">'</span></span>,
      <span class="key">dataset</span>: <span class="string"><span class="delimiter">'</span><span class="content">dataset.employee</span><span class="delimiter">'</span></span>
    },
    {
      <span class="key">data</span>: <span class="string"><span class="delimiter">'</span><span class="content">data/hr_salaries.csv</span><span class="delimiter">'</span></span>,
      <span class="key">dataset</span>: <span class="string"><span class="delimiter">'</span><span class="content">dataset.salary</span><span class="delimiter">'</span></span>,
      <span class="key">options</span>: {<span class="symbol">:mode</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">INCREMENTAL</span><span class="delimiter">'</span></span>}
    }
  ]
  res = project.upload_multiple(data, blueprint)

  puts <span class="constant">JSON</span>.pretty_generate(res)

  puts <span class="string"><span class="delimiter">'</span><span class="content">Done!</span><span class="delimiter">'</span></span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_loading_data_with_specific_date_format">Loading Data with Specific Date Format</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_74">Problem</h4>
<div class="paragraph">
<p>You need to upload dates but you have a nonstandard formatting</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_74">Solution</h4>
<div class="paragraph">
<p>You can specify a date loading format in your blueprint. If you do not specify any format then the default <em>MM/dd/yyyy</em> format is used</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  blueprint = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.build(<span class="string"><span class="delimiter">'</span><span class="content">Acme project</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |p|
    p.add_date_dimension(<span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>)

    p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.commits</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
      d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.commits.id</span><span class="delimiter">'</span></span>)
      d.add_fact(<span class="string"><span class="delimiter">'</span><span class="content">fact.commits.lines_changed</span><span class="delimiter">'</span></span>)
            d.add_attribute(<span class="string"><span class="delimiter">'</span><span class="content">attr.commits.name</span><span class="delimiter">'</span></span>)
      d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.commits.name</span><span class="delimiter">'</span></span>, <span class="key">reference</span>: <span class="string"><span class="delimiter">'</span><span class="content">attr.commits.name</span><span class="delimiter">'</span></span>)
      d.add_date(<span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>, <span class="symbol">:dataset</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>)
    <span class="keyword">end</span>
  <span class="keyword">end</span>

  project = client.create_project_from_blueprint(blueprint, <span class="key">auth_token</span>: <span class="string"><span class="delimiter">'</span><span class="content">token</span><span class="delimiter">'</span></span>)

  <span class="comment"># By default the dates are expected in format MM/dd/yyyy</span>
  data = [
    [<span class="string"><span class="delimiter">'</span><span class="content">fact.commits.lines_changed</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">label.commits.name</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>],
    [<span class="integer">1</span>, <span class="string"><span class="delimiter">'</span><span class="content">tomas</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">01/01/2001</span><span class="delimiter">'</span></span>],
    [<span class="integer">1</span>, <span class="string"><span class="delimiter">'</span><span class="content">petr</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">12/01/2001</span><span class="delimiter">'</span></span>],
    [<span class="integer">1</span>, <span class="string"><span class="delimiter">'</span><span class="content">jirka</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">12/24/2014</span><span class="delimiter">'</span></span>]]
  project.upload(data, blueprint, <span class="string"><span class="delimiter">'</span><span class="content">dataset.commits</span><span class="delimiter">'</span></span>)
  puts project.compute_report(<span class="key">top</span>: [project.facts.first.create_metric], <span class="key">left</span>: [<span class="string"><span class="delimiter">'</span><span class="content">committed_on.date</span><span class="delimiter">'</span></span>])
  <span class="comment"># prints</span>
  <span class="comment">#</span>
  <span class="comment"># [01/01/2001 | 3.0]</span>
  <span class="comment"># [12/01/2001 | 3.0]</span>
  <span class="comment"># [12/24/2014 | 3.0]</span>

  <span class="comment"># if you try to load a differen format it will fail</span>
  data = [[<span class="string"><span class="delimiter">'</span><span class="content">fact.commits.lines_changed</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">label.commits.name</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>],
          [<span class="integer">1</span>, <span class="string"><span class="delimiter">'</span><span class="content">tomas</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">2001-01-01</span><span class="delimiter">'</span></span>]]
  project.upload(data, blueprint, <span class="string"><span class="delimiter">'</span><span class="content">dataset.commits</span><span class="delimiter">'</span></span>)

  <span class="comment"># You can specify a different date format</span>
  blueprint = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.build(<span class="string"><span class="delimiter">'</span><span class="content">Acme project</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |p|
    p.add_date_dimension(<span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>)

    p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.commits</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
      d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.commits.id</span><span class="delimiter">'</span></span>)
      d.add_fact(<span class="string"><span class="delimiter">'</span><span class="content">fact.commits.lines_changed</span><span class="delimiter">'</span></span>)
            d.add_attribute(<span class="string"><span class="delimiter">'</span><span class="content">attr.commits.name</span><span class="delimiter">'</span></span>)
      d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.commits.name</span><span class="delimiter">'</span></span>, <span class="key">reference</span>: <span class="string"><span class="delimiter">'</span><span class="content">attr.commits.name</span><span class="delimiter">'</span></span>)
      d.add_date(<span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>, <span class="symbol">:dataset</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>, <span class="key">format</span>: <span class="string"><span class="delimiter">'</span><span class="content">yyyy-dd-MM</span><span class="delimiter">'</span></span>)
    <span class="keyword">end</span>
  <span class="keyword">end</span>

  data = [
    [<span class="string"><span class="delimiter">'</span><span class="content">fact.commits.lines_changed</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">label.commits.name</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>],
    [<span class="integer">3</span>, <span class="string"><span class="delimiter">'</span><span class="content">tomas</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">2001-01-01</span><span class="delimiter">'</span></span>],
    [<span class="integer">3</span>, <span class="string"><span class="delimiter">'</span><span class="content">petr</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">2001-01-12</span><span class="delimiter">'</span></span>],
    [<span class="integer">3</span>, <span class="string"><span class="delimiter">'</span><span class="content">jirka</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">2014-24-12</span><span class="delimiter">'</span></span>]]
  project.upload(data, blueprint, <span class="string"><span class="delimiter">'</span><span class="content">dataset.commits</span><span class="delimiter">'</span></span>)
  puts project.compute_report(<span class="key">top</span>: [project.facts.first.create_metric], <span class="key">left</span>: [<span class="string"><span class="delimiter">'</span><span class="content">committed_on.date</span><span class="delimiter">'</span></span>])
  <span class="comment"># prints</span>
  <span class="comment">#</span>
  <span class="comment"># [01/01/2001 | 3.0]</span>
  <span class="comment"># [12/01/2001 | 3.0]</span>
  <span class="comment"># [12/24/2014 | 3.0]</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note couple of things
We did not have to update the project to be able to load dates in a different format. Date format information is used only during the data upload and the model is unaffected. This is something to think about when you are inferring the blueprint from the model using <code>project.blueprint</code>. This information is not persisted in the project.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_adding_new_ldm_fields_to_project">Adding New LDM Fields to Project</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_75">Problem</h4>
<div class="paragraph">
<p>You would like to update a project with additional fields</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_75">Solution</h4>
<div class="paragraph">
<p>Blueprints are easy to create programmatically and even to merge them together. In this example we will create a simple blueprint with one dataset and then add an additional field into blueprint and update the model.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  blueprint = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.build(<span class="string"><span class="delimiter">'</span><span class="content">Acme project</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |p|
    p.add_date_dimension(<span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>)

    p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.commits</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
      d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.commits.id</span><span class="delimiter">'</span></span>)
      d.add_fact(<span class="string"><span class="delimiter">'</span><span class="content">fact.commits.lines_changed</span><span class="delimiter">'</span></span>)
            d.add_attribute(<span class="string"><span class="delimiter">'</span><span class="content">attr.commits.name</span><span class="delimiter">'</span></span>)
      d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.commits.name</span><span class="delimiter">'</span></span>, <span class="key">reference</span>: <span class="string"><span class="delimiter">'</span><span class="content">attr.commits.name</span><span class="delimiter">'</span></span>)
      d.add_date(<span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>, <span class="symbol">:dataset</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>)
    <span class="keyword">end</span>
  <span class="keyword">end</span>

  project = client.create_project_from_blueprint(blueprint, <span class="key">auth_token</span>: <span class="string"><span class="delimiter">'</span><span class="content">token</span><span class="delimiter">'</span></span>)

  update = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.build(<span class="string"><span class="delimiter">&quot;</span><span class="content">update</span><span class="delimiter">&quot;</span></span>) <span class="keyword">do</span> |p|
    p.add_dataset(<span class="string"><span class="delimiter">&quot;</span><span class="content">dataset.commits</span><span class="delimiter">&quot;</span></span>) <span class="keyword">do</span> |d|
      d.add_attribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">attr.commits.repo</span><span class="delimiter">&quot;</span></span>)
      d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.commits.repo</span><span class="delimiter">'</span></span>, <span class="key">reference</span>: <span class="string"><span class="delimiter">'</span><span class="content">attr.commits.repo</span><span class="delimiter">'</span></span>)
    <span class="keyword">end</span>
  <span class="keyword">end</span>

  <span class="comment"># update the model in the project</span>
  project.update_from_blueprint(blueprint.merge(update))

  <span class="comment"># now you can look at the model and verify there is new attribute present</span>
  project.attributes(<span class="string"><span class="delimiter">'</span><span class="content">attr.commits.repo</span><span class="delimiter">'</span></span>)
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_22">Discussion</h4>
<div class="paragraph">
<p>In the example above we have created a new model and updated it right away. This is not a typical situation however and there are couple of things that you need to be aware of.</p>
</div>
<div class="paragraph">
<p>It is more common that you would like to gradually update the model in an existing project as the new requirements arrive. For that to be possible you have to take the "old" blueprint from some place where it is persisted. We will show a basic way how to save a blueprint to a file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">BLUEPRINT_FILE</span> = <span class="string"><span class="delimiter">'</span><span class="content">blueprint_file.json</span><span class="delimiter">'</span></span>


<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    blueprint = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.from_json(<span class="constant">BLUEPRINT_FILE</span>)
    update = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.build(<span class="string"><span class="delimiter">'</span><span class="content">update</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |p|
      p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">repos</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
        d.add_attribute(<span class="string"><span class="delimiter">'</span><span class="content">region</span><span class="delimiter">'</span></span>)
      <span class="keyword">end</span>
    <span class="keyword">end</span>
    new_blueprint = blueprint.merge(update)
    <span class="keyword">unless</span> new_blueprint.valid?
            pp new_blueprint.validate
            fail <span class="string"><span class="delimiter">&quot;</span><span class="content">New blueprint is not valid</span><span class="delimiter">&quot;</span></span>
    <span class="keyword">end</span>
    project.update_from_blueprint(new_blueprint)
    <span class="comment"># now you can look at the model and verify there is new attribute present</span>
    project.attributes.find {|a| a.title == <span class="string"><span class="delimiter">'</span><span class="content">Region</span><span class="delimiter">'</span></span>}
    new_blueprint.store_to_file(<span class="constant">BLUEPRINT_FILE</span>)

  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_specifying_fields_data_type">Specifying Fields Data Type</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_76">Problem</h4>
<div class="paragraph">
<p>You would like to specify a different data type for attribute or fact in a blueprint</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_76">Solution</h4>
<div class="paragraph">
<p>Each column in blueprint is eventually translated into a physical column in a database. While the defaults are typically what you want sometimes it might be useful to override them. You can specify the data type with gd_data_type clause.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  blueprint = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.build(<span class="string"><span class="delimiter">'</span><span class="content">Acme project</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |p|
    p.add_date_dimension(<span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>)

    p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.commits</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
      d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.commits.id</span><span class="delimiter">'</span></span>)
      d.add_fact(<span class="string"><span class="delimiter">'</span><span class="content">fact.commtis.lines_changed</span><span class="delimiter">'</span></span>, <span class="key">gd_data_type</span>: <span class="string"><span class="delimiter">'</span><span class="content">integer</span><span class="delimiter">'</span></span>)
            d.add_attribute(<span class="string"><span class="delimiter">'</span><span class="content">attr.commits.name</span><span class="delimiter">'</span></span>)
      d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.commits.name</span><span class="delimiter">'</span></span>, <span class="key">reference</span>: <span class="string"><span class="delimiter">'</span><span class="content">attr.commits.name</span><span class="delimiter">'</span></span>)
      d.add_date(<span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>, <span class="symbol">:format</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">dd/MM/yyyy</span><span class="delimiter">'</span></span>)
    <span class="keyword">end</span>

    project = client.create_project_from_blueprint(blueprint, <span class="key">auth_token</span>: <span class="string"><span class="delimiter">'</span><span class="content">token</span><span class="delimiter">'</span></span>)

    <span class="comment"># This is going to fail since we are trying to upload 1.2 into INT numeric type</span>
    data = [[<span class="string"><span class="delimiter">'</span><span class="content">fact.commtis.lines_changed</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">label.commits.name</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>],
          [<span class="float">1.2</span>, <span class="string"><span class="delimiter">'</span><span class="content">tomas</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">01/01/2001</span><span class="delimiter">'</span></span>]]
    project.upload(data, blueprint, <span class="string"><span class="delimiter">'</span><span class="content">dataset.commits</span><span class="delimiter">'</span></span>)

    <span class="comment"># This is going to pass since we are trying to upload 1 into INT numeric type</span>
    data = [[<span class="string"><span class="delimiter">'</span><span class="content">fact.commtis.lines_changed</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">label.commits.name</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>],
          [<span class="integer">1</span>, <span class="string"><span class="delimiter">'</span><span class="content">tomas</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">01/01/2001</span><span class="delimiter">'</span></span>]]
    project.upload(data, blueprint, <span class="string"><span class="delimiter">'</span><span class="content">dataset.commits</span><span class="delimiter">'</span></span>)
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_23">Discussion</h4>
<div class="paragraph">
<p>These data types are currently supported on the platform</p>
</div>
<div class="ulist">
<ul>
<li>
<p>DECIMAL(m, d)</p>
</li>
<li>
<p>INTEGER</p>
</li>
<li>
<p>LONG</p>
</li>
<li>
<p>VARCHAR(n)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The case where this is very useful are</p>
</div>
<div class="ulist">
<ul>
<li>
<p>if you use values from smaller domain (for example integers) you can leverage appropriate data type to save space and speed things up</p>
</li>
<li>
<p>if you are using facts with atypical precision (the default is DECIMAL(12,2)) you can leverage decimal type with larger precision</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_working_with_folders">Working with Folders</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_77">Problem</h4>
<div class="paragraph">
<p>You would like to use folders for organizing your project&#8217;s model</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_77">Solution</h4>
<div class="paragraph">
<p>By default all the attributes and facts are automatically assigned a folder based on it&#8217;s dataset name. This name is either generated from the dataset&#8217;s name or title (if defined). You can override this default and specify your own folder for any field.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  blueprint = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.build(<span class="string"><span class="delimiter">&quot;</span><span class="content">my_blueprint</span><span class="delimiter">&quot;</span></span>) <span class="keyword">do</span> |p|
    p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.reps</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Awesome Sales Reps</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
      d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.reps.id</span><span class="delimiter">'</span></span>)
      d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.reps.id</span><span class="delimiter">'</span></span>, <span class="key">reference</span>: <span class="string"><span class="delimiter">'</span><span class="content">attr.reps.id</span><span class="delimiter">'</span></span>)
      d.add_attribute(<span class="string"><span class="delimiter">'</span><span class="content">attr.reps.name</span><span class="delimiter">'</span></span>)
      d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.reps.name</span><span class="delimiter">'</span></span>, <span class="key">reference</span>: <span class="string"><span class="delimiter">'</span><span class="content">attr.reps.name</span><span class="delimiter">'</span></span>)
    <span class="keyword">end</span>

    p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.regions</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
      d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.regions.id</span><span class="delimiter">'</span></span>)
      d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.regions.id</span><span class="delimiter">'</span></span>, <span class="key">reference</span>: <span class="string"><span class="delimiter">'</span><span class="content">attr.regions.id</span><span class="delimiter">'</span></span>)
      d.add_attribute(<span class="string"><span class="delimiter">'</span><span class="content">attr.regions.name</span><span class="delimiter">'</span></span>)
      d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.regions.name</span><span class="delimiter">'</span></span>, <span class="key">reference</span>: <span class="string"><span class="delimiter">'</span><span class="content">attr.regions.name</span><span class="delimiter">'</span></span>)
    <span class="keyword">end</span>

    p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.opportunities</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
      d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.opportunities.id</span><span class="delimiter">'</span></span>)
      d.add_fact(<span class="string"><span class="delimiter">'</span><span class="content">fact.amount</span><span class="delimiter">'</span></span>, <span class="key">folder</span>: <span class="string"><span class="delimiter">'</span><span class="content">My Special Folder</span><span class="delimiter">'</span></span>)
      d.add_reference(<span class="string"><span class="delimiter">'</span><span class="content">dataset.reps</span><span class="delimiter">'</span></span>)
      d.add_reference(<span class="string"><span class="delimiter">'</span><span class="content">dataset.regions</span><span class="delimiter">'</span></span>)
    <span class="keyword">end</span>
  <span class="keyword">end</span>

  project = client.create_project_from_blueprint(blueprint, <span class="key">auth_token</span>: <span class="string"><span class="delimiter">'</span><span class="content">token_id</span><span class="delimiter">'</span></span>)

  <span class="comment"># Currently there is not support in SDK to directly explore folders but we can reach to API directly</span>
  <span class="comment"># You can also go to the project in your browser and look for folders there</span>
  client.get(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span>project.md[<span class="string"><span class="delimiter">'</span><span class="content">query</span><span class="delimiter">'</span></span>]<span class="inline-delimiter">}</span></span><span class="content">/dimensions</span><span class="delimiter">&quot;</span></span>)[<span class="string"><span class="delimiter">'</span><span class="content">query</span><span class="delimiter">'</span></span>][<span class="string"><span class="delimiter">'</span><span class="content">entries</span><span class="delimiter">'</span></span>].map {|i| i[<span class="string"><span class="delimiter">'</span><span class="content">title</span><span class="delimiter">'</span></span>]} <span class="comment"># =&gt; [&quot;Dataset.Opportunities&quot;, &quot;Awesome Sales Reps&quot;, &quot;Dataset.Regions&quot;]</span>

  client.get(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span>project.md[<span class="string"><span class="delimiter">'</span><span class="content">query</span><span class="delimiter">'</span></span>]<span class="inline-delimiter">}</span></span><span class="content">/folders</span><span class="delimiter">&quot;</span></span>)[<span class="string"><span class="delimiter">'</span><span class="content">query</span><span class="delimiter">'</span></span>][<span class="string"><span class="delimiter">'</span><span class="content">entries</span><span class="delimiter">'</span></span>].map {|i| i[<span class="string"><span class="delimiter">'</span><span class="content">title</span><span class="delimiter">'</span></span>]} <span class="comment"># =&gt; [&quot;My Special Folder&quot;]</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_24">Discussion</h4>
<div class="paragraph">
<p>Folders are not removed. If you would publish a model that doesn&#8217;t contain an existing folder, the folder isn&#8217;t automatically removed (it is empty).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_project_in_one_page_of_code">Creating Project in One Page of Code</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_78">Problem</h4>
<div class="paragraph">
<p>You would like to create the whole project from code for whatever reason.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_18">Prerequisites</h4>
<div class="paragraph">
<p>You have a provisioning token for project creation</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_78">Solution</h4>
<div class="paragraph">
<p>What we will do is to create a simple project with 4 datasets. Load couple of line of data create a simple report and invite 2 other people to it. All this will fit on one page of code. Let&#8217;s get to it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
  blueprint = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.build(<span class="string"><span class="delimiter">'</span><span class="content">Acme project</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |p|
    p.add_date_dimension(<span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>)
    p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">devs</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
      d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">dev_id</span><span class="delimiter">'</span></span>)
      d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">email</span><span class="delimiter">'</span></span>, <span class="symbol">:reference</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">dev_id</span><span class="delimiter">'</span></span>)
    <span class="keyword">end</span>
    p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">commits</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
      d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">commits_id</span><span class="delimiter">'</span></span>)
      d.add_fact(<span class="string"><span class="delimiter">'</span><span class="content">lines_changed</span><span class="delimiter">'</span></span>)
      d.add_date(<span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>, <span class="symbol">:dataset</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>)
      d.add_reference(<span class="string"><span class="delimiter">'</span><span class="content">dev_id</span><span class="delimiter">'</span></span>, <span class="symbol">:dataset</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">devs</span><span class="delimiter">'</span></span>)
    <span class="keyword">end</span>
  <span class="keyword">end</span>
  project = <span class="constant">GoodData</span>::<span class="constant">Project</span>.create_from_blueprint(blueprint, <span class="key">auth_token</span>: <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>)
  puts <span class="string"><span class="delimiter">&quot;</span><span class="content">Created project </span><span class="inline"><span class="inline-delimiter">#{</span>project.pid<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
  <span class="constant">GoodData</span>::with_project(project) <span class="keyword">do</span> |p|
    <span class="comment"># Load data</span>
    commits_data = [
      <span class="string"><span class="delimiter">%w(</span><span class="content">lines_changed committed_on dev_id</span><span class="delimiter">)</span></span>,
      [<span class="integer">1</span>, <span class="string"><span class="delimiter">'</span><span class="content">01/01/2014</span><span class="delimiter">'</span></span>, <span class="integer">1</span>],
      [<span class="integer">3</span>, <span class="string"><span class="delimiter">'</span><span class="content">01/02/2014</span><span class="delimiter">'</span></span>, <span class="integer">2</span>],
      [<span class="integer">5</span>, <span class="string"><span class="delimiter">'</span><span class="content">05/02/2014</span><span class="delimiter">'</span></span>, <span class="integer">3</span>]]
    <span class="constant">GoodData</span>::<span class="constant">Model</span>.upload_data(commits_data, blueprint, <span class="string"><span class="delimiter">'</span><span class="content">commits</span><span class="delimiter">'</span></span>)
    devs_data = [
      [<span class="string"><span class="delimiter">&quot;</span><span class="content">dev_id</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">email</span><span class="delimiter">&quot;</span></span>],
      [<span class="integer">1</span>, <span class="string"><span class="delimiter">'</span><span class="content">tomas@gooddata.com</span><span class="delimiter">'</span></span>],
      [<span class="integer">2</span>, <span class="string"><span class="delimiter">'</span><span class="content">petr@gooddata.com</span><span class="delimiter">'</span></span>],
      [<span class="integer">3</span>, <span class="string"><span class="delimiter">'</span><span class="content">jirka@gooddata.com</span><span class="delimiter">'</span></span>]]
    <span class="constant">GoodData</span>::<span class="constant">Model</span>.upload_data(devs_data, blueprint, <span class="string"><span class="delimiter">'</span><span class="content">devs</span><span class="delimiter">'</span></span>)
    <span class="comment"># create a metric</span>
    metric = p.facts(<span class="string"><span class="delimiter">'</span><span class="content">fact.commits.lines_changed</span><span class="delimiter">'</span></span>).create_metric
    metric.save
    report = p.create_report(<span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Awesome_report</span><span class="delimiter">'</span></span>, <span class="key">top</span>: [metric], <span class="key">left</span>: [<span class="string"><span class="delimiter">'</span><span class="content">label.devs.dev_id.email</span><span class="delimiter">'</span></span>])
    report.save
    [<span class="string"><span class="delimiter">'</span><span class="content">john@example.com</span><span class="delimiter">'</span></span>].each <span class="keyword">do</span> |email|
      p.invite(email, <span class="string"><span class="delimiter">'</span><span class="content">admin</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Guys checkout this report </span><span class="inline"><span class="inline-delimiter">#{</span>report.browser_uri<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)
    <span class="keyword">end</span>
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_attribute_types_when_creating_project">Using Attribute Types when Creating Project</h3>
<div class="paragraph">
<p>by Tomas Korcak</p>
</div>
<div class="sect3">
<h4 id="_problem_79">Problem</h4>
<div class="paragraph">
<p>You want to specify certain label&#8217;s data type see <a href="http://developer.gooddata.com/article/setting-up-data-for-geo-charts">this document</a> for more details.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_19">Prerequisites</h4>
<div class="paragraph">
<p>You have a provisioning token for project creation.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_79">Solution</h4>
<div class="paragraph">
<p>We&#8217;ll create a simple project&#8217;s blueprint that contains a label with the 'GDC.link' (hyperlink) datatype in the code snippet below.</p>
</div>
<div class="ulist">
<div class="title">Common Types</div>
<ul>
<li>
<p>GDC.link</p>
</li>
<li>
<p>GDC.text</p>
</li>
<li>
<p>GDC.time</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Types for Geo</div>
<ul>
<li>
<p>GDC.geo.pin                 <em>(Geo pushpin)</em></p>
</li>
<li>
<p>GDC.geo.ausstates.name      <em>(Australia States (Name))</em></p>
</li>
<li>
<p>GDC.geo.ausstates.code      <em>(Australia States (ISO code))</em></p>
</li>
<li>
<p>GDC.geo.usstates.name       <em>(US States (Name))</em></p>
</li>
<li>
<p>GDC.geo.usstates.geo_id     <em>(US States (US Census ID))</em></p>
</li>
<li>
<p>GDC.geo.usstates.code       <em>(US States (2-letter code))</em></p>
</li>
<li>
<p>GDC.geo.uscounties.geo_id   <em>(US Counties (US Census ID))</em></p>
</li>
<li>
<p>GDC.geo.worldcountries.name <em>(World countries (Name))</em></p>
</li>
<li>
<p>GDC.geo.worldcountries.iso2 <em>(World countries (ISO a2))</em></p>
</li>
<li>
<p>GDC.geo.worldcountries.iso3 <em>(World countries (ISO a3))</em></p>
</li>
<li>
<p>GDC.geo.czdistricts.name    <em>(Czech Districts (Name))</em></p>
</li>
<li>
<p>GDC.geo.czdistricts.name_no_diacritics <em>(Czech Districts)</em></p>
</li>
<li>
<p>GDC.geo.czdistricts.nuts4   <em>(Czech Districts (NUTS 4))</em></p>
</li>
<li>
<p>GDC.geo.czdistricts.knok    <em>(Czech Districts (KNOK))</em></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  blueprint = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.build(<span class="string"><span class="delimiter">'</span><span class="content">Beers Project</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |p|
    p.add_date_dimension(<span class="string"><span class="delimiter">'</span><span class="content">created_at</span><span class="delimiter">'</span></span>)

    <span class="comment"># Add Breweries Dataset</span>
    p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.breweries</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Breweries</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
      d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.breweries.brewery_id</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Brewery ID</span><span class="delimiter">'</span></span>)
      d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.breweries.brewery_id.brewery_id</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Brewery ID</span><span class="delimiter">'</span></span>, <span class="symbol">:reference</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">attr.breweries.brewery_id</span><span class="delimiter">'</span></span>)
      d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.breweries.brewery_id.name</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Brewery Name</span><span class="delimiter">'</span></span>, <span class="symbol">:reference</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">attr.breweries.brewery_id</span><span class="delimiter">'</span></span>)
      d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.breweries.brewery_id.link</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Brewery URL</span><span class="delimiter">'</span></span>, <span class="symbol">:reference</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">attr.breweries.brewery_id</span><span class="delimiter">'</span></span>, <span class="symbol">:gd_type</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">GDC.link</span><span class="delimiter">'</span></span>) <span class="comment"># &lt;--- Notice this!</span>
      d.add_date(<span class="string"><span class="delimiter">'</span><span class="content">created_at</span><span class="delimiter">'</span></span>, <span class="symbol">:dataset</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">created_at</span><span class="delimiter">'</span></span>)
    <span class="keyword">end</span>
  <span class="keyword">end</span>

  project = <span class="constant">GoodData</span>::<span class="constant">Project</span>.create_from_blueprint(blueprint, <span class="key">auth_token</span>: <span class="string"><span class="delimiter">'</span><span class="content">YOUR_TOKEN_HERE</span><span class="delimiter">'</span></span>)
  puts <span class="string"><span class="delimiter">&quot;</span><span class="content">Created project </span><span class="inline"><span class="inline-delimiter">#{</span>project.pid<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>

  <span class="constant">GoodData</span>::with_project(project) <span class="keyword">do</span> |p|
    <span class="comment"># Load Brewery Data</span>
    data = [
      <span class="string"><span class="delimiter">%w(</span><span class="content">label.breweries.brewery_id.brewery_id label.breweries.brewery_id.name label.breweries.brewery_id.link created_at</span><span class="delimiter">)</span></span>,
      [<span class="integer">1</span>, <span class="string"><span class="delimiter">'</span><span class="content">21st Amendment Brewery</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">http://21st-amendment.com/</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">06/23/2015</span><span class="delimiter">'</span></span>],
      [<span class="integer">2</span>, <span class="string"><span class="delimiter">'</span><span class="content">Almanac Beer Company</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">http://www.almanacbeer.com/</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">06/23/2015</span><span class="delimiter">'</span></span>],
      [<span class="integer">3</span>, <span class="string"><span class="delimiter">'</span><span class="content">Anchor Brewing Company</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">http://www.anchorbrewing.com/</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">06/23/2015</span><span class="delimiter">'</span></span>],
      [<span class="integer">4</span>, <span class="string"><span class="delimiter">'</span><span class="content">Ballast Point Brewing Company</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">http://www.ballastpoint.com/</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">06/23/2015</span><span class="delimiter">'</span></span>],
      [<span class="integer">5</span>, <span class="string"><span class="delimiter">'</span><span class="content">San Francisco Brewing Company</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">http://www.ballastpoint.com/</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">06/23/2015</span><span class="delimiter">'</span></span>],
      [<span class="integer">6</span>, <span class="string"><span class="delimiter">'</span><span class="content">Speakeasy Ales and Lagers</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">http://www.goodbeer.com/</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">06/23/2015</span><span class="delimiter">'</span></span>]
    ]
    <span class="constant">GoodData</span>::<span class="constant">Model</span>.upload_data(data, blueprint, <span class="string"><span class="delimiter">'</span><span class="content">dataset.breweries</span><span class="delimiter">'</span></span>)
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_moving_fields_in_blueprint">Moving fields in blueprint</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_80">Problem</h4>
<div class="paragraph">
<p>I created a model and now found out that I would like to move a field to different dataset.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_80">Solution</h4>
<div class="paragraph">
<p>We will use variation of our hr demo model. If you look at that model you can see that we have an attribute <strong>region</strong> defined on departments dataset. This is how you (hypothetically) originally created the project and everything was fine but you realized that you would like to assign the region to people dataset not departments dataset.</p>
</div>
<div class="paragraph">
<p>Before we start changing things spin up the project go inside the project and create a report which show <strong>SUM(Amount)</strong> sliced by <strong>Region</strong>.</p>
</div>
<div class="paragraph">
<p>Now let&#8217;s move the attribute between datasets.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">client = <span class="constant">GoodData</span>.connect
project = client.projects(<span class="string"><span class="delimiter">'</span><span class="content">PROJECT_ID</span><span class="delimiter">'</span></span>)

blueprint = project.blueprint
blueprint.move!(<span class="string"><span class="delimiter">'</span><span class="content">attr.department.region</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">dataset.department</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">dataset.employee</span><span class="delimiter">'</span></span>)
project.update_from_blueprint(blueprint)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Since we moved the attribute we have to load new data for it in the context of new dataset. The old dataset (departments) is fine since we just removed a column.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">employee_data_with_dep = [
    [<span class="string"><span class="delimiter">'</span><span class="content">label.employee.id</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">label.employee.fname</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">label.employee.lname</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">dataset.department</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">label.department.region</span><span class="delimiter">'</span></span>],
    [<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">Sheri</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">Nowmer</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">d1</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">North America</span><span class="delimiter">'</span></span>],
    [<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">Derrick</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">Whelply</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">d2</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Europe</span><span class="delimiter">'</span></span>]
]
project.upload(employee_data_with_dep, blueprint, <span class="string"><span class="delimiter">'</span><span class="content">dataset.employee</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now go ahead and check the original report. Yes, it is still working fine. It gives different numbers since we changed the meaning of it but we did not break anything.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_working_with_hr_demo_project">Working with HR Demo project</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_81">Problem</h4>
<div class="paragraph">
<p>I would like to play with blueprints but I cannot come up with some data and model of a ptoy project. Can you give me any?</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_81">Solution</h4>
<div class="paragraph">
<p>Yes. Use our HR example which models a small company and people inside it. We tried to use majority of the features that the blueprint builder supports so you can take it as a starting point when you are creating yours.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="comment"># Connect to platform (using credentials in ~/.gooddata)</span>
<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|

  <span class="comment"># Create LDM blueprint</span>
  blueprint = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.build(<span class="string"><span class="delimiter">'</span><span class="content">HR Demo Project</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |p|
    p.add_date_dimension(<span class="string"><span class="delimiter">'</span><span class="content">dataset.payment</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Payment</span><span class="delimiter">'</span></span>)

    p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.department</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Department</span><span class="delimiter">'</span></span>, <span class="key">folder</span>: <span class="string"><span class="delimiter">'</span><span class="content">Department &amp; Employee</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
      d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.department.id</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Department ID</span><span class="delimiter">'</span></span>)
      d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.department.id</span><span class="delimiter">'</span></span>, <span class="key">reference</span>:<span class="string"><span class="delimiter">'</span><span class="content">attr.department.id</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Department ID</span><span class="delimiter">'</span></span>)
      d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.department.name</span><span class="delimiter">'</span></span>, <span class="key">reference</span>: <span class="string"><span class="delimiter">'</span><span class="content">attr.department.id</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Department Name</span><span class="delimiter">'</span></span>)
      d.add_attribute(<span class="string"><span class="delimiter">'</span><span class="content">attr.department.region</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Department Region</span><span class="delimiter">'</span></span>)
      d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.department.region</span><span class="delimiter">'</span></span>, <span class="key">reference</span>: <span class="string"><span class="delimiter">'</span><span class="content">attr.department.region</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Department Region</span><span class="delimiter">'</span></span>)
    <span class="keyword">end</span>

    p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.employee</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Employee</span><span class="delimiter">'</span></span>, <span class="key">folder</span>: <span class="string"><span class="delimiter">'</span><span class="content">Department &amp; Employee</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
      d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.employee.id</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Employee ID</span><span class="delimiter">'</span></span>)
      d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.employee.id</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Employee ID</span><span class="delimiter">'</span></span>, <span class="key">reference</span>:<span class="string"><span class="delimiter">'</span><span class="content">attr.employee.id</span><span class="delimiter">'</span></span>)
      d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.employee.fname</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Employee Firstname</span><span class="delimiter">'</span></span>, <span class="key">reference</span>:<span class="string"><span class="delimiter">'</span><span class="content">attr.employee.id</span><span class="delimiter">'</span></span>)
      d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.employee.lname</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Employee Lastname</span><span class="delimiter">'</span></span>, <span class="key">reference</span>:<span class="string"><span class="delimiter">'</span><span class="content">attr.employee.id</span><span class="delimiter">'</span></span>)
      d.add_reference(<span class="string"><span class="delimiter">'</span><span class="content">dataset.department</span><span class="delimiter">'</span></span>)
    <span class="keyword">end</span>

    p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.salary</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Salary</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
      d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.salary.id</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Salary ID</span><span class="delimiter">'</span></span>, <span class="key">folder</span>: <span class="string"><span class="delimiter">'</span><span class="content">Salary</span><span class="delimiter">'</span></span>)
      d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.salary.id</span><span class="delimiter">'</span></span>, <span class="key">reference</span>:<span class="string"><span class="delimiter">'</span><span class="content">attr.salary.id</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Salary ID</span><span class="delimiter">'</span></span>, <span class="key">folder</span>: <span class="string"><span class="delimiter">'</span><span class="content">Salary</span><span class="delimiter">'</span></span>)
      d.add_fact(<span class="string"><span class="delimiter">'</span><span class="content">fact.salary.amount</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Amount</span><span class="delimiter">'</span></span>, <span class="key">folder</span>: <span class="string"><span class="delimiter">'</span><span class="content">Salary</span><span class="delimiter">'</span></span>)
      d.add_date(<span class="string"><span class="delimiter">'</span><span class="content">dataset.payment</span><span class="delimiter">'</span></span>, <span class="key">format</span>: <span class="string"><span class="delimiter">'</span><span class="content">yyyy-MM-dd</span><span class="delimiter">'</span></span>)
      d.add_reference(<span class="string"><span class="delimiter">'</span><span class="content">dataset.employee</span><span class="delimiter">'</span></span>)
    <span class="keyword">end</span>
  <span class="keyword">end</span>

  <span class="comment"># Create new project (datamart)</span>
  project = <span class="constant">GoodData</span>::<span class="constant">Project</span>.create_from_blueprint(blueprint, <span class="key">auth_token</span>: token)
  puts <span class="string"><span class="delimiter">&quot;</span><span class="content">Created project </span><span class="inline"><span class="inline-delimiter">#{</span>project.pid<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>

  <span class="comment"># Load data</span>
  department_data = [
      [<span class="string"><span class="delimiter">'</span><span class="content">label.department.id</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">label.department.name</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">label.department.region</span><span class="delimiter">'</span></span>],
      [<span class="string"><span class="delimiter">'</span><span class="content">d1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">HQ General Management</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">North America</span><span class="delimiter">'</span></span>],
      [<span class="string"><span class="delimiter">'</span><span class="content">d2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">HQ Information Systems</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Europe</span><span class="delimiter">'</span></span>]
  ]
  project.upload(department_data, blueprint, <span class="string"><span class="delimiter">'</span><span class="content">dataset.department</span><span class="delimiter">'</span></span>)

  employee_data = [
      [<span class="string"><span class="delimiter">'</span><span class="content">label.employee.id</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">label.employee.fname</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">label.employee.lname</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">dataset.department</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">label.department.region</span><span class="delimiter">'</span></span>],
      [<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">Sheri</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">Nowmer</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">d1</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">North America</span><span class="delimiter">'</span></span>],
      [<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">Derrick</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">Whelply</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">d2</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Europe</span><span class="delimiter">'</span></span>]
  ]
  project.upload(employee_data, blueprint, <span class="string"><span class="delimiter">'</span><span class="content">dataset.employee</span><span class="delimiter">'</span></span>)

  employee_data_with_dep = [
      [<span class="string"><span class="delimiter">'</span><span class="content">label.employee.id</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">label.employee.fname</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">label.employee.lname</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">dataset.department</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">label.department.region</span><span class="delimiter">'</span></span>],
      [<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">Sheri</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">Nowmer</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">d1</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">North America</span><span class="delimiter">'</span></span>],
      [<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">Derrick</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">Whelply</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">d2</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Europe</span><span class="delimiter">'</span></span>]
  ]
  project.upload(employee_data_with_dep, blueprint, <span class="string"><span class="delimiter">'</span><span class="content">dataset.employee</span><span class="delimiter">'</span></span>)



  salary_data = [
      [<span class="string"><span class="delimiter">'</span><span class="content">label.salary.id</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">dataset.employee</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">fact.salary.amount</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">dataset.payment</span><span class="delimiter">'</span></span>],
      [<span class="string"><span class="delimiter">'</span><span class="content">s1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">10230</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2006-01-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">4810</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2006-01-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s617</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">10230</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2006-02-01</span><span class="delimiter">'</span></span>],
      [<span class="string"><span class="delimiter">'</span><span class="content">s618</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">4810</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2006-02-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s1233</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">10230</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2006-03-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s1234</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">4810</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2006-03-01</span><span class="delimiter">'</span></span>],
      [<span class="string"><span class="delimiter">'</span><span class="content">s1849</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">10230</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2006-04-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s1850</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">4810</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2006-04-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s2465</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">10230</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2006-05-01</span><span class="delimiter">'</span></span>],
      [<span class="string"><span class="delimiter">'</span><span class="content">s2466</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">4810</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2006-05-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s3081</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">10230</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2006-06-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s3082</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">4810</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2006-06-01</span><span class="delimiter">'</span></span>],
      [<span class="string"><span class="delimiter">'</span><span class="content">s3697</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">10230</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2006-07-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s3698</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">4810</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2006-07-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s4313</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">10230</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2006-08-01</span><span class="delimiter">'</span></span>],
      [<span class="string"><span class="delimiter">'</span><span class="content">s4314</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">4810</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2006-08-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s4929</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">10230</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2006-09-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s4930</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">4810</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2006-09-01</span><span class="delimiter">'</span></span>],
      [<span class="string"><span class="delimiter">'</span><span class="content">s5545</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">10230</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2006-10-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s5546</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">4810</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2006-10-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s6161</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">10230</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2006-11-01</span><span class="delimiter">'</span></span>],
      [<span class="string"><span class="delimiter">'</span><span class="content">s6162</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">4810</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2006-11-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s6777</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">10230</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2006-12-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s6778</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">4810</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2006-12-01</span><span class="delimiter">'</span></span>],
      [<span class="string"><span class="delimiter">'</span><span class="content">s7393</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">10440</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2007-01-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s7394</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">5020</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2007-01-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s8548</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">10440</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2007-02-01</span><span class="delimiter">'</span></span>],
      [<span class="string"><span class="delimiter">'</span><span class="content">s8549</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">5020</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2007-02-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s9703</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">10440</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2007-03-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s9704</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">5020</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2007-03-01</span><span class="delimiter">'</span></span>],
      [<span class="string"><span class="delimiter">'</span><span class="content">s10858</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">10440</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2007-04-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s10859</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">5020</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2007-04-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s12013</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">10440</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2007-05-01</span><span class="delimiter">'</span></span>],
      [<span class="string"><span class="delimiter">'</span><span class="content">s12014</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">5020</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2007-05-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s13168</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">10440</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2007-06-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s13169</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">5020</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2007-06-01</span><span class="delimiter">'</span></span>],
      [<span class="string"><span class="delimiter">'</span><span class="content">s14323</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">10440</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2007-07-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s14324</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">5020</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2007-07-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s15478</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">10440</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2007-08-01</span><span class="delimiter">'</span></span>],
      [<span class="string"><span class="delimiter">'</span><span class="content">s15479</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">5020</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2007-08-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s16633</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">10440</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2007-09-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s16634</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">5020</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2007-09-01</span><span class="delimiter">'</span></span>],
      [<span class="string"><span class="delimiter">'</span><span class="content">s17788</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">10440</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2007-10-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s17789</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">5020</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2007-10-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s18943</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">10440</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2007-11-01</span><span class="delimiter">'</span></span>],
      [<span class="string"><span class="delimiter">'</span><span class="content">s18944</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">5020</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2007-11-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s20098</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e1</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">10440</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2007-12-01</span><span class="delimiter">'</span></span>], [<span class="string"><span class="delimiter">'</span><span class="content">s20099</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">e2</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">5020</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">2007-12-01</span><span class="delimiter">'</span></span>]
  ]
  project.upload(salary_data, blueprint, <span class="string"><span class="delimiter">'</span><span class="content">dataset.salary</span><span class="delimiter">'</span></span>)
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_refactoring_datasets">Refactoring datasets</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_82">Problem</h4>
<div class="paragraph">
<p>You created a quick protoype but you found out that it needs some touch ups.</p>
</div>
</div>
<div class="sect3">
<h4 id="_notes_2">Notes</h4>
<div class="paragraph">
<p>This is work in progress.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_82">Solution</h4>
<div class="paragraph">
<p>Use SDK refactoring features.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s have a look at two hypothetical but very common scenarios that you probably encountered in during career.</p>
</div>
<div class="sect4">
<h5 id="__one_dataset_problem">"One Dataset problem"</h5>
<div class="paragraph">
<p>Lets' say you have model like this</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">blueprint = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.build(<span class="string"><span class="delimiter">'</span><span class="content">Not so great project</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |p|
  p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.reps</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Sale Reps</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
    d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.reps.id</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Sales Rep</span><span class="delimiter">'</span></span>)
    d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.reps.id</span><span class="delimiter">'</span></span>, <span class="key">reference</span>: <span class="string"><span class="delimiter">'</span><span class="content">attr.reps.id</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Sales Rep Name</span><span class="delimiter">'</span></span>)
  <span class="keyword">end</span>

  p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.regions</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Sale Reps</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
    d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.regions.id</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Sales Region</span><span class="delimiter">'</span></span>)
    d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.regions.id</span><span class="delimiter">'</span></span>, <span class="key">reference</span>: <span class="string"><span class="delimiter">'</span><span class="content">attr.regions.id</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Sales Rep Name</span><span class="delimiter">'</span></span>)
  <span class="keyword">end</span>

  p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.sales</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Department</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
    d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.sales.id</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Sale Id</span><span class="delimiter">'</span></span>)
    d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.sales.id</span><span class="delimiter">'</span></span>, <span class="key">reference</span>: <span class="string"><span class="delimiter">'</span><span class="content">attr.sales.id</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Sales tracking number</span><span class="delimiter">'</span></span>)
    d.add_fact(<span class="string"><span class="delimiter">'</span><span class="content">fact.sales.amount</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Amount</span><span class="delimiter">'</span></span>)
    d.add_attribute(<span class="string"><span class="delimiter">'</span><span class="content">attr.sales.stage</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Stage</span><span class="delimiter">'</span></span>)
    d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.sales.stage</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Stage Name</span><span class="delimiter">'</span></span>, <span class="key">reference</span>:<span class="string"><span class="delimiter">'</span><span class="content">attr.sales.stage</span><span class="delimiter">'</span></span>)
    d.add_reference(<span class="string"><span class="delimiter">'</span><span class="content">dataset.regions</span><span class="delimiter">'</span></span>)
    d.add_reference(<span class="string"><span class="delimiter">'</span><span class="content">dataset.reps</span><span class="delimiter">'</span></span>)
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>There is one problem. We should definitely extract the attribute from 'dataset.sales' dataset somewhere else. Also the anchor for this dataset has a label. Unless we do not have specific reason for it we should extract it somewhere else.</p>
</div>
<div class="paragraph">
<p>We can try to ask SDK to help us</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">refactored_blueprint = blueprint.refactor_split_df(<span class="string"><span class="delimiter">'</span><span class="content">dataset.sales</span><span class="delimiter">'</span></span>)

<span class="comment"># Let's have a look around</span>
refactored_blueprint.datasets.map(&amp;<span class="symbol">:title</span>)

refactored_blueprint.datasets.map {|d| [d.title, d.id]}
=&gt; [[<span class="string"><span class="delimiter">&quot;</span><span class="content">Sale Reps</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">dataset.reps</span><span class="delimiter">&quot;</span></span>],
    [<span class="string"><span class="delimiter">&quot;</span><span class="content">Sale Reps</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">dataset.regions</span><span class="delimiter">&quot;</span></span>],
    [<span class="string"><span class="delimiter">&quot;</span><span class="content">Department</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">dataset.sales</span><span class="delimiter">&quot;</span></span>],
    [<span class="string"><span class="delimiter">&quot;</span><span class="content">Dataset.Sales Dim</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">dataset.sales_dim</span><span class="delimiter">&quot;</span></span>]]

<span class="comment"># So there is a new dataset</span>
<span class="comment"># If we print it out in repl</span>
refactored_blueprint.datasets(<span class="string"><span class="delimiter">'</span><span class="content">dataset.sales_dim</span><span class="delimiter">'</span></span>)
<span class="comment"># prints</span>
<span class="comment">#</span>
<span class="comment"># {</span>
<span class="comment">#   :type=&gt;:dataset,</span>
<span class="comment">#   :id=&gt;&quot;dataset.sales_dim&quot;,</span>
<span class="comment">#   :columns=&gt;</span>
<span class="comment">#    [{:type=&gt;:anchor, :id=&gt;&quot;vymysli_id&quot;},</span>
<span class="comment">#     {:type=&gt;:label, :id=&gt;&quot;label.vymysli_id&quot;, :reference=&gt;&quot;vymysli_id&quot;},</span>
<span class="comment">#     {:type=&gt;:attribute, :id=&gt;&quot;attr.sales.stage&quot;, :title=&gt;&quot;Stage&quot;},</span>
<span class="comment">#     {:type=&gt;:label,</span>
<span class="comment">#      :id=&gt;&quot;label.sales.stage&quot;,</span>
<span class="comment">#      :title=&gt;&quot;Stage Name&quot;,</span>
<span class="comment">#      :reference=&gt;&quot;attr.sales.stage&quot;}]}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can see that there is stage attribute right there. And it prepared an anchor for us. The naming definitely needs touch ups (User should be able to specify the ids somehow) but the structure is there. Now let&#8217;s have a look what happened to sales dataset</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">refactored_blueprint.datasets(<span class="string"><span class="delimiter">'</span><span class="content">dataset.sales</span><span class="delimiter">'</span></span>)
<span class="comment"># prints</span>
<span class="comment">#</span>
<span class="comment"># {:id=&gt;&quot;dataset.sales&quot;,</span>
<span class="comment">#    :type=&gt;:dataset,</span>
<span class="comment">#    :columns=&gt;</span>
<span class="comment">#     [{:type=&gt;:anchor, :id=&gt;&quot;attr.sales.id&quot;, :title=&gt;&quot;Sale Id&quot;},</span>
<span class="comment">#      {:type=&gt;:label,</span>
<span class="comment">#       :id=&gt;&quot;label.sales.id&quot;,</span>
<span class="comment">#       :reference=&gt;&quot;attr.sales.id&quot;,</span>
<span class="comment">#       :title=&gt;&quot;Sales tracking number&quot;},</span>
<span class="comment">#      {:type=&gt;:fact, :id=&gt;&quot;fact.sales.amount&quot;, :title=&gt;&quot;Amount&quot;},</span>
<span class="comment">#      {:type=&gt;:reference, :dataset=&gt;&quot;dataset.regions&quot;},</span>
<span class="comment">#      {:type=&gt;:reference, :dataset=&gt;&quot;dataset.reps&quot;},</span>
<span class="comment">#      {:type=&gt;:reference, :dataset=&gt;&quot;dataset.sales_dim&quot;}]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can see that the attribute is gone with labels. Only facts remained. New reference was added so the reports should still be working. This might seems just like a minor thing but once you start creating more complex models with multiple stars you find this techique a necessity so why not automate it.</p>
</div>
</div>
<div class="sect4">
<h5 id="_multiple_facts_in_one_dataset">Multiple facts in one dataset</h5>
<div class="paragraph">
<p>Another problem we will look at is splitting fact tables because of facts. Conside this model</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">blueprint = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.build(<span class="string"><span class="delimiter">'</span><span class="content">Not so great project</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |p|

  p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.orders_dim</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Orders Dimension</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
    d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.orders_dim.id</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Order</span><span class="delimiter">'</span></span>)
    d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">label.dataset.orders_dim.id</span><span class="delimiter">'</span></span>, <span class="key">reference</span>: <span class="string"><span class="delimiter">'</span><span class="content">attr.orders_dim.id</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Order Id</span><span class="delimiter">'</span></span>)
  <span class="keyword">end</span>

  p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">dataset.orders_fact</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Orders Fact Table</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
    d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">attr.orders_fact.id</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Sales Rep</span><span class="delimiter">'</span></span>)
    d.add_fact(<span class="string"><span class="delimiter">'</span><span class="content">fact.dataset.orders_fact.amount_ordered</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Amount Ordered</span><span class="delimiter">'</span></span>)
    d.add_fact(<span class="string"><span class="delimiter">'</span><span class="content">fact.dataset.orders_fact.amount_shipped</span><span class="delimiter">'</span></span>, <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Amount Shipped</span><span class="delimiter">'</span></span>)
    d.add_reference(<span class="string"><span class="delimiter">'</span><span class="content">dataset.orders_dim</span><span class="delimiter">'</span></span>)
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>What you want to do is have a look at how many shipments were ordered and shipped on particular day. But if you keep the facts in one dataset you will have all kinds of trouble with nil values. Much better is to split the fact tables in two. Again we can try doing that with SDK</p>
</div>
<div class="paragraph">
<p>Note: it seems it currently does not work with date references. We need to update that so I ommitted it in the example so it works</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># you define which dataset you would like to split. Secnd parameter is list of facts you would like to move and the last one is the id of the new dataset</span>
refactored_blueprint = blueprint.refactor_split_facts(<span class="string"><span class="delimiter">'</span><span class="content">dataset.orders_fact</span><span class="delimiter">'</span></span>, [<span class="string"><span class="delimiter">'</span><span class="content">fact.dataset.orders_fact.amount_shipped</span><span class="delimiter">'</span></span>], <span class="string"><span class="delimiter">'</span><span class="content">dataset.orders_shipped_fact</span><span class="delimiter">'</span></span>)

<span class="comment"># Again Let's explore</span>
refactored_blueprint.datasets.count <span class="comment"># =&gt; 3</span>

refactored_blueprint.datasets.map {|d| [d.title, d.id]}
<span class="comment"># =&gt; [[&quot;Orders Dimension&quot;, &quot;dataset.orders_dim&quot;],</span>
<span class="comment">#     [&quot;Orders Fact Table&quot;, &quot;dataset.orders_fact&quot;],</span>
<span class="comment">#     [&quot;Dataset.Orders Shipped Fact&quot;, &quot;dataset.orders_shipped_fact&quot;]]</span>

<span class="comment"># There is a new dataset &quot;dataset.orders_shipped_fact&quot;</span>
refactored_blueprint.datasets(<span class="string"><span class="delimiter">'</span><span class="content">dataset.orders_shipped_fact</span><span class="delimiter">'</span></span>)
<span class="comment"># prints</span>
<span class="comment">#</span>
<span class="comment"># {</span>
<span class="comment">#   :id=&gt;&quot;dataset.orders_shipped_fact&quot;,</span>
<span class="comment">#   :type=&gt;:dataset,</span>
<span class="comment">#   :columns=&gt; [</span>
<span class="comment">#     {:type=&gt;:anchor, :id=&gt;&quot;dataset.orders_shipped_fact.id&quot;},</span>
<span class="comment">#     {:type=&gt;:fact,</span>
<span class="comment">#      :id=&gt;&quot;fact.dataset.orders_fact.amount_shipped&quot;,</span>
<span class="comment">#      :title=&gt;&quot;Amount Shipped&quot;},</span>
<span class="comment">#     {:type=&gt;:reference, :dataset=&gt;&quot;dataset.orders_dim&quot;}]}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>These are 2 basic ways how to refactor a blueprint in an assisted and automated fashion.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2015-09-17 11:21:24 +02:00
</div>
</div>
</body>
</html>